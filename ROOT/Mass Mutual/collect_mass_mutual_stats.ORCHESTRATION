{"job":{"components":{"2964912":{"id":2964912,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":416,"y":80,"width":32,"height":32,"inputConnectorIDs":[2964968],"outputSuccessConnectorIDs":[2964967],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Aspiration Spend Balance"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith intervals as (\n    select 0 as lb, 10 as ub\n    union all\n    select 10, 100\n    union all\n    select 100, 1000\n    union all\n    select 1000, 2500\n    union all\n    select 2500, 5000\n    union all\n    select 5000, 10000\n    union all\n    select 10000, 25000\n    union all\n    select 25000, 50000\n    union all\n    select 50000, 100000\n    union all\n    select 100000, 250000\n    union all\n    select 250000, 500000\n    union all\n    select 500000, 100000000000\n)\n-- select *\n-- from intervals\n-- ;\n, interval_balances as (\n    select mmda.unique_account_id,\n           da.spend_current_balance,\n           intervals.lb,\n           intervals.ub,\n           case\n               when spend_current_balance >= intervals.lb and spend_current_balance < intervals.ub then spend_current_balance\n               else -1\n               end as current_balance_i\n    from etl.mass_mutual_depository_accounts mmda\n             join bi.dt_accounts da on mmda.unique_account_id = da.unique_account_id\n             join bi.dt_users du on da.user_id = du.user_id\n             cross join intervals\n    where 1 = 1\n--       and mmda.unique_account_id = 'r22760g223277'\n)\nselect\n    current_date,\n    'Aspiration Spend Balance',\n    case\n        when ib.ub= 100000000000 then ib.lb || ' - max'\n        else ib.lb || ' - ' || ib.ub\n    end as interval,\n--     ib.lb,\n--     ib.ub,\n--     avg(current_balance_i),\n    count(1)\nfrom interval_balances ib\nwhere 1=1\n  and current_balance_i >= 0\ngroup by ib.lb, ib.ub\norder by ib.lb asc\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964913":{"id":2964913,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":288,"y":16,"width":32,"height":32,"inputConnectorIDs":[2964962],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"State"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nselect\n    current_date,\n    'State',\n    du.state,\n    count(1)\nfrom etl.mass_mutual_depository_accounts mmda\njoin bi.dt_accounts da on mmda.unique_account_id=da.unique_account_id\njoin bi.dt_users du on da.user_id=du.user_id\ngroup by du.state\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964914":{"id":2964914,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":288,"y":144,"width":32,"height":32,"inputConnectorIDs":[2964991],"outputSuccessConnectorIDs":[2964972],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Has Recurring Deposit"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nselect\n    current_date,\n    'Has Recurring Deposit',\n    null,\n    count(1)\nfrom etl.mass_mutual_depository_accounts mmda\njoin bi.dt_accounts da on mmda.unique_account_id=da.unique_account_id\njoin web_db.recurring_transfer rt\n    on rt.depository_id=da.galileo_id\n    or rt.depository_id=da.galileo_save_id\nwhere 1=1\n  and rt.enabled = true\n  and rt.type = 'Deposit'\n;\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964915":{"id":2964915,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":560,"y":80,"width":32,"height":32,"inputConnectorIDs":[2964967],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Aspiration Save Balance"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith intervals as (\n    select 0 as lb, 10 as ub\n    union all\n    select 10, 100\n    union all\n    select 100, 1000\n    union all\n    select 1000, 2500\n    union all\n    select 2500, 5000\n    union all\n    select 5000, 10000\n    union all\n    select 10000, 25000\n    union all\n    select 25000, 50000\n    union all\n    select 50000, 100000\n    union all\n    select 100000, 250000\n    union all\n    select 250000, 500000\n    union all\n    select 500000, 100000000000\n)\n-- select *\n-- from intervals\n-- ;\n, interval_balances as (\n    select mmda.unique_account_id,\n           da.spend_current_balance,\n           intervals.lb,\n           intervals.ub,\n           case\n               when save_current_balance >= intervals.lb and save_current_balance < intervals.ub then save_current_balance\n               else -1\n               end as current_balance_i\n    from etl.mass_mutual_depository_accounts mmda\n             join bi.dt_accounts da on mmda.unique_account_id = da.unique_account_id\n             join bi.dt_users du on da.user_id = du.user_id\n             cross join intervals\n    where 1 = 1\n--       and mmda.unique_account_id = 'r22760g223277'\n)\nselect\n    current_date,\n    'Aspiration Save Balance',\n    case\n        when ib.ub= 100000000000 then ib.lb || ' - max'\n        else ib.lb || ' - ' || ib.ub\n    end as interval,\n--     ib.lb,\n--     ib.ub,\n--     avg(current_balance_i),\n    count(1)\nfrom interval_balances ib\nwhere 1=1\n  and current_balance_i >= 0\ngroup by ib.lb, ib.ub\norder by ib.lb asc\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964916":{"id":2964916,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":288,"y":-112,"width":32,"height":32,"inputConnectorIDs":[2964964],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Applied for CMA"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nselect\n    current_date,\n    'Applied for CMA',\n    null,\n    count(1)\nfrom etl.mass_mutual_depository_accounts\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964917":{"id":2964917,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":128,"y":0,"width":32,"height":32,"inputConnectorIDs":[2964963],"outputSuccessConnectorIDs":[2964946,2964960,2964962,2964964,2964970,2964984,2964990,2964991,2964992,2964996,2964997,2964999,2965000],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"get all depository accounts"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"drop table if exists etl.mass_mutual_depository_accounts;\n\ncreate table etl.mass_mutual_depository_accounts as\nselect\n    unique_account_id,\n    user_id\nfrom bi.dt_accounts\nwhere 1=1\n  and termination_date is null\n  and account_type='Checking'\n  and initial_transfer_posted_date is not null\n  and is_charged_off = False\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964918":{"id":2964918,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":288,"y":80,"width":32,"height":32,"inputConnectorIDs":[2964946],"outputSuccessConnectorIDs":[2964968],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CMA Balance"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith intervals as (\n    select 0 as lb, 10 as ub\n    union all\n    select 10, 100\n    union all\n    select 100, 1000\n    union all\n    select 1000, 2500\n    union all\n    select 2500, 5000\n    union all\n    select 5000, 10000\n    union all\n    select 10000, 25000\n    union all\n    select 25000, 50000\n    union all\n    select 50000, 100000\n    union all\n    select 100000, 250000\n    union all\n    select 250000, 500000\n    union all\n    select 500000, 1000000000000000000\n)\n-- select *\n-- from intervals\n-- ;\n, interval_balances as (\n    select mmda.unique_account_id,\n           da.current_balance,\n           intervals.lb,\n           intervals.ub,\n           case\n               when current_balance >= intervals.lb and current_balance < intervals.ub then current_balance\n               else -1\n               end as current_balance_i\n    from etl.mass_mutual_depository_accounts mmda\n             join bi.dt_accounts da on mmda.unique_account_id = da.unique_account_id\n             join bi.dt_users du on da.user_id = du.user_id\n             cross join intervals\n    where 1 = 1\n--       and mmda.unique_account_id = 'r22760g223277'\n)\nselect\n    current_date,\n    'CMA Balance',\n    case\n        when ib.ub= 1000000000000000000 then ib.lb || ' - max'\n        else ib.lb || ' - ' || ib.ub\n    end as interval,\n--     ib.lb,\n--     ib.ub,\n--     avg(current_balance_i),\n    count(1)\nfrom interval_balances ib\nwhere 1=1\n  and current_balance_i >= 0\ngroup by ib.lb, ib.ub\norder by ib.lb asc\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964919":{"id":2964919,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":288,"y":-48,"width":32,"height":32,"inputConnectorIDs":[2964997],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Average Age"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nselect\n    current_date,\n    'Average Age',\n    null,\n    avg(datediff('day', du.date_of_birth, current_date) / 365)\nfrom etl.mass_mutual_depository_accounts mmda\njoin bi.dt_accounts da on mmda.unique_account_id=da.unique_account_id\njoin bi.dt_users du on da.user_id=du.user_id\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964920":{"id":2964920,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":800,"y":464,"width":32,"height":32,"inputConnectorIDs":[2964971],"outputSuccessConnectorIDs":[2964988],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Number of Users Use Only Mobile and No Web"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith web_users as (\n    select distinct du.user_id\n    from SEGMENT_EVENTS.prod_segment_js.users su\n    join bi.dt_users du on su.email = du.user_email\n    join etl.mass_mutual_depository_accounts mmda on du.user_id=mmda.user_id\n)\n, ios_users as (\n    select distinct du.user_id\n    from SEGMENT_EVENTS.prod_segment_ios.user_logged_in ios_user\n    join bi.dt_users du on ios_user.user_id = du.external_user_id\n    join etl.mass_mutual_depository_accounts mmda on du.user_id=mmda.user_id\n)\n, android_users as (\n    select distinct du.user_id\n    from SEGMENT_EVENTS.prod_segment_android.user_logged_in ios_user\n    join bi.dt_users du on ios_user.user_id = du.external_user_id\n    join etl.mass_mutual_depository_accounts mmda on du.user_id=mmda.user_id\n)\n, mobile_users as (\n    select user_id from ios_users\n    union\n    select user_id from android_users\n)\nselect\n    current_date,\n    'Number of Users Use Only Mobile and No Web',\n    null,\n    count(1)\nfrom mobile_users\nwhere user_id not in (\n    select user_id from web_users\n    );\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964921":{"id":2964921,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":544,"y":464,"width":32,"height":32,"inputConnectorIDs":[2964993],"outputSuccessConnectorIDs":[2964971],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Number of Users Use Only Web and No Mobile"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith web_users as (\n    select distinct du.user_id\n    from SEGMENT_EVENTS.prod_segment_js.users su\n    join bi.dt_users du on su.email = du.user_email\n    join etl.mass_mutual_depository_accounts mmda on du.user_id=mmda.user_id\n)\n, ios_users as (\n    select distinct du.user_id\n    from SEGMENT_EVENTS.prod_segment_ios.user_logged_in ios_user\n    join bi.dt_users du on ios_user.user_id = du.external_user_id\n    join etl.mass_mutual_depository_accounts mmda on du.user_id=mmda.user_id\n)\n, android_users as (\n    select distinct du.user_id\n    from SEGMENT_EVENTS.prod_segment_android.user_logged_in ios_user\n    join bi.dt_users du on ios_user.user_id = du.external_user_id\n    join etl.mass_mutual_depository_accounts mmda on du.user_id=mmda.user_id\n)\n, mobile_users as (\n    select user_id from ios_users\n    union\n    select user_id from android_users\n)\nselect\n    current_date,\n    'Number of Users Use Only Web and No Mobile',\n    null,\n    count(1)\nfrom web_users\nwhere user_id not in (\n    select user_id from mobile_users\n    );\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964922":{"id":2964922,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-48,"y":112,"width":32,"height":32,"inputConnectorIDs":[2964987],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"table creation script"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"drop table if exists etl.mass_mutual_stats;\n\ncreate table etl.mass_mutual_stats (\n    id bigint identity(1,1),\n\tdate date,\n\tmetric_1 varchar(255),\n\tmetric_2 varchar(255),\n\tvalue numeric(38,4),\n\tetl_load_date timestamp with time zone default current_timestamp\n)\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964923":{"id":2964923,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-64,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2964986,2964987],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964926":{"id":2964926,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":480,"y":624,"width":32,"height":32,"inputConnectorIDs":[2964969],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Number of Referrals"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nselect\n    current_date,\n    'Number of Referrals',\n    null,\n    count(distinct invited_user_id)\nfrom web_db.user_signup us\njoin etl.mass_mutual_depository_accounts mmda on us.inviting_user_id=mmda.user_id\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964928":{"id":2964928,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":1024,"y":384,"width":32,"height":32,"inputConnectorIDs":[2964994],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Recurring IRA Deposit Count"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nselect\n    current_date,\n    'Recurring IRA Deposit Count',\n    null,\n    count(1)\nfrom etl.mass_mutual_depository_accounts mmda\njoin bi.dt_accounts da on mmda.user_id=da.user_id\nwhere 1=1\n  and account_type in (\n                           'Redwood IRA'\n                           , 'Redwood Individual'\n                          )\n  and current_monthly_recurring_investment_amount > 0\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964929":{"id":2964929,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":880,"y":384,"width":32,"height":32,"inputConnectorIDs":[2964985],"outputSuccessConnectorIDs":[2964994],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rollover IRA Count"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nselect\n    current_date,\n    'Rollover IRA Count',\n    null,\n    count(1)\nfrom bi.dt_transfers dt\njoin bi.dt_accounts da on dt.unique_account_id=da.unique_account_id\njoin etl.mass_mutual_depository_accounts mmda on mmda.user_id=da.user_id\nwhere 1=1\n  and transfer_type='Rollover'\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964930":{"id":2964930,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":288,"y":544,"width":32,"height":32,"inputConnectorIDs":[2964990],"outputSuccessConnectorIDs":[2964966],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Number of Customers Used Mobile Pay"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nselect\n    current_date,\n    'Number of Customers Used Mobile Pay',\n    null,\n    count(1)\nfrom bi.dt_accounts da\njoin etl.mass_mutual_depository_accounts mmda on da.unique_account_id=mmda.unique_account_id\nwhere 1=1\n  and (da.apple_pay_activation_date is not null\n      or da.google_pay_activation_date is not null\n      or da.samsung_pay_activation_date is not null\n      )\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964931":{"id":2964931,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":288,"y":464,"width":32,"height":32,"inputConnectorIDs":[2964970],"outputSuccessConnectorIDs":[2964993],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Number of Users Use Both Web and Mobile"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith web_users as (\n    select distinct du.user_id\n    from SEGMENT_EVENTS.prod_segment_js.users su\n    join bi.dt_users du on su.email = du.user_email\n    join etl.mass_mutual_depository_accounts mmda on du.user_id=mmda.user_id\n)\n, ios_users as (\n    select distinct du.user_id\n    from SEGMENT_EVENTS.prod_segment_ios.user_logged_in ios_user\n    join bi.dt_users du on ios_user.user_id = du.external_user_id\n    join etl.mass_mutual_depository_accounts mmda on du.user_id=mmda.user_id\n)\n, android_users as (\n    select distinct du.user_id\n    from SEGMENT_EVENTS.prod_segment_android.user_logged_in ios_user\n    join bi.dt_users du on ios_user.user_id = du.external_user_id\n    join etl.mass_mutual_depository_accounts mmda on du.user_id=mmda.user_id\n)\n, mobile_users as (\n    select user_id from ios_users\n    union\n    select user_id from android_users\n)\nselect\n    current_date,\n    'Number of Users Use Both Web and Mobile',\n    null,\n    count(1)\nfrom web_users\nwhere user_id in (\n    select user_id from mobile_users\n    )\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964932":{"id":2964932,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":464,"y":384,"width":32,"height":32,"inputConnectorIDs":[2964989],"outputSuccessConnectorIDs":[2964995],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Average Redwood Account Balance"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith redwood_accounts as (\n    select\n        user_id,\n        investment_id,\n        current_balance\n    from bi.dt_accounts\n    where 1 = 1\n      and account_type in ('Redwood IRA', 'Redwood Individual')\n      and termination_date is null\n      and is_charged_off = False\n)\nselect\n    current_date,\n    'Average Redwood Account Balance',\n    null,\n    avg(ra.current_balance)\nfrom etl.mass_mutual_depository_accounts mmda\njoin bi.dt_accounts da on mmda.unique_account_id=da.unique_account_id\njoin redwood_accounts ra on ra.user_id=da.user_id\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964933":{"id":2964933,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":288,"y":384,"width":32,"height":32,"inputConnectorIDs":[2964992],"outputSuccessConnectorIDs":[2964989],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Count of Redwood Accounts"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith redwood_accounts as (\n    select\n        user_id,\n        investment_id,\n        current_balance\n    from bi.dt_accounts\n    where 1 = 1\n      and account_type in ('Redwood IRA', 'Redwood Individual')\n      and termination_date is null\n      and is_charged_off = False\n)\nselect\n    current_date,\n    'Count of Redwood Accounts',\n    null,\n    count(1)\nfrom etl.mass_mutual_depository_accounts mmda\njoin bi.dt_accounts da on mmda.unique_account_id=da.unique_account_id\njoin redwood_accounts ra on ra.user_id=da.user_id\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964934":{"id":2964934,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":784,"y":384,"width":32,"height":32,"inputConnectorIDs":[2964965],"outputSuccessConnectorIDs":[2964985],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IRA Balance"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith ira_intervals as (\n    select 0 as lb, 2000 as ub\n    union all\n    select 2000, 5000\n    union all\n    select 5000, 10000\n    union all\n    select 10000, 20000\n    union all\n    select 20000, 50000\n    union all\n    select 50000, 100000\n    union all\n    select 100000, 200000\n    union all\n    select 200000, 500000\n    union all\n    select 500000, 1000000000000000000\n)\n, redwood_accounts as (\n    select\n        user_id,\n        investment_id,\n        current_balance\n    from bi.dt_accounts\n    where 1 = 1\n      and account_type in (\n                           'Redwood IRA'\n--                            , 'Redwood Individual'\n                          )\n      and termination_date is null\n      and is_charged_off = False\n)\n, interval_balances as (\n    select mmda.unique_account_id,\n           ra.current_balance,\n           ira_intervals.lb,\n           ira_intervals.ub,\n           case\n               when current_balance >= ira_intervals.lb and current_balance < ira_intervals.ub then current_balance\n               else 0\n               end as current_balance_i\n    from etl.mass_mutual_depository_accounts mmda\n             join redwood_accounts ra on ra.user_id = mmda.user_id\n             cross join ira_intervals\n    where 1 = 1\n--       and mmda.user_id = 310324\n)\nselect\n    current_date,\n    'IRA Balance',\n    case\n        when ib.ub= 1000000000000000000 then ib.lb || ' - max'\n        else ib.lb || ' - ' || ib.ub\n    end as interval,\n--     ib.lb,\n--     ib.ub,\n--     avg(current_balance_i),\n    count(1)\nfrom interval_balances ib\nwhere 1=1\n  and current_balance_i > 0\ngroup by ib.lb, ib.ub\norder by ib.lb asc\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964935":{"id":2964935,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":656,"y":384,"width":32,"height":32,"inputConnectorIDs":[2964995],"outputSuccessConnectorIDs":[2964965],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Count of Redwood IRA Accounts"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith redwood_accounts as (\n    select\n        user_id,\n        investment_id,\n        current_balance\n    from bi.dt_accounts\n    where 1 = 1\n      and account_type in ('Redwood IRA')\n      and termination_date is null\n      and is_charged_off = False\n)\nselect\n    current_date,\n    'Count of Redwood IRA Accounts',\n    null,\n    count(1)\nfrom etl.mass_mutual_depository_accounts mmda\njoin bi.dt_accounts da on mmda.unique_account_id=da.unique_account_id\njoin redwood_accounts ra on ra.user_id=da.user_id\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964936":{"id":2964936,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":32,"y":192,"width":32,"height":32,"inputConnectorIDs":[2964996],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Categories of Spend"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nselect\n    current_date,\n    'Categories of Spend',\n    mcc.description,\n    sum(abs(ddt.amount)) total_amount\nFROM bi.dt_depository_transactions  AS ddt\njoin etl.mass_mutual_depository_accounts mmda on ddt.unique_account_id=mmda.unique_account_id\nLEFT JOIN etl.merchant_category_codes AS mcc ON mcc.merchant_category_code = ddt.merchant_category_code\nWHERE 1=1\n  and ddt.transaction_type in ('Purchase', 'Purchase with PIN', 'Debit Card - No PIN',\n              'Debit Card - PIN', 'Retail Sale', 'Unique Transactions', 'Pre-auth completion')\n  and post_date > dateadd('month', -1, current_date)\ngroup by mcc.description\norder by total_amount desc\nlimit 10\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964937":{"id":2964937,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":160,"y":208,"width":32,"height":32,"inputConnectorIDs":[2964960],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"average depository pwif amount"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nselect\n    current_date,\n    'average depository pwif amount',\n    null,\n--    count(1),\n    avg(fee_amount)\nfrom etl.mass_mutual_depository_accounts mmda\njoin bi.dt_accounts da on mmda.unique_account_id=da.unique_account_id\njoin web_db.depository d on da.galileo_id=d.id\nwhere 1=1\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964938":{"id":2964938,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":288,"y":304,"width":32,"height":32,"inputConnectorIDs":[2964984],"outputSuccessConnectorIDs":[2964974],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Average Debit Card Spend"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith debit_card_usage as (\n    select\n        ddt.prn,\n--         DATE_TRUNC('week', ddt.post_date),\n        count(1) as debit_card_spend_count,\n        sum(abs(amount)) debit_card_spend_amount\n    from bi.dt_depository_transactions ddt\n    join etl.mass_mutual_depository_accounts mmda on ddt.unique_account_id=mmda.unique_account_id\n    where 1 = 1\n      and ddt.post_date > dateadd('month', -1, current_date)\n      and ddt.transaction_type in ('Purchase', 'Purchase with PIN', 'Debit Card - No PIN',\n              'Debit Card - PIN', 'Retail Sale', 'Unique Transactions', 'Pre-auth completion')\n--     group by DATE_TRUNC('week', ddt.post_date)\n    group by ddt.prn\n)\nselect\n    current_date,\n    'Average Debit Card Spend',\n    null,\n    round(avg(debit_card_spend_amount), 2)\nfrom debit_card_usage\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964939":{"id":2964939,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":480,"y":304,"width":32,"height":32,"inputConnectorIDs":[2964974],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Average Number of Debit Card Transactions"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith debit_card_usage as (\n    select\n        ddt.prn,\n--         DATE_TRUNC('week', ddt.post_date),\n        count(1) as debit_card_spend_count,\n        sum(abs(amount)) debit_card_spend_amount\n    from bi.dt_depository_transactions ddt\n    join etl.mass_mutual_depository_accounts mmda on ddt.unique_account_id=mmda.unique_account_id\n    where 1 = 1\n      and ddt.post_date > dateadd('month', -1, current_date)\n      and ddt.transaction_type in ('Purchase', 'Purchase with PIN', 'Debit Card - No PIN',\n              'Debit Card - PIN', 'Retail Sale', 'Unique Transactions', 'Pre-auth completion')\n--     group by DATE_TRUNC('week', ddt.post_date)\n    group by ddt.prn\n)\nselect\n    current_date,\n    'Average Number of Debit Card Transactions',\n    null,\n    round(avg(debit_card_spend_count), 2)\nfrom debit_card_usage\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964940":{"id":2964940,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":608,"y":144,"width":32,"height":32,"inputConnectorIDs":[2964961],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Average Recurring Deposit Amount"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nselect\n    current_date,\n    'Average Recurring Deposit Amount',\n    null,\n--     count(1)\n    avg(amount)\nfrom etl.mass_mutual_depository_accounts mmda\njoin bi.dt_accounts da on mmda.unique_account_id=da.unique_account_id\njoin web_db.recurring_transfer rt\n    on rt.depository_id=da.galileo_id\n    or rt.depository_id=da.galileo_save_id\nwhere 1=1\n  and rt.enabled = true\n  and rt.type = 'Deposit'\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964941":{"id":2964941,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":432,"y":144,"width":32,"height":32,"inputConnectorIDs":[2964972],"outputSuccessConnectorIDs":[2964961],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Frequency of Recurring Deposit"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nselect\n    current_date,\n    'Frequency of Recurring Deposit',\n    frequency,\n    count(1)\nfrom etl.mass_mutual_depository_accounts mmda\njoin bi.dt_accounts da on mmda.unique_account_id=da.unique_account_id\njoin web_db.recurring_transfer rt\n    on rt.depository_id=da.galileo_id\n    or rt.depository_id=da.galileo_save_id\nwhere 1=1\n  and rt.enabled = true\n  and rt.type = 'Deposit'\ngroup by frequency\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964942":{"id":2964942,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":432,"y":224,"width":32,"height":32,"inputConnectorIDs":[2964975],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Average Direct Deposit Amount"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith direct_deposit_accounts as (\n    select\n        unique_account_id,\n        sum(amount) as direct_deposit_amount,\n        count(unique_account_id) as direct_deposit_count\n    from bi.dt_depository_transactions\n    where 1 = 1\n      and direct_deposit_ind = true\n      and transaction_date > current_date - 30\n    group by unique_account_id\n)\nselect\n    current_date,\n    'Average Direct Deposit Amount',\n    null,\n    avg(direct_deposit_amount)\nfrom etl.mass_mutual_depository_accounts mmda\njoin direct_deposit_accounts dda on mmda.unique_account_id=dda.unique_account_id\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964943":{"id":2964943,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":288,"y":224,"width":32,"height":32,"inputConnectorIDs":[2964999],"outputSuccessConnectorIDs":[2964975],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Has Direct Deposit"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith direct_deposit_accounts as (\n    select distinct unique_account_id\n    from bi.dt_depository_transactions\n    where 1 = 1\n      and direct_deposit_ind = true\n      and transaction_date > current_date - 30\n)\nselect\n    current_date,\n    'Has Direct Deposit',\n    null,\n    count(1)\nfrom etl.mass_mutual_depository_accounts mmda\njoin direct_deposit_accounts dda on mmda.unique_account_id=dda.unique_account_id\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964944":{"id":2964944,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":1168,"y":464,"width":32,"height":32,"inputConnectorIDs":[2964998],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Average Time Spent on Web"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith time_diff as (\n    select context_traits_user_id as user_id,\n           timestamp as curr_timestamp,\n           event_text,\n           lag(curr_timestamp, 1)\n           over (partition by context_traits_user_id order by timestamp) as prev_timestamp\n    from SEGMENT_EVENTS.prod_segment_android.tracks\n    where 1 = 1\n--   and received_at > '2020-01-01'\n--       and context_traits_email = 'bcpclab@gmail.com'\n    order by timestamp asc\n)\n, all_events as (\n    select\n           user_id,\n           curr_timestamp,\n--     prev_timestamp,\n           event_text,\n           datediff('second', prev_timestamp, curr_timestamp) as seconds\n    from time_diff\n    where 1=1\n--       and\n--           (\n--           curr_timestamp like '2019-06-04%'\n--                or curr_timestamp like '2019-06-11%'\n--           )\n)\n-- select * from all_events;\n, login_events as (\n    select *\n    from all_events\n    where 1 = 1\n      and event_text = 'User LOGGED-IN'\n)\n-- select *\n-- from login_events;\n, login_sessions as (\n    select\n--     date_diff('second', le.curr_timestamp, ae.curr_timestamp)\nle.user_id,\nle.curr_timestamp                                                   as login_timestamp,\nmin(ae.curr_timestamp)                                              as min_timestamp,\nmax(ae.curr_timestamp)                                              as max_timestamp,\ndatediff('second', min(ae.curr_timestamp), max(ae.curr_timestamp)) as duration\n    from all_events ae\n             join login_events le on ae.user_id = le.user_id\n    where 1 = 1\n      and ae.seconds < 300\n      and abs(datediff('second', ae.curr_timestamp, le.curr_timestamp)) < 900\n    group by le.user_id, le.curr_timestamp\n)\nselect\n    current_date,\n    'Average Time Spent on Web (in seconds)',\n    null,\n    avg(duration)\nfrom login_sessions\nwhere 1=1\n--   and abs(date_diff('second', login_timestamp, min_timestamp)) < 60\n  and duration != 0\n-- order by login_timestamp asc\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964945":{"id":2964945,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":1008,"y":464,"width":32,"height":32,"inputConnectorIDs":[2964988],"outputSuccessConnectorIDs":[2964998],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Average Time Spent on Mobile"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith session_duration as (\n    select context_amplitude_session_id,\n           min(received_at),\n           max(received_at),\n           datediff('second', min(received_at), max(received_at)) seconds\n    from SEGMENT_EVENTS.prod_segment_js.tracks\n    where 1 = 1\n      and context_amplitude_session_id is not null\n--   and context_amplitude_session_id=1571430861019\n    group by context_amplitude_session_id\n-- order by received_at asc\n)\nselect\n    current_date,\n    'Average Time Spent on Mobile (in seconds)',\n    null,\n    avg(seconds)\nfrom session_duration\nwhere 1=1\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964947":{"id":2964947,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":32,"y":0,"width":32,"height":32,"inputConnectorIDs":[2964986],"outputSuccessConnectorIDs":[2964963],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"clean up"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delete from etl.mass_mutual_stats\nwhere date=current_date\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964948":{"id":2964948,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":752,"y":544,"width":32,"height":32,"inputConnectorIDs":[2964973],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Number of Customers Used ATM"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nwith atm_usage as (\n    select\n        distinct unique_account_id\n    from bi.dt_account_daily_data\n    where 1 = 1\n      and atm_deposit_count + atm_withdrawal_count > 0\n      and date > current_date - 30\n)\nselect\n    current_date,\n    'Number of Customers Used ATM',\n    null,\n    count(1)\nfrom atm_usage au\njoin etl.mass_mutual_depository_accounts mmda on au.unique_account_id=mmda.unique_account_id\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964949":{"id":2964949,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":528,"y":544,"width":32,"height":32,"inputConnectorIDs":[2964966],"outputSuccessConnectorIDs":[2964973],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Number of Customers Used Virtual Cards"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nselect\n    current_date,\n    'Number of Customers Used Virtual Cards',\n    null,\n    count(1)\nfrom bi.dt_accounts da\njoin etl.mass_mutual_depository_accounts mmda on da.unique_account_id=mmda.unique_account_id\nwhere 1=1\n  and virtual_card_used = true\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964950":{"id":2964950,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":288,"y":624,"width":32,"height":32,"inputConnectorIDs":[2965000],"outputSuccessConnectorIDs":[2964969],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Number of Customers That Made Referrals"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into etl.mass_mutual_stats\n(date, metric_1, metric_2, value)\nselect\n    current_date,\n    'Number of Customers That Made Referrals',\n    null,\n    count(distinct inviting_user_id)\nfrom web_db.user_signup us\njoin etl.mass_mutual_depository_accounts mmda on us.inviting_user_id=mmda.user_id\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2964946":{"id":2964946,"sourceID":2964917,"targetID":2964918},"2964960":{"id":2964960,"sourceID":2964917,"targetID":2964937},"2964961":{"id":2964961,"sourceID":2964941,"targetID":2964940},"2964962":{"id":2964962,"sourceID":2964917,"targetID":2964913},"2964963":{"id":2964963,"sourceID":2964947,"targetID":2964917},"2964964":{"id":2964964,"sourceID":2964917,"targetID":2964916},"2964965":{"id":2964965,"sourceID":2964935,"targetID":2964934},"2964966":{"id":2964966,"sourceID":2964930,"targetID":2964949},"2964967":{"id":2964967,"sourceID":2964912,"targetID":2964915},"2964968":{"id":2964968,"sourceID":2964918,"targetID":2964912},"2964969":{"id":2964969,"sourceID":2964950,"targetID":2964926},"2964970":{"id":2964970,"sourceID":2964917,"targetID":2964931},"2964971":{"id":2964971,"sourceID":2964921,"targetID":2964920},"2964972":{"id":2964972,"sourceID":2964914,"targetID":2964941},"2964973":{"id":2964973,"sourceID":2964949,"targetID":2964948},"2964974":{"id":2964974,"sourceID":2964938,"targetID":2964939},"2964975":{"id":2964975,"sourceID":2964943,"targetID":2964942},"2964984":{"id":2964984,"sourceID":2964917,"targetID":2964938},"2964985":{"id":2964985,"sourceID":2964934,"targetID":2964929},"2964988":{"id":2964988,"sourceID":2964920,"targetID":2964945},"2964989":{"id":2964989,"sourceID":2964933,"targetID":2964932},"2964990":{"id":2964990,"sourceID":2964917,"targetID":2964930},"2964991":{"id":2964991,"sourceID":2964917,"targetID":2964914},"2964992":{"id":2964992,"sourceID":2964917,"targetID":2964933},"2964993":{"id":2964993,"sourceID":2964931,"targetID":2964921},"2964994":{"id":2964994,"sourceID":2964929,"targetID":2964928},"2964995":{"id":2964995,"sourceID":2964932,"targetID":2964935},"2964996":{"id":2964996,"sourceID":2964917,"targetID":2964936},"2964997":{"id":2964997,"sourceID":2964917,"targetID":2964919},"2964998":{"id":2964998,"sourceID":2964945,"targetID":2964944},"2964999":{"id":2964999,"sourceID":2964917,"targetID":2964943},"2965000":{"id":2965000,"sourceID":2964917,"targetID":2964950}},"failureConnectors":{},"unconditionalConnectors":{"2964986":{"id":2964986,"sourceID":2964923,"targetID":2964947},"2964987":{"id":2964987,"sourceID":2964923,"targetID":2964922}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"collect_mass_mutual_stats","description":null,"type":"ORCHESTRATION","tag":"463a9fe7-3751-4037-a39b-560cc89f1853"}}