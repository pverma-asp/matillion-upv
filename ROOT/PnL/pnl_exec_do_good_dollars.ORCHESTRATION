{"job":{"components":{"2963820":{"id":2963820,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-832,"y":-320,"width":32,"height":32,"inputConnectorIDs":[2963808,2963810,2963811],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2963814],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963821":{"id":2963821,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":-1540940111,"x":-736,"y":-368,"width":32,"height":32,"inputConnectorIDs":[2963814],"outputSuccessConnectorIDs":[2963819],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rollback 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963823":{"id":2963823,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-656,"y":-368,"width":32,"height":32,"inputConnectorIDs":[2963819],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963840":{"id":2963840,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-544,"y":-64,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"drop table ${Pnl_schema}.interchange;\n--truncate table ${Pnl_schema}.${Consolidated_table}\n\n--delete from ${Pnl_schema}.${Target_table}\n--where \n--date_part(year, cast(${Pnl_schema}.${Target_table}.date as date)) = date_part(year, current_date)\n--and\n--date_part(month, cast(${Pnl_schema}.${Target_table}.date as date)) = date_part(month, current_date) - 1;\n--delete from ${Pnl_schema}.${Consolidated_table}\n--where \n--date_part(year, cast(${Pnl_schema}.${Consolidated_table}.date as date)) = date_part(year, current_date)\n--and\n--date_part(month, cast(${Pnl_schema}.${Consolidated_table}.date as date)) = date_part(month, current_date) - 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963841":{"id":2963841,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1120,"y":-160,"width":32,"height":32,"inputConnectorIDs":[2963815],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_do_good_dollars"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_do_good_dollars"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963842":{"id":2963842,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":977205684,"x":-640,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963816],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Commit 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963843":{"id":2963843,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":-1785670938,"x":-1024,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963812],"outputSuccessConnectorIDs":[2963817],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Begin 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963844":{"id":2963844,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-944,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963817],"outputSuccessConnectorIDs":[2963822],"outputFailureConnectorIDs":[2963808],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delete prev day"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delete from edw.${Target_table}\nwhere cast(edw.${Target_table}.date as date) = dateadd(day, -1, current_date)"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963845":{"id":2963845,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-736,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963818],"outputSuccessConnectorIDs":[2963816],"outputFailureConnectorIDs":[2963810],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Consolidated"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"-- Delete existing data\nDELETE FROM edw.${Consolidated_table} \nWHERE Item = ${Item_name} \n\tand cast(edw.${Consolidated_table}.date as date) = dateadd(day, -1, current_date);\n\n-- Insert updated data\n\nINSERT INTO edw.${Consolidated_table}(execution,\n                                 User_id,\n                                 Account_id,\n                                 Depository_id,\n                                 Investment_id,\n                                 Account_type,\n                                 Product_type,\n                                 --Account_product_type_id,\n                                 --Account_product_type_name,\n                                 --Account_investment_type_id,\n                                 --Account_investment_type_name,\n                                 --Account_type_id,\n                                 --Account_type_name,\n                                 --Account_product_id,\n                                 --Account_product_name,\n                                 Non_customer,\n                                 Category,\n                                 Item,\n                                 Value_type,\n                                 Value,\n                                 Date)\n(SELECT execution,\n       User_id,\n       Account_id,\n       Depository_id,\n       Investment_id,\n       Account_type,\n       Product_type,\n       --Account_product_type_id,\n       --Account_product_type_name,\n       --Account_investment_type_id,\n       --Account_investment_type_name,\n       --Account_type_id,\n       --Account_type_name,\n       --Account_product_id,\n       --Account_product_name,\n       Non_customer,\n       Category,\n       Item,\n       Value_type,\n       Value,\n       Date\nFROM edw.${Target_table}\nwhere cast(edw.${Target_table}.date as date) = dateadd(day, -1, current_date));"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963846":{"id":2963846,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1376,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963809],"outputSuccessConnectorIDs":[2963813],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Target table check"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\ncursor = context.cursor()\ntry:\n\tcursor.execute('select cast(exists(select * from edw.'+Target_table+' limit 1) as integer)')\n\tresult = cursor.fetchone()[0]\n\tcontext.updateVariable('Exist_check_Target_table', result)\nexcept:\n  \tcontext.updateVariable('Exist_check_Target_table', '0')\n    \nprint ('Variable value: '+str(Exist_check_Target_table))"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963847":{"id":2963847,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-1280,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963813],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[2963812],"outputFalseConnectorIDs":[2963815],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Exist_check_Target_table"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963848":{"id":2963848,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-832,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963822],"outputSuccessConnectorIDs":[2963818],"outputFailureConnectorIDs":[2963811],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Execution prev day"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SET timezone = 'America/Los_Angeles';\n\nINSERT INTO edw.${Target_table}(execution,\n                                User_id,\n                                Account_id,\n                                Depository_id,\n                                Investment_id,\n                                Account_type,\n                            \tProduct_type,\n                                --Account_product_type_id,\n                                --Account_product_type_name,\n                                --Account_product_id,\n                                --Account_product_name,\n                                --Account_type_id,\n                                --Account_type_name,\n                                --Account_investment_type_id,\n                                --Account_investment_type_name,\n                                Non_customer,\n                                Category,\n                                Item,\n                                Date,\n                                Value,\n                                Value_type)\n\nWITH do_good_amount AS (\n        SELECT user_id, SUM(amount) AS sum_amount\n        FROM web_db.user_charity_giving\n        WHERE payment_source = 5\n        AND last_updated::date = dateadd(day, -1, current_date)::date\n        GROUP BY user_id\n      ),\n\n     user_acc_dep_inv AS (\n       SELECT ua.user_id AS user_id,\n              ua.account_id AS account_id,\n              acc.product_type AS Account_product_type_id, -- for dep and inv\n              dg.sum_amount AS sum_amount,\n              dep.id AS dep_id,\n              dep.product_id AS Account_product_id, --for dep\n              inv.id AS inv_id,\n              acc.account_type_id AS Account_type_id, --for inv\n              inv.fund_id AS Account_investment_type_id -- for inv\n       FROM web_db.user_account AS ua\n       INNER JOIN do_good_amount AS dg ON ua.user_id = dg.user_id\n       LEFT JOIN web_db.depository AS dep ON dep.account_id = ua.account_id\n       LEFT JOIN web_db.investment AS inv ON inv.account_id = ua.account_id\n       INNER JOIN web_db.account AS acc ON acc.id = ua.account_id\n     ),\n\n     user_id_dep_4_cnt_1 AS (\n       SELECT user_id, COUNT(*) cnt\n       FROM user_acc_dep_inv\n       WHERE Account_product_id = 4\n       GROUP BY user_id\n       HAVING cnt = 1\n     ),\n\n     --1 to result\n     info_dep_4_cnt_1 AS (\n       SELECT user_id,\n              account_id,\n              dep_id,\n              sum_amount,\n              Account_product_type_id,\n              Account_product_id,\n              NULL AS Account_type_id,\n              NULL AS Account_investment_type_id\n       FROM user_acc_dep_inv\n       WHERE user_id IN (SELECT user_id FROM user_id_dep_4_cnt_1)\n         AND Account_product_id = 4\n     ),\n\n     user_id_dep_4_cnt_not_1 AS (\n       SELECT user_id, COUNT(*) cnt\n       FROM user_acc_dep_inv\n       WHERE Account_product_id = 4\n       GROUP BY user_id\n       HAVING cnt > 1\n     ),\n\n     dep_id_dep_4_cnt_not_1 AS (\n       SELECT user_id, MIN(dep_id) AS dep_id\n       FROM user_acc_dep_inv\n       WHERE user_id IN (SELECT user_id FROM user_id_dep_4_cnt_not_1)\n       AND Account_product_id = 4\n       GROUP BY user_id\n     ),\n\n     --2 to result\n     info_dep_4_cnt_not_1 AS (\n       SELECT ua.user_id,\n              ua.account_id,\n              ua.dep_id,\n              ua.sum_amount,\n              ua.Account_product_type_id,\n              ua.Account_product_id,\n              NULL AS Account_type_id,\n              NULL AS Account_investment_type_id\n       FROM dep_id_dep_4_cnt_not_1 AS d\n       INNER JOIN user_acc_dep_inv AS ua ON d.user_id = ua.user_id AND d.dep_id = ua.dep_id\n     ),\n\n     user_id_not_dep_4 AS (\n       SELECT DISTINCT user_id\n       FROM user_acc_dep_inv\n       EXCEPT\n       SELECT user_id\n       FROM info_dep_4_cnt_1\n       EXCEPT\n       SELECT user_id\n       FROM info_dep_4_cnt_not_1\n     ),\n\n     dep_id_not_dep_4 AS (\n       SELECT user_id, account_id, dep_id\n       FROM user_acc_dep_inv\n       WHERE user_id IN (SELECT user_id FROM user_id_not_dep_4)\n         AND dep_id IS NOT NULL\n     ),\n\n     user_id_not_dep_4_min_dep AS (\n       SELECT user_id, MIN(dep_id) AS dep_id\n       FROM dep_id_not_dep_4\n       GROUP BY user_id\n     ),\n\n     --3 to result\n     info_not_dep_4 AS (\n       SELECT ua.user_id,\n              ua.account_id,\n              ua.dep_id,\n              ua.sum_amount,\n              ua.Account_product_type_id,\n              ua.Account_product_id,\n              NULL AS Account_type_id,\n              NULL AS Account_investment_type_id\n       FROM user_id_not_dep_4_min_dep AS ud\n       INNER JOIN user_acc_dep_inv AS ua ON ud.user_id = ua.user_id AND ud.dep_id = ua.dep_id\n     ),\n\n     user_id_not_dep AS (\n       SELECT user_id\n       FROM user_id_not_dep_4\n       EXCEPT\n       SELECT user_id\n       FROM info_not_dep_4\n     ),\n\n     user_id_inv AS (\n       SELECT user_id, MIN(inv_id) AS inv_id\n       FROM user_acc_dep_inv\n       WHERE user_id IN (SELECT user_id FROM user_id_not_dep)\n       AND inv_id IS NOT NULL\n       GROUP BY user_id\n     ),\n\n     -- 4 to result\n     info_inv AS (\n       SELECT ua.user_id,\n              ua.account_id,\n              ua.inv_id,\n              ua.sum_amount,\n              ua.Account_product_type_id,\n              ua.Account_type_id,\n              ua.Account_investment_type_id,\n              NULL AS Account_product_id\n       FROM user_id_inv AS ui\n       INNER JOIN user_acc_dep_inv ua ON ui.user_id = ua.user_id AND ui.inv_id = ua.inv_id\n     ),\n\n     common_do_good AS (\n       SELECT user_id, Account_id, dep_id AS Account_dep_inv_id, sum_amount,\n              Account_product_type_id, Account_product_id,\n              Account_type_id, Account_investment_type_id\n       FROM info_dep_4_cnt_1\n       UNION\n       SELECT user_id, Account_id, dep_id AS Account_dep_inv_id, sum_amount,\n              Account_product_type_id, Account_product_id,\n              Account_type_id, Account_investment_type_id\n       FROM info_dep_4_cnt_not_1\n       UNION\n       SELECT user_id, Account_id, dep_id AS Account_dep_inv_id, sum_amount,\n              Account_product_type_id, Account_product_id,\n              Account_type_id, Account_investment_type_id\n       FROM info_not_dep_4\n       UNION\n       SELECT user_id, Account_id, inv_id AS Account_dep_inv_id, sum_amount,\n              Account_product_type_id, Account_product_id,\n              Account_type_id, Account_investment_type_id\n       FROM info_inv\n     )\n\n\nSELECT current_date() AS execution,\n       user_id AS User_id,\n       Account_id,\n       (CASE\n          WHEN Account_product_type_id = 1 THEN NULL\n          WHEN Account_product_type_id = 2 THEN Account_dep_inv_id\n         END) AS Depository_id,\n       (CASE\n          WHEN Account_product_type_id = 1 THEN Account_dep_inv_id\n          WHEN Account_product_type_id = 2 THEN NULL\n         END) AS Investment_id,\n       (CASE\n          WHEN Account_product_type_id = 1 THEN 'Investment'::text\n          WHEN Account_product_type_id = 2 THEN 'Depository'::text\n          ELSE ''::text\n         END) AS Account_type,\n       (CASE\n         WHEN Account_product_type_id = 1 -- 'Investment'\n           AND Account_type_id = 2 -- 'Individual'\n           AND Account_investment_type_id = 1 -- 'Flagship'\n            THEN 'Flagship Individual'::text\n         WHEN Account_product_type_id = 1 -- 'Investment'\n           AND Account_type_id = 2 -- 'Individual'\n           AND Account_investment_type_id = 2 -- 'Redwood'\n            THEN 'Redwood Individual'::text\n         WHEN Account_product_type_id = 1 -- 'Investment'\n           AND Account_type_id = 3 -- 'IRA'\n           AND Account_investment_type_id = 1 -- 'Flagship'\n            THEN 'Flagship IRA'::text\n         WHEN Account_product_type_id = 1 -- 'Investment'\n           AND Account_type_id = 3 -- 'IRA'\n           AND Account_investment_type_id = 2 -- 'Redwood'\n            THEN 'Redwood IRA'::text\n         WHEN Account_product_type_id = 2 -- 'Depository'\n           AND Account_product_id = 3\n            THEN 'Summit'::text\n         WHEN Account_product_type_id = 2 -- 'Depository'\n           AND Account_product_id = 4\n           THEN 'Spend'::text\n         WHEN Account_product_type_id = 2 -- 'Depository'\n           AND Account_product_id = 5\n           THEN 'Save'::text\n         ELSE ''::text\n        END) AS Product_type,\n\n--        Account_product_type_id,\n--        (CASE\n--           WHEN Account_product_type_id = 1 THEN 'Investment'::text\n--           WHEN Account_product_type_id = 2 THEN 'Depository'::text\n--           ELSE ''::text\n--          END) AS Account_product_type_name,\n--        Account_product_id,\n--        (CASE\n--           WHEN Account_product_id = 3 THEN 'Summit'::text\n--           WHEN Account_product_id = 4 THEN 'Spend'::text\n--           WHEN Account_product_id = 5 THEN 'Save'::text\n--           ELSE NULL\n--          END) AS Account_product_name,\n--        Account_type_id,\n--        (CASE\n--           WHEN Account_type_id = 2 THEN 'Individual'::text\n--           WHEN Account_type_id = 3 THEN 'IRA'::text\n--           ELSE NULL\n--          END) AS Account_type_name,\n--        Account_investment_type_id,\n--        (CASE\n--           WHEN Account_investment_type_id = 1 THEN 'Flagship'::text\n--           WHEN Account_investment_type_id = 2 THEN 'Redwood'::text\n--           ELSE NULL\n--          END) AS Account_investment_type_name,\n       FALSE AS Non_customer,\n       'Direct'::text AS Category,\n       'Do Good Dollars'::text AS Item,\n       dateadd(day, -1, current_date)::date AS Date,\n       -sum_amount AS Value,\n       'Cost'::text AS Value_type\nFROM common_do_good;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963849":{"id":2963849,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1472,"y":-240,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2963809],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963850":{"id":2963850,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-544,"y":-128,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRANT"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"spashchenko.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"ashumakov.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"vfigurkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"opetrova.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"idudkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"spashchenko.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"ashumakov.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"vfigurkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"opetrova.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"idudkin.ctr\";"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2963813":{"id":2963813,"sourceID":2963846,"targetID":2963847},"2963816":{"id":2963816,"sourceID":2963845,"targetID":2963842},"2963817":{"id":2963817,"sourceID":2963843,"targetID":2963844},"2963818":{"id":2963818,"sourceID":2963848,"targetID":2963845},"2963819":{"id":2963819,"sourceID":2963821,"targetID":2963823},"2963822":{"id":2963822,"sourceID":2963844,"targetID":2963848}},"failureConnectors":{"2963808":{"id":2963808,"sourceID":2963844,"targetID":2963820},"2963810":{"id":2963810,"sourceID":2963845,"targetID":2963820},"2963811":{"id":2963811,"sourceID":2963848,"targetID":2963820}},"unconditionalConnectors":{"2963809":{"id":2963809,"sourceID":2963849,"targetID":2963846},"2963814":{"id":2963814,"sourceID":2963820,"targetID":2963821}},"trueConnectors":{"2963812":{"id":2963812,"sourceID":2963847,"targetID":2963843}},"falseConnectors":{"2963815":{"id":2963815,"sourceID":2963847,"targetID":2963841}},"iterationConnectors":{},"noteConnectors":{},"notes":{"2963794":{"id":2963794,"x":-587,"y":-168,"width":87,"height":140,"text":"for development","colour":"d60000"}},"variables":{"Consolidated_table":{"definition":{"name":"Consolidated_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"consolidated_pnl"},"Exist_check_Target_table":{"definition":{"name":"Exist_check_Target_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"Item_name":{"definition":{"name":"Item_name","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"'Do Good Dollars'"},"Month_iterator":{"definition":{"name":"Month_iterator","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"Pnl_schema":{"definition":{"name":"Pnl_schema","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"edw"},"Target_table":{"definition":{"name":"Target_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PRIVATE"},"value":"do_good_dollars"}},"grids":{}},"info":{"name":"pnl_exec_do_good_dollars","description":"Script for updating item on regular basis","type":"ORCHESTRATION","tag":"a470c034-da5b-45c1-b911-bed28857e50e"}}