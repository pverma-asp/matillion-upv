{"job":{"components":{"2963601":{"id":2963601,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-928,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963683],"outputSuccessConnectorIDs":[2963691],"outputFailureConnectorIDs":[2963661],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create\\Truncate"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CREATE TABLE IF NOT EXISTS edw.${Target_table}(\n  \t\t\t\t\t\t\t\t\t\t\t\t\t   id bigint identity(1, 1),\n                                                       execution timestamp with time zone,\n                                                       User_id bigint not null,\n                                                       Account_id bigint not null,\n                                                       Depository_id bigint,\n                                                       Investment_id bigint,\n  \t\t\t\t\t\t\t\t\t\t\t \t\t   Account_type varchar(50),\n    \t\t\t\t\t\t\t\t\t\t \t\t   Product_type  varchar(50),\n                                                       --Account_product_type_id int, --account.product_type\n                                                       --Account_product_type_name varchar(50), --1 = investment, 2 = depository\n                                                       --Account_product_id int, --<depository.product_id>\n                                                       --Account_product_name varchar(50), --3 = Summit , 4 = Spend, 5 = Save\n                                                       --Account_type_id int, --<account.account_type_id>\n                                                       --Account_type_name varchar(50), --2 = Individual, 3 = IRA\n                                                       --Account_investment_type_id int, --<investment.fund_id>\n                                                       --Account_investment_type_name varchar(50), --1 = Flagship, 2 = Redwood\n                                                       Non_customer boolean, -- True for ZenDesk/False for others\n                                                       Category varchar(50) not null,\n                                                       Item varchar(50) not null,\n                                                       Date timestamp with time zone,\n                                                       Value numeric(38,8) not null,\n                                                       Value_type varchar(50),\n                                                       primary key(id));\nTRUNCATE edw.${Target_table}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963602":{"id":2963602,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":235671163,"x":-1184,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963680,2963682,2963690],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2963700],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963603":{"id":2963603,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1312,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963696],"outputSuccessConnectorIDs":[2963680],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_view_unique_user_accounts"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_view_unique_user_accounts"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963604":{"id":2963604,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1456,"y":-240,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2963696,2963697,2963699],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963605":{"id":2963605,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1312,"y":-320,"width":32,"height":32,"inputConnectorIDs":[2963697],"outputSuccessConnectorIDs":[2963682],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_etl_promontory_network_fee"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_etl_promontory_network_fee"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963606":{"id":2963606,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-352,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963685],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TMP"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"spashchenko.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"ashumakov.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"vfigurkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"opetrova.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"idudkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"spashchenko.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"ashumakov.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"vfigurkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"opetrova.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"idudkin.ctr\";"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963607":{"id":2963607,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-816,"y":-240,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Execution"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SET timezone = 'America/Los_Angeles';\n\nINSERT INTO edw.${Target_table}(execution,\n                                        User_id,\n                                        Account_id,\n                                        Depository_id,\n                                        Investment_id,\n                            \t\t    Account_type,\n                            \t\t    Product_type,\n                                        --Account_product_type_id,\n                                        --Account_product_type_name,\n                                        --Account_product_id,\n                                        --Account_product_name,\n                                        Non_customer,\n                                        Category,\n                                        Item,\n                                        Date,\n                                        Value,\n                                        Value_type)\n\nWITH\n  month_dates AS (\n    SELECT date_trunc('month', dateadd(month, ${Month_iterator}, current_date))::date AS prev_month_first,\n           last_day(prev_month_first) AS prev_month_last,\n           prev_month_first - 1 AS two_months_ago_last_day\n  ),\n\n  fitting_accounts AS (\n    SELECT gpt.galileo_account_id::bigint AS Galileo_account_id,\n           MAX(dep.id) AS Account_dep_inv_id\n    FROM web_db.galileo_posted_transaction gpt\n           INNER JOIN web_db.posted_transaction pt ON gpt.posted_transaction_id = pt.id\n           INNER JOIN web_db.depository AS dep ON pt.depository_id = dep.id\n           INNER JOIN web_db.account AS acc ON dep.account_id = acc.id\n           INNER JOIN edw.view_accounts_termination_dates atd ON atd.account_id = dep.account_id\n    WHERE acc.product_type = 2\n      AND dep.product_id IN (4, 5)\n      AND dep.inception_date <= (SELECT prev_month_last FROM month_dates)\n      AND (atd.termination_date IS NULL\n      OR (atd.termination_date::date >= (SELECT prev_month_first FROM month_dates)\n        AND dep.inception_date <= atd.termination_date))\n    GROUP BY gpt.galileo_account_id\n  ),\n\n  date_gen AS (\n    SELECT dateadd('day', i.i - 1, (SELECT prev_month_first FROM month_dates)) AS Date\n    FROM (\n           SELECT ROW_NUMBER() OVER(ORDER BY SEQ4()) i\n           FROM TABLE (\n                GENERATOR(\n                        ROWCOUNT => 31\n                    )\n               )\n         ) i\n    WHERE DATE_TRUNC('month', Date) = (SELECT prev_month_first FROM month_dates)\n  ),\n\n  galileo_accounts_all_dates AS (\n    SELECT acc.Galileo_account_id, qd.date FROM fitting_accounts acc\n                                                  CROSS JOIN date_gen qd\n  ),\n\n  current_balances AS (\n    SELECT galileo_account_id::bigint as cb_galileo_account_id,\n           (CASE WHEN current_balance_sign != '-' THEN current_balance::float\n                 ELSE 0 END) AS current_balance,\n           file_date\n    FROM rdl.raw_galileo_customer_master_data\n    WHERE DATE_TRUNC('month', file_date) = (SELECT prev_month_first FROM month_dates)\n    ORDER BY galileo_account_id, file_date\n  ),\n\n  last_known_value AS (\n    SELECT galileo_account_id::bigint as lkv_galileo_account_id,\n\n           (CASE WHEN current_balance_sign != '-' THEN current_balance::float\n                 ELSE 0 END) AS current_balance,\n\n           (SELECT two_months_ago_last_day FROM month_dates) AS date,\n           ROW_NUMBER() OVER (PARTITION BY galileo_account_id::bigint ORDER BY file_date DESC) AS num\n\n    FROM rdl.raw_galileo_customer_master_data\n    WHERE file_date < (SELECT prev_month_first FROM month_dates)\n  ),\n\n  combined AS (\n    SELECT ad.Galileo_account_id, cb.current_balance, ad.date\n    FROM current_balances cb\n           RIGHT JOIN galileo_accounts_all_dates ad\n                      ON ad.date = cb.file_date AND ad.Galileo_account_id = cb.cb_galileo_account_id\n    UNION\n    SELECT l.lkv_galileo_account_id as galileo_account_id, l.current_balance, l.date FROM last_known_value l\n    WHERE num = 1\n  ),\n\n  combined_with_filled_values AS (\n    SELECT Galileo_account_id,\n           (CASE\n              WHEN combined.current_balance IS NULL\n                THEN FIRST_VALUE(combined.current_balance::float IGNORE NULLS) OVER\n                (PARTITION BY Galileo_account_id ORDER BY Date DESC, Galileo_account_id DESC\n                ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n              WHEN combined.current_balance IS NOT NULL\n                THEN combined.current_balance::float END) AS cb_last,\n           Date\n    FROM combined\n    ORDER BY Galileo_account_id, Date\n  ),\n  \n  combined_with_filled_values_cutoff_at_inception_and_termination AS (\n    SELECT cwfv.Galileo_account_id,\n           (CASE WHEN (cwfv.date < dep.inception_date OR cwfv.date > atd.termination_date) THEN 0\n                 ELSE cb_last END) AS cb_last,\n           Date\n    FROM combined_with_filled_values cwfv\n           INNER JOIN fitting_accounts fa ON cwfv.galileo_account_id = fa.galileo_account_id\n           INNER JOIN web_db.depository AS dep ON fa.Account_dep_inv_id = dep.id\n           INNER JOIN web_db.account AS acc ON dep.account_id = acc.id\n           INNER JOIN edw.view_accounts_termination_dates atd ON atd.account_id = dep.account_id\n    ORDER BY Galileo_account_id, Date\n  ),\n\n  total_monthly_sum AS (\n    SELECT SUM(cb_last) AS msum\n    FROM combined_with_filled_values_cutoff_at_inception_and_termination\n    WHERE DATE_TRUNC('month', Date) = (SELECT prev_month_first FROM month_dates)\n  ),\n\n  combined_by_monthly_percentage AS (\n    SELECT Galileo_account_id,\n           cb_last,\n           (CASE WHEN cb_last IS NULL THEN 0\n                 WHEN cb_last IS NOT NULL THEN cb_last END) AS Current_balance,\n           (SELECT msum FROM total_monthly_sum) AS Monthly_sum,\n           (CASE WHEN Monthly_sum IS NULL THEN 0\n                 WHEN Monthly_sum = 0 THEN 0\n                 WHEN Monthly_sum > 0 THEN Current_balance / Monthly_sum END) AS Day_share,\n           Date\n    FROM combined_with_filled_values_cutoff_at_inception_and_termination\n    WHERE DATE_TRUNC('month', Date) = (SELECT prev_month_first FROM month_dates)\n  ),\n\n  promontory_fees_sum AS (\n    SELECT pnf.value\n    FROM edw.etl_promontory_network_fee pnf\n    WHERE DATE_TRUNC('month', pnf.date::date) = (SELECT prev_month_first FROM month_dates)\n  ),\n\n  combined_final AS (\n    SELECT fa.Account_dep_inv_id,\n           c.Date,\n           SUM(Day_share) AS Share\n    FROM fitting_accounts fa\n           INNER JOIN combined_by_monthly_percentage c ON c.Galileo_account_id = fa.Galileo_account_id\n    GROUP BY fa.Account_dep_inv_id, c.Date\n  )\n\nSELECT current_date() AS execution,\n       un.user_id AS User_id,\n       un.account_id AS Account_id,\n       cf.Account_dep_inv_id AS Depository_id,\n       NULL AS Investment_id,\n       'Depository'::text AS Account_type,\n       (CASE\n          WHEN dep.product_id = 4 THEN 'Spend'::text\n          WHEN dep.product_id = 5 THEN 'Save'::text\n          ELSE ''::text\n         END) AS Product_type,\n--        2 AS Account_product_type_id,\n--        'Depository'::text AS Account_product_type_name,\n--        dep.product_id AS Account_product_id,\n--        (CASE\n--           WHEN Account_product_id = 3 THEN 'Summit'::text\n--           WHEN Account_product_id = 4 THEN 'Spend'::text\n--           WHEN Account_product_id = 5 THEN 'Save'::text\n--           ELSE ''::text\n--          END) AS Account_product_name,\n       FALSE AS Non_customer,\n       'Indirect'::text AS Category,\n       'Promontory Network Fee'::text AS Item,\n       cf.Date,\n       -(cf.Share * (SELECT p.value FROM promontory_fees_sum p)) AS Value,\n       'Cost'::text AS Value_type\nFROM combined_final cf\n       INNER JOIN web_db.depository dep ON cf.Account_dep_inv_id = dep.id\n       INNER JOIN edw.view_unique_user_accounts un ON dep.account_id = un.account_id;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2963663]},"2963648":{"id":2963648,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":-1785670938,"x":-1008,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963687],"outputSuccessConnectorIDs":[2963683],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Begin 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963649":{"id":2963649,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-480,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963681],"outputSuccessConnectorIDs":[2963685],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_consolidated_pnl"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_consolidated_pnl"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Source_table"},"2":{"slot":2,"type":"STRING","value":"${Target_table}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Item_name"},"2":{"slot":2,"type":"STRING","value":"${Item_name}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963650":{"id":2963650,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":-1540940111,"x":-752,"y":-112,"width":32,"height":32,"inputConnectorIDs":[2963698],"outputSuccessConnectorIDs":[2963686],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rollback 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963688":{"id":2963688,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-816,"y":-272,"width":32,"height":16,"inputConnectorIDs":[2963691],"outputSuccessConnectorIDs":[2963684],"outputFailureConnectorIDs":[2963660],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Grid Iterator 0"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Months"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Month"},"2":{"slot":2,"type":"STRING","value":"Month_iterator"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2963663],"inputIterationConnectorIDs":[]},"2963689":{"id":2963689,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1104,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963700],"outputSuccessConnectorIDs":[2963687],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Months"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nimport datetime\nimport math\n\nnow = datetime.datetime.today() \nstart = datetime.datetime(2019, 4, 1)\n\ndelta = now - start\n\nmonthslist = []\n\nmonthq = ((start.year - now.year) * 12 + start.month - now.month)\n\nprint(monthq)\n\ni = monthq\nwhile i < 0:\n monthslist.append([i])\n i = i + 1\ncontext.updateGridVariable('Months', monthslist)\nprint Months\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963692":{"id":2963692,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-864,"y":-112,"width":32,"height":32,"inputConnectorIDs":[2963660,2963661],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2963698],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963693":{"id":2963693,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":977205684,"x":-708,"y":-237,"width":32,"height":32,"inputConnectorIDs":[2963684],"outputSuccessConnectorIDs":[2963681],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Commit 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963694":{"id":2963694,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1312,"y":-160,"width":32,"height":32,"inputConnectorIDs":[2963699],"outputSuccessConnectorIDs":[2963690],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_view_accounts_termination_dates"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_view_accounts_termination_dates"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963695":{"id":2963695,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-657,"y":-112,"width":32,"height":32,"inputConnectorIDs":[2963686],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2963680":{"id":2963680,"sourceID":2963603,"targetID":2963602},"2963681":{"id":2963681,"sourceID":2963693,"targetID":2963649},"2963682":{"id":2963682,"sourceID":2963605,"targetID":2963602},"2963683":{"id":2963683,"sourceID":2963648,"targetID":2963601},"2963684":{"id":2963684,"sourceID":2963688,"targetID":2963693},"2963685":{"id":2963685,"sourceID":2963649,"targetID":2963606},"2963686":{"id":2963686,"sourceID":2963650,"targetID":2963695},"2963687":{"id":2963687,"sourceID":2963689,"targetID":2963648},"2963690":{"id":2963690,"sourceID":2963694,"targetID":2963602},"2963691":{"id":2963691,"sourceID":2963601,"targetID":2963688}},"failureConnectors":{"2963660":{"id":2963660,"sourceID":2963688,"targetID":2963692},"2963661":{"id":2963661,"sourceID":2963601,"targetID":2963692}},"unconditionalConnectors":{"2963696":{"id":2963696,"sourceID":2963604,"targetID":2963603},"2963697":{"id":2963697,"sourceID":2963604,"targetID":2963605},"2963698":{"id":2963698,"sourceID":2963692,"targetID":2963650},"2963699":{"id":2963699,"sourceID":2963604,"targetID":2963694},"2963700":{"id":2963700,"sourceID":2963602,"targetID":2963689}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"2963663":{"id":2963663,"sourceID":2963688,"targetID":2963607}},"noteConnectors":{},"notes":{"2963610":{"id":2963610,"x":-394,"y":-281,"width":91,"height":90,"text":"for development","colour":"d60000"}},"variables":{"Consolidated_table":{"definition":{"name":"Consolidated_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"consolidated_pnl"},"Item_name":{"definition":{"name":"Item_name","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"'Promontory Network Fee'"},"Month_iterator":{"definition":{"name":"Month_iterator","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"-15"},"Pnl_schema":{"definition":{"name":"Pnl_schema","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"edw"},"Target_table":{"definition":{"name":"Target_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"promontory_network_fee"}},"grids":{"Months":{"definition":{"name":"Months","scope":"BRANCH","definitions":[{"name":"Month","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]}}},"info":{"name":"pnl_init_promontory_network_fee","description":"Initialization of Item in PnL Report schema and load all data incl historical","type":"ORCHESTRATION","tag":"d20fc9d0-8777-45d1-a7a8-162ca3a4f5de"}}