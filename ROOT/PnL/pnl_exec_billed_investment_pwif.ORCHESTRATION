{"job":{"components":{"2963072":{"id":2963072,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-544,"y":-64,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"drop table ${Pnl_schema}.${Target_table};\n\n\n--delete from ${Pnl_schema}.${Target_table}\n--where \n--date_part(year, cast(${Pnl_schema}.${Target_table}.date as date)) = date_part(year, current_date)\n--and\n--date_part(month, cast(${Pnl_schema}.${Target_table}.date as date)) = date_part(month, current_date) - 1;\n--delete from ${Pnl_schema}.${Consolidated_table}\n--where \n--date_part(year, cast(${Pnl_schema}.${Consolidated_table}.date as date)) = date_part(year, current_date)\n--and\n--date_part(month, cast(${Pnl_schema}.${Consolidated_table}.date as date)) = date_part(month, current_date) - 1"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963073":{"id":2963073,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1152,"y":-160,"width":32,"height":32,"inputConnectorIDs":[2963090],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_billed_investment_pwif"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_billed_investment_pwif"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963074":{"id":2963074,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":977205684,"x":-640,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963093],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Commit 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963075":{"id":2963075,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":-1785670938,"x":-1072,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963091],"outputSuccessConnectorIDs":[2963094],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Begin 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963076":{"id":2963076,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-960,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963094],"outputSuccessConnectorIDs":[2963095],"outputFailureConnectorIDs":[2963054],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delete -1 quarter"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delete from edw.${Target_table}\nwhere \ndate_part(year, cast(edw.${Target_table}.date as date)) = date_part(year, dateadd(quarter, -1, current_date))\nand\ndate_part(quarter, cast(edw.${Target_table}.date as date)) = date_part(quarter, dateadd(quarter, -1, current_date))"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963077":{"id":2963077,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-736,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963092],"outputSuccessConnectorIDs":[2963093],"outputFailureConnectorIDs":[2963051],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Consolidated"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"-- Delete existing data\nDELETE FROM edw.${Consolidated_table} \nWHERE Item = ${Item_name} \n\tand\ndate_part(year, cast(edw.${Consolidated_table}.date as date)) = date_part(year, dateadd(quarter, -1, current_date))\nand\ndate_part(quarter, cast(edw.${Consolidated_table}.date as date)) = date_part(quarter, dateadd(quarter, -1, current_date));\n\n-- Insert updated data\n\nINSERT INTO edw.${Consolidated_table}(execution,\n                                 User_id,\n                                 Account_id,\n                                 Depository_id,\n       \t\t\t\t\t\t\t Investment_id,\n                                 Account_type,\n                                 Product_type,\n                                 --Account_product_type_id,\n                                 --Account_product_type_name,\n                                 --Account_investment_type_id,\n                                 --Account_investment_type_name,\n                                 --Account_type_id,\n                                 --Account_type_name,\n                                 --Account_product_id,\n                                 --Account_product_name,\n                                 Non_customer,\n                                 Category,\n                                 Item,\n                                 Value_type,\n                                 Value,\n                                 Date)\n(SELECT execution,\n       User_id,\n       Account_id,\n       Depository_id,\n       Investment_id,\n       Account_type,\n       Product_type,\n       --Account_product_type_id,\n       --Account_product_type_name,\n       --Account_investment_type_id,\n       --Account_investment_type_name,\n       --Account_type_id,\n       --Account_type_name,\n       --Account_product_id,\n       --Account_product_name,\n       Non_customer,\n       Category,\n       Item,\n       Value_type,\n       Value,\n       Date\nFROM edw.${Target_table}\nwhere\t\ndate_part(year, cast(edw.${Target_table}.date as date)) = date_part(year, dateadd(quarter, -1, current_date))\nand\ndate_part(quarter, cast(edw.${Target_table}.date as date)) = date_part(quarter, dateadd(quarter, -1, current_date)));"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963078":{"id":2963078,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1376,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963088],"outputSuccessConnectorIDs":[2963089],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Target table check"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\ncursor = context.cursor()\ntry:\n\tcursor.execute('select cast(exists(select * from edw.'+Target_table+' limit 1) as integer)')\n\tresult = cursor.fetchone()[0]\n\tcontext.updateVariable('Exist_check_Target_table', result)\nexcept:\n  \tcontext.updateVariable('Exist_check_Target_table', '0')\n    \nprint ('Variable value: '+str(Exist_check_Target_table))"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963079":{"id":2963079,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-1280,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963089],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[2963091],"outputFalseConnectorIDs":[2963090],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Exist_check_Target_table"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963080":{"id":2963080,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1648,"y":-240,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2963053],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963082":{"id":2963082,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-544,"y":-128,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRANT"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"spashchenko.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"ashumakov.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"vfigurkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"opetrova.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"idudkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"spashchenko.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"ashumakov.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"vfigurkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"opetrova.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"idudkin.ctr\";"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963083":{"id":2963083,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-848,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963095],"outputSuccessConnectorIDs":[2963092],"outputFailureConnectorIDs":[2963055],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Execution -1 quarter"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SET timezone = 'America/Los_Angeles';\n\nINSERT INTO edw.${Target_table}(execution,\n                                User_id,\n                                Account_id,\n                                Depository_id,\n                                Investment_id,\n                                Account_type,\n                                Product_type,\n--                                         Account_product_type_id,\n--                                         Account_product_type_name,\n--                                         Account_type_id,\n--                                         Account_type_name,\n--                                         Account_investment_type_id,\n--                                         Account_investment_type_name,\n                                Non_customer,\n                                Category,\n                                Item,\n                                Date,\n                                Value,\n                                Value_type,\n                                Released_value)\n\nWITH\n  quarter_dates AS (\n    SELECT DATE_TRUNC(quarter, current_date) AS cur_quart_first,\n           DATE_TRUNC(quarter, DATEADD(quarter, -1, cur_quart_first)) AS prev_quart_first,\n           cur_quart_first - 1 AS prev_quart_last,\n           DATE_TRUNC(year, DATEADD(quarter, 4, cur_quart_first)) AS prev_quart_next_year,\n           DATEDIFF(day, DATE_TRUNC(year, prev_quart_first), prev_quart_next_year) AS days_in_year\n  ),\n\n  real_fees AS (\n    SELECT investment_id, SUM(fee_amount) AS fee_amount\n    FROM web_db.investment_fee AS fees\n    WHERE DATE_TRUNC(quarter, fees.last_updated) =\n          DATE_TRUNC(quarter, (SELECT cur_quart_first FROM quarter_dates))\n    GROUP BY investment_id\n  ),\n\n  list_of_investments AS (\n    SELECT DISTINCT id AS Investment_id\n    FROM web_db.investment\n    ORDER BY Investment_id DESC\n  ),\n\n  date_gen AS (\n    SELECT DATEADD('day', i.i - 1, DATE_TRUNC(quarter, (SELECT prev_quart_first FROM quarter_dates) - 1)) AS Date\n    FROM (\n           SELECT ROW_NUMBER() OVER(ORDER BY SEQ4()) i\n           FROM TABLE (\n                    GENERATOR(\n                            ROWCOUNT => 200\n                        )\n               )\n         ) i\n    WHERE DATE_TRUNC(quarter, Date) < (SELECT cur_quart_first FROM quarter_dates)\n  ),\n\n  investments_accounts_all_dates AS (\n    SELECT Investment_id, qd.Date::date as iaad_date FROM list_of_investments\n                                                    CROSS JOIN date_gen qd\n  ),\n\n  current_balances AS (\n    SELECT investment_id, current_value, last_updated::date as cb_last_updated\n    FROM web_db.investment_position\n    WHERE DATE_TRUNC(quarter, last_updated) >= DATE_TRUNC(quarter, (SELECT prev_quart_first FROM quarter_dates) - 1)\n      AND DATE_TRUNC(quarter, last_updated) < DATE_TRUNC(quarter, (SELECT cur_quart_first FROM quarter_dates))\n    ORDER BY investment_id, last_updated\n  ),\n\n  combined AS (\n    SELECT ad.Investment_id, current_value, cb_last_updated as last_updated, ad.iaad_date AS Date\n    FROM current_balances cb\n           RIGHT JOIN investments_accounts_all_dates ad\n                      ON ad.iaad_date = cb.cb_last_updated AND ad.Investment_id = cb.investment_id\n    ORDER BY ad.Investment_id, ad.iaad_date\n  ),\n\n  combined_with_filled_values AS (\n    SELECT Investment_id,\n           (CASE\n              WHEN combined.current_value IS NULL\n                THEN FIRST_VALUE(combined.current_value::float IGNORE NULLS) OVER\n                (PARTITION BY Investment_id ORDER BY Date DESC, Investment_id DESC\n                ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)\n              WHEN combined.current_value IS NOT NULL\n                THEN combined.current_value::float END) AS cb_last,\n           Date\n    FROM combined\n    ORDER BY Investment_id, Date\n  ),\n\n  balances_last_quarter AS (\n    SELECT Investment_id, cb_last, Date\n    FROM combined_with_filled_values\n    WHERE DATE_TRUNC(quarter, Date) = (SELECT prev_quart_first FROM quarter_dates)\n  ),\n\n  sums_last_quarter AS (\n    SELECT Investment_id, SUM(cb_last) AS quarter_sum\n    FROM balances_last_quarter\n    GROUP BY Investment_id\n  ),\n\n  real_fees_by_pct AS (\n    SELECT b.Investment_id,\n           b.cb_last AS balance,\n           s.quarter_sum AS balance_quarter_sum,\n           (CASE WHEN s.quarter_sum = 0 THEN 0\n                 ELSE b.cb_last * 100 / quarter_sum END) AS day_pct,\n           r.fee_amount AS quarter_fee,\n           r.fee_amount * day_pct / 100 AS daily_fee,\n           b.Date::date as rfbp_date\n    FROM balances_last_quarter b\n           INNER JOIN sums_last_quarter s ON s.Investment_id = b.Investment_id\n           INNER JOIN real_fees r ON r.investment_id = b.Investment_id\n  ),\n\n  projected_fee AS (\n    SELECT inv.Investment_id,\n           inv.Value AS projected_daily_fee,\n           inv.Date::date as pf_date\n    FROM edw.gross_investment_pwif inv\n    WHERE DATE_TRUNC(quarter, inv.date) = (SELECT prev_quart_first FROM quarter_dates)\n  ),\n\n  delta_inv_pwif AS (\n    SELECT\n      acc.id AS Account_id,\n      p.Investment_id AS Investment_id,\n      r.daily_fee,\n      p.projected_daily_fee,\n      (CASE WHEN r.daily_fee IS NULL THEN projected_daily_fee\n            ELSE projected_daily_fee - daily_fee END) AS daily_delta_amount,\n      p.pf_date as date\n\n    FROM projected_fee p\n           LEFT JOIN real_fees_by_pct r ON p.Investment_id = r.Investment_id AND p.pf_date = r.rfbp_date\n           INNER JOIN web_db.investment inv ON inv.id = p.Investment_id\n           INNER JOIN web_db.account acc ON acc.id = inv.account_id\n  ),\n\n  investment_pwif_release AS (\n    SELECT current_date() AS execution,\n           ua.user_id AS User_id,\n           del.Account_id,\n           del.Investment_id AS Investment_id,\n           'Investment'::text AS Account_type,\n           (CASE\n              WHEN Account_type_id = 2 -- 'Individual'\n                AND inv.fund_id = 1 -- 'Flagship'\n                THEN 'Flagship Individual'::text\n              WHEN Account_type_id = 2 -- 'Individual'\n                AND inv.fund_id = 2 -- 'Redwood'\n                THEN 'Redwood Individual'::text\n              WHEN Account_type_id = 3 -- 'IRA'\n                AND inv.fund_id = 1 -- 'Flagship'\n                THEN 'Flagship IRA'::text\n              WHEN Account_type_id = 3 -- 'IRA'\n                AND inv.fund_id = 2 -- 'Redwood'\n                THEN 'Redwood IRA'::text\n              ELSE ''::text\n             END) AS Product_type,\n\n--            acc.product_type AS Account_product_type_id,\n--            'Investment'::text AS Account_product_type_name,\n--            acc.account_type_id AS Account_type_id,\n--            (CASE\n--               WHEN Account_type_id = 2 THEN 'Individual'::text\n--               WHEN Account_type_id = 3 THEN 'IRA'::text\n--               ELSE ''\n--              END) AS Account_type_name,\n--            inv.fund_id AS Account_investment_type_id,\n--            (CASE\n--               WHEN Account_investment_type_id = 1 THEN 'Flagship'::text\n--               WHEN Account_investment_type_id = 2 THEN 'Redwood'::text\n--               ELSE ''\n--              END) AS Account_investment_type_name,\n           FALSE AS Non_customer,\n           'Direct'::text AS Category,\n           'Billed Investment PWIF'::text AS Item,\n           del.Date AS Date,\n           -daily_delta_amount As Released_value,\n           'Revenue'::text AS Value_type,\n           (CASE WHEN daily_fee IS NULL THEN 0\n                 ELSE daily_fee END) AS Value\n\n    FROM delta_inv_pwif AS del\n           INNER JOIN web_db.account AS acc ON acc.id = del.Account_id\n           INNER JOIN web_db.investment AS inv ON inv.id = del.Investment_id\n           INNER JOIN web_db.user_account AS ua ON ua.account_id = acc.id\n  )\n\nSELECT execution, User_id, Account_id, NULL AS Depository_id, Investment_id,\n       Account_type, Product_type,\n--        Account_product_type_id, Account_product_type_name,\n--        Account_type_id, Account_type_name, Account_investment_type_id, Account_investment_type_name,\n       Non_customer, Category, Item, Date, Value, Value_type, Released_value\n\nFROM investment_pwif_release;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963096":{"id":2963096,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-656,"y":-368,"width":32,"height":32,"inputConnectorIDs":[2963098],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963097":{"id":2963097,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-848,"y":-320,"width":32,"height":32,"inputConnectorIDs":[2963051,2963054,2963055],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2963052],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963099":{"id":2963099,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1520,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963053],"outputSuccessConnectorIDs":[2963088],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_exec_gross_investment_pwif"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_exec_gross_investment_pwif"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963100":{"id":2963100,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":-1540940111,"x":-736,"y":-368,"width":32,"height":32,"inputConnectorIDs":[2963052],"outputSuccessConnectorIDs":[2963098],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rollback 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2963088":{"id":2963088,"sourceID":2963099,"targetID":2963078},"2963089":{"id":2963089,"sourceID":2963078,"targetID":2963079},"2963092":{"id":2963092,"sourceID":2963083,"targetID":2963077},"2963093":{"id":2963093,"sourceID":2963077,"targetID":2963074},"2963094":{"id":2963094,"sourceID":2963075,"targetID":2963076},"2963095":{"id":2963095,"sourceID":2963076,"targetID":2963083},"2963098":{"id":2963098,"sourceID":2963100,"targetID":2963096}},"failureConnectors":{"2963051":{"id":2963051,"sourceID":2963077,"targetID":2963097},"2963054":{"id":2963054,"sourceID":2963076,"targetID":2963097},"2963055":{"id":2963055,"sourceID":2963083,"targetID":2963097}},"unconditionalConnectors":{"2963052":{"id":2963052,"sourceID":2963097,"targetID":2963100},"2963053":{"id":2963053,"sourceID":2963080,"targetID":2963099}},"trueConnectors":{"2963091":{"id":2963091,"sourceID":2963079,"targetID":2963075}},"falseConnectors":{"2963090":{"id":2963090,"sourceID":2963079,"targetID":2963073}},"iterationConnectors":{},"noteConnectors":{},"notes":{"2963081":{"id":2963081,"x":-587,"y":-168,"width":87,"height":140,"text":"for development","colour":"d60000"}},"variables":{"Consolidated_table":{"definition":{"name":"Consolidated_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"consolidated_pnl"},"Exist_check_Target_table":{"definition":{"name":"Exist_check_Target_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"Item_name":{"definition":{"name":"Item_name","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"'Billed Investment PWIF'"},"Month_iterator":{"definition":{"name":"Month_iterator","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"Pnl_schema":{"definition":{"name":"Pnl_schema","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"edw"},"Target_table":{"definition":{"name":"Target_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PRIVATE"},"value":"billed_investment_pwif"}},"grids":{}},"info":{"name":"pnl_exec_billed_investment_pwif","description":"Script for updating item on regular basis","type":"ORCHESTRATION","tag":"b32dc8cf-98b5-4815-9db0-910afa3d22d1"}}