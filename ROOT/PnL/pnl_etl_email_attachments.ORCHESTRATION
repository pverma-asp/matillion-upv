{"job":{"components":{"2962809":{"id":2962809,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1963777357,"x":-160,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2962808],"outputSuccessConnectorIDs":[2962805],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Gmail Query 0"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Basic"}}}},"visible":true},"3":{"slot":3,"name":"Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"svcdata"}}}},"visible":true},"6":{"slot":6,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Gmail/Sent Mail"}}}},"visible":true},"7":{"slot":7,"name":"Data Selection","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Attachments"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"AttachmentData"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"MessageBody"}}}},"visible":true},"8":{"slot":8,"name":"Data Source Filter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"downloadAttachments"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"true"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"id"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"${mail_id}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"AttachmentFolder"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"${EC2_folder}"}}}},"visible":true},"9":{"slot":9,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"10":{"slot":10,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT ..."}}}},"visible":false},"11":{"slot":11,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":true},"12":{"slot":12,"name":"Connection Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IncludeMessage"},"2":{"slot":2,"type":"STRING","value":"TRUE"}}}},"visible":true},"13":{"slot":13,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"14":{"slot":14,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"EDW"}}}},"visible":true},"15":{"slot":15,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_mail"}}}},"visible":true},"16":{"slot":16,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"17":{"slot":17,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"aspiration-etl-staging"}}}},"visible":true},"18":{"slot":18,"name":"Primary Keys","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Gmail"}}}},"visible":false},"102":{"slot":102,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"103":{"slot":103,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1013":{"slot":1013,"name":"Auto Debug","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}}},"visible":true},"1014":{"slot":1014,"name":"Debug Level","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"3"}}}},"visible":false},"1015":{"slot":1015,"name":"Authentication Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OAuth"}}}},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"40501":{"slot":40501,"name":"","elements":{},"visible":false},"40502":{"slot":40502,"name":"Load Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":""}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}}},"visible":true},"63320":{"slot":63320,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63321":{"slot":63321,"name":"Blob Container","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88340":{"slot":88340,"name":"","elements":{},"visible":false},"88341":{"slot":88341,"name":"Staging","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Existing Amazon S3 Location"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962812":{"id":2962812,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":560,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2962811],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Archive files"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\necho $s3_bucket/$txt_file_name\necho $s3_bucket/$txt_archive_file_name\necho $s3_bucket/$pdf_archive_file_name\naws s3 mv $S3_Bucket/$pdf_file_name_new $S3_Bucket/$pdf_archived_file_name\naws s3 mv $S3_Bucket/$TXT_Name $S3_Bucket/$txt_archived_file_name\n"}}}},"visible":true},"3":{"slot":3,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962813":{"id":2962813,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":48,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2962810],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[2962803],"outputFalseConnectorIDs":[2962802],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If 0"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"attachment"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962814":{"id":2962814,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1611478312,"x":-272,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2962861],"outputSuccessConnectorIDs":[2962808],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create Table 0"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"EDW"}}}},"visible":true},"4":{"slot":4,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_mail"}}}},"visible":true},"5":{"slot":5,"name":"Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"id"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"255"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":"None"},"6":{"slot":6,"type":"STRING","value":"Yes"},"7":{"slot":7,"type":"STRING","value":"No"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"attachments"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"20000"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":"None"},"6":{"slot":6,"type":"STRING","value":"Yes"},"7":{"slot":7,"type":"STRING","value":"No"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"attachmentdata"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"65535"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":"None"},"6":{"slot":6,"type":"STRING","value":"Yes"},"7":{"slot":7,"type":"STRING","value":"No"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"messagebody"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"65535"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":"None"},"6":{"slot":6,"type":"STRING","value":"Yes"},"7":{"slot":7,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Create/Replace","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create if not exists"}}}},"visible":true},"7":{"slot":7,"name":"Clustering Keys","elements":{},"visible":true},"8":{"slot":8,"name":"Data Retention Time in Days","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"9":{"slot":9,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"11":{"slot":11,"name":"Primary Keys","elements":{},"visible":true},"12":{"slot":12,"name":"Table Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Permanent"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962815":{"id":2962815,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":48,"y":64,"width":32,"height":32,"inputConnectorIDs":[2962802],"outputSuccessConnectorIDs":[2962801],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_etl_tymeshift_txt_to_table"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_etl_tymeshift_txt_to_table"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"mail_id"},"2":{"slot":2,"type":"STRING","value":"${mail_id}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962832":{"id":2962832,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-158614544,"x":368,"y":-48,"width":32,"height":16,"inputConnectorIDs":[2962804],"outputSuccessConnectorIDs":[2962806],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Retry 0"}}}},"visible":true},"2":{"slot":2,"name":"Number of Retries","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"5"}}}},"visible":true},"3":{"slot":3,"name":"Retry Delay","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Long delay"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2962860],"inputIterationConnectorIDs":[]},"2962833":{"id":2962833,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":368,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"parsing"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${parsing_job}"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"txt_file_name"},"2":{"slot":2,"type":"STRING","value":"${TXT_Name}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2962860]},"2962834":{"id":2962834,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1963777357,"x":48,"y":160,"width":32,"height":32,"inputConnectorIDs":[2962801],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Set parsed with no attach"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"svc data Gmail"}}}},"visible":true},"6":{"slot":6,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Gmail/Sent Mail"}}}},"visible":false},"7":{"slot":7,"name":"Data Selection","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Attachments"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"AttachmentData"}}}},"visible":false},"8":{"slot":8,"name":"Data Source Filter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"downloadAttachments"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"true"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"id"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"${mail_id}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"AttachmentFolder"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"${EC2_folder}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"HasAttachments"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"true"}}}},"visible":false},"9":{"slot":9,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":false},"10":{"slot":10,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"--\nupdate \"Gmail/Sent Mail\" SET [Labels] = 'Parsed' WHERE Id = ${mail_id} \n--"}}}},"visible":true},"11":{"slot":11,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"12":{"slot":12,"name":"Connection Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IncludeMessage"},"2":{"slot":2,"type":"STRING","value":"TRUE"}}}},"visible":true},"14":{"slot":14,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"edw"}}}},"visible":true},"15":{"slot":15,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_mail"}}}},"visible":true},"17":{"slot":17,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"aspiration-etl-staging"}}}},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"21":{"slot":21,"name":"Primary Key","elements":{},"visible":true},"102":{"slot":102,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"idb.notification.test@gmail.com"}}}},"visible":false},"103":{"slot":103,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sa060687"}}}},"visible":false},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1013":{"slot":1013,"name":"Auto Debug","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}}},"visible":true},"1014":{"slot":1014,"name":"Debug Level","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"3"}}}},"visible":false},"1015":{"slot":1015,"name":"Authentication Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OAuth"}}}},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962835":{"id":2962835,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":256,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2962807],"outputSuccessConnectorIDs":[2962804],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sleep 45s"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\nimport time\n\ntime.sleep(45)\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962836":{"id":2962836,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1963777357,"x":464,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2962806],"outputSuccessConnectorIDs":[2962811],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Set parsed"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"svc data Gmail"}}}},"visible":true},"6":{"slot":6,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Gmail/Sent Mail"}}}},"visible":false},"7":{"slot":7,"name":"Data Selection","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Attachments"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"AttachmentData"}}}},"visible":false},"8":{"slot":8,"name":"Data Source Filter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"downloadAttachments"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"true"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"id"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"${mail_id}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"AttachmentFolder"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"${EC2_folder}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"HasAttachments"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"true"}}}},"visible":false},"9":{"slot":9,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":false},"10":{"slot":10,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"--\nupdate \"Gmail/Sent Mail\" SET [Labels] = 'Parsed' WHERE Id = ${mail_id}\n--"}}}},"visible":true},"11":{"slot":11,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"12":{"slot":12,"name":"Connection Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IncludeMessage"},"2":{"slot":2,"type":"STRING","value":"TRUE"}}}},"visible":true},"14":{"slot":14,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"edw"}}}},"visible":true},"15":{"slot":15,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_mail"}}}},"visible":true},"17":{"slot":17,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"aspiration-etl-staging"}}}},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"21":{"slot":21,"name":"Primary Key","elements":{},"visible":true},"102":{"slot":102,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"idb.notification.test@gmail.com"}}}},"visible":false},"103":{"slot":103,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sa060687"}}}},"visible":false},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1013":{"slot":1013,"name":"Auto Debug","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}}},"visible":true},"1014":{"slot":1014,"name":"Debug Level","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"3"}}}},"visible":false},"1015":{"slot":1015,"name":"Authentication Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OAuth"}}}},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962837":{"id":2962837,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-128,"y":160,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"EC2 > S3 move everything"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\n\n#sudo chmod a+r /tmp/aspiration-pnl-project/\ncd $EC2_folder\nls \n\naws s3 mv . $S3_Bucket --recursive\n\n#ls"}}}},"visible":true},"3":{"slot":3,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962838":{"id":2962838,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":144,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2962803],"outputSuccessConnectorIDs":[2962807],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"EC2 >>S3"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cd $EC2_folder\nls\nrename ' ' '_' *.*\nrename ' ' '_' *.*\nrename ' ' '_' *.*\nrename ' ' '_' *.*\nrename ' ' '_' *.*\nrename ' ' '_' *.*\nrename ' ' '_' *.*\nrename ' ' '_' *.*\nrename ' ' '_' *.*\nrename ' ' '_' *.*\nls\nmv $pdf_file_name_old $pdf_file_name_new\naws s3 cp $pdf_file_name_new $S3_Bucket"}}}},"visible":true},"3":{"slot":3,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962839":{"id":2962839,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-48,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2962805],"outputSuccessConnectorIDs":[2962810],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update file name variable"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"def func():\n  cursor = context.cursor()\n  id = mail_id\n  query = \"SELECT MAX(attachments) FROM edw.etl_mail WHERE id = '\" + str(id) + \"'\"\n  cursor.execute(query)\n  result = cursor.fetchone()\n  \n  if result[0] == None:\n    return  \n  if result == (u';',):\t\n   \treturn context.updateVariable(\"attachment\", \"0\")\n\n  file_name = result[0].split(';')[2].replace(' ', '_')\n  context.updateVariable(\"pdf_file_name_old\", file_name)\n  print(pdf_file_name_old)\n  file_name = file_name.lower()\n\n  if (file_name.find(\"expense\") != -1 and file_name.endswith(\".pdf\")):\n    file_name = \"coastal_exp_reimb_\" + file_name.split('.')[0] + \"_\" + str(id) + \".pdf\"\n    context.updateVariable(\"parsing_job\", \"pnl_etl_coastal_exp_reimb_txt_to_table\")\n  elif (file_name.find(\"quarter\") != -1 and file_name.find(\"fee\") != -1 and file_name.endswith(\".pdf\")):\n    file_name = \"coastal_quart_fee_\" + file_name.split('.')[0] + \"_\" + str(id) + \".pdf\"\n    context.updateVariable(\"parsing_job\", \"pnl_etl_coastal_quarterly_fee\")\n  elif (file_name.find(\"zendes\") != -1 and file_name.endswith(\".pdf\")):\n    file_name = \"call_center_zen_\" + file_name.split('.')[0] + \"_\" + str(id) + \".pdf\"\n    context.updateVariable(\"parsing_job\", \"pnl_etl_zendesk_txt_to_table\")\n  elif (file_name.find(\"talkdes\") != -1 and file_name.endswith(\".pdf\")):\n    file_name = \"call_center_talk_\" + file_name.split('.')[0] + \"_\" + str(id) + \".pdf\"\n    context.updateVariable(\"parsing_job\", \"pnl_etl_talkdesk_txt_to_table\")\n  elif (file_name.find(\"return\") != -1 and file_name.endswith(\".pdf\")):\n    file_name = \"return_fees_\" + file_name.split('.')[0] + \"_\" + str(id) + \".pdf\"\n    context.updateVariable(\"parsing_job\", \"pnl_etl_return_fee_txt_to_table\")\n  elif (file_name.find(\"process\") != -1 and file_name.endswith(\".pdf\")):\n    file_name = \"galileo_processing_fees_\" + file_name.split('.')[0] + \"_\" + str(id) + \".pdf\"\n    context.updateVariable(\"parsing_job\", \"pnl_etl_galileo_processing_fee_txt_to_table\")\n  elif ((file_name.find(\"360\") != -1 or file_name.find(\"363\") != -1\n         or file_name.find(\"flagship\") != -1 or file_name.find(\"redwood\") != -1)\n        and file_name.endswith(\".pdf\")):\n    file_name = \"nottingham_\" + file_name.split('.')[0] + \"_\" + str(id) + \".pdf\"\n    context.updateVariable(\"parsing_job\", \"pnl_etl_nottingham_txt_to_table\")\n \n  context.updateVariable(\"pdf_file_name_new\", file_name)\n  context.updateVariable(\"pdf_archived_file_name\", 'pdf_archive/' + file_name + '.bak')\n  \n  print(pdf_file_name_old)\n  print(pdf_file_name_new)\n  \n  context.updateVariable(\"TXT_Name\", \"txt/\"+file_name[:-4]+\".txt\")\n  context.updateVariable(\"txt_archived_file_name\", \"txt_archive/\"+file_name[:-4]+\".txt\")\n  print(TXT_Name)\n  print(parsing_job)\nfunc()"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962842":{"id":2962842,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-256,"y":160,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of TMP (1)"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRANT SELECT ON edw.etl_mail TO \"spashchenko.ctr\";\nGRANT SELECT ON edw.etl_mail TO \"ashumakov.ctr\";\nGRANT SELECT ON edw.etl_mail TO \"vfigurkin.ctr\";\nGRANT SELECT ON edw.etl_mail TO \"opetrova.ctr\";\nGRANT SELECT ON edw.etl_mail TO \"idudkin.ctr\";\n--drop table edw.etl_mail\n--delete from  edw.etl_mail\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962843":{"id":2962843,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-384,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2962861],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2962801":{"id":2962801,"sourceID":2962815,"targetID":2962834},"2962804":{"id":2962804,"sourceID":2962835,"targetID":2962832},"2962805":{"id":2962805,"sourceID":2962809,"targetID":2962839},"2962806":{"id":2962806,"sourceID":2962832,"targetID":2962836},"2962807":{"id":2962807,"sourceID":2962838,"targetID":2962835},"2962808":{"id":2962808,"sourceID":2962814,"targetID":2962809},"2962810":{"id":2962810,"sourceID":2962839,"targetID":2962813},"2962811":{"id":2962811,"sourceID":2962836,"targetID":2962812}},"failureConnectors":{},"unconditionalConnectors":{"2962861":{"id":2962861,"sourceID":2962843,"targetID":2962814}},"trueConnectors":{"2962803":{"id":2962803,"sourceID":2962813,"targetID":2962838}},"falseConnectors":{"2962802":{"id":2962802,"sourceID":2962813,"targetID":2962815}},"iterationConnectors":{"2962860":{"id":2962860,"sourceID":2962832,"targetID":2962833}},"noteConnectors":{},"notes":{"2962840":{"id":2962840,"x":-340,"y":-147,"width":336,"height":199,"text":"load attachment from gmail into edw.etl_mail, based on the attachment file name, parse out the old file name and new file name, for example: an attachment should be in EC2 folder of which original name is 'Aspiration_Returns_2.pdf', after parsing its name is 'return_fees_Aspiration_Returns_2_10.pdf'. ","colour":"e6e63c"},"2962841":{"id":2962841,"x":-300,"y":128,"width":240,"height":74,"text":"dev","colour":"d60000"}},"variables":{"EC2_folder":{"definition":{"name":"EC2_folder","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"/tmp/aspiration-pnl-project"},"S3_Bucket":{"definition":{"name":"S3_Bucket","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"s3://aspiration-pnl-project-staging"},"TXT_Name":{"definition":{"name":"TXT_Name","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"txt/call_center_talk_talkdesk_invoice_3.txt"},"attachment":{"definition":{"name":"attachment","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"1"},"mail_id":{"definition":{"name":"mail_id","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"10"},"parsing_job":{"definition":{"name":"parsing_job","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"pdf_archived_file_name":{"definition":{"name":"pdf_archived_file_name","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"pdf_archive/call_center_talk_talkdesk_invoice_3.pdf.bak"},"pdf_file_name_new":{"definition":{"name":"pdf_file_name_new","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"call_center_talk_talkdesk_invoice_3.pdf"},"pdf_file_name_old":{"definition":{"name":"pdf_file_name_old","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"txt_archived_file_name":{"definition":{"name":"txt_archived_file_name","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"txt_archive/call_center_talk_talkdesk_invoice_3.txt"}},"grids":{}},"info":{"name":"pnl_etl_email_attachments","description":"","type":"ORCHESTRATION","tag":"5a61e236-fed4-45d2-8023-c8149fba6b2f"}}