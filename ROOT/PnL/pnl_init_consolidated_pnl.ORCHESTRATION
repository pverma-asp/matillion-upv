{"job":{"components":{"2962689":{"id":2962689,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-232,"y":68,"width":32,"height":32,"inputConnectorIDs":[2962690],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962692":{"id":2962692,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":-1785670938,"x":-528,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2962669],"outputSuccessConnectorIDs":[2962688],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Begin 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962693":{"id":2962693,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-432,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2962688],"outputSuccessConnectorIDs":[2962691],"outputFailureConnectorIDs":[2962668],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Consolidated"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"-- Create Consolidated table if it not exists\nCREATE TABLE IF NOT EXISTS edw.${Consolidated_table}(\n    id                           bigint identity(5676433, 1) not null\n        \t\t\t\t\t\t constraint consolidated_pnl_pkey\t\t\t\t\t\n            \t\t\t\t\t primary key,\n    execution                    timestamp with time zone,\n    user_id                  \t bigint                                             not null,\n    account_id           \t\t bigint                                             ,\n    depository_id\t\t\t\t bigint,\n    investment_id\t\t\t\t bigint,\n    account_type \t\t\t\t varchar(50),\n    product_type \t\t\t\t varchar(50),\n--    account_product_type_id      integer,\n--    account_product_type_name    varchar(50),\n--    account_investment_type_id   integer,\n--    account_investment_type_name varchar(50),\n--    account_type_id              integer,\n--    account_type_name            varchar(50),\n--    account_product_id           integer,\n--    account_product_name         varchar(50),\n    non_customer                 boolean                                            not null,\n    category                     varchar(50)                                        not null,\n    item                         varchar(50)                                        not null,\n    value_type                   varchar(50),\n    value                        numeric(38, 8),\n    date                         timestamp with time zone\n);\n\n-- Delete existing data\nDELETE FROM edw.${Consolidated_table}\nWHERE Item = ${Item_name};\n\n-- Insert updated data\nINSERT INTO edw.${Consolidated_table}(execution,\n                                 User_id,\n                                 Account_id,\n                                 Depository_id,\n                                 Investment_id,\n                                 Account_type,\n                                 Product_type,\n                                 --Account_product_type_id,\n                                 --Account_product_type_name,\n                                 --Account_investment_type_id,\n                                 --Account_investment_type_name,\n                                 --Account_type_id,\n                                 --Account_type_name,\n                                 --Account_product_id,\n                                 --Account_product_name,\n                                 Non_customer,\n                                 Category,\n                                 Item,\n                                 Value_type,\n                                 Value,\n                                 Date)\nSELECT execution,\n       User_id,\n       Account_id,\n       Depository_id,\n\t   Investment_id,\n       Account_type,\n       Product_type,\n       --Account_product_type_id,\n       --Account_product_type_name,\n       --Account_investment_type_id,\n       --Account_investment_type_name,\n       --Account_type_id,\n       --Account_type_name,\n       --Account_product_id,\n       --Account_product_name,\n       Non_customer,\n       Category,\n       Item,\n       Value_type,\n       Value,\n       Date\nFROM edw.${Source_table};"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962694":{"id":2962694,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":-1540940111,"x":-304,"y":64,"width":32,"height":32,"inputConnectorIDs":[2962668],"outputSuccessConnectorIDs":[2962690],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rollback 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962695":{"id":2962695,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":977205684,"x":-304,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2962691],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Commit 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962698":{"id":2962698,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-144,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TMP"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRANT SELECT ON edw.${Consolidated_table} TO \"spashchenko.ctr\";\nGRANT SELECT ON edw.${Consolidated_table} TO \"ashumakov.ctr\";\nGRANT SELECT ON edw.${Consolidated_table} TO \"vfigurkin.ctr\";\nGRANT SELECT ON edw.${Consolidated_table} TO \"opetrova.ctr\";\nGRANT SELECT ON edw.${Consolidated_table} TO \"idudkin.ctr\";\nGRANT SELECT ON edw.${Consolidated_table} TO \"svc_looker\";"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962699":{"id":2962699,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-624,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2962669],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2962688":{"id":2962688,"sourceID":2962692,"targetID":2962693},"2962690":{"id":2962690,"sourceID":2962694,"targetID":2962689},"2962691":{"id":2962691,"sourceID":2962693,"targetID":2962695}},"failureConnectors":{"2962668":{"id":2962668,"sourceID":2962693,"targetID":2962694}},"unconditionalConnectors":{"2962669":{"id":2962669,"sourceID":2962699,"targetID":2962692}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{"2962696":{"id":2962696,"x":-180,"y":-57,"width":78,"height":84,"text":"for dev","colour":"d60000"}},"variables":{"Consolidated_table":{"definition":{"name":"Consolidated_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"consolidated_pnl"},"Item_name":{"definition":{"name":"Item_name","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"Error"},"Source_table":{"definition":{"name":"Source_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"Error"}},"grids":{}},"info":{"name":"pnl_init_consolidated_pnl","description":null,"type":"ORCHESTRATION","tag":"adecf311-c9b2-4be7-91e7-80b3300c52d9"}}