{"job":{"components":{"2962756":{"id":2962756,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-160,"y":-80,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Item execution"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${Execution_script}"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2962754]},"2962757":{"id":2962757,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-304,"y":-80,"width":32,"height":32,"inputConnectorIDs":[2962752],"outputSuccessConnectorIDs":[2962753],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Execution List"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nimport datetime\nimport array\n\nnow = datetime.datetime.now() \nexeclist = []\nmyvar = context.getGridVariable('PnL_execution_rules')\n\ni = 0\nwhile i < len(myvar):\n param = myvar[i]\n if param[1] == '1' and param[3] == 'Daily':\n  execlist.append([param[2]])\n elif param[1] == '1' and param[3][0:7] == 'Monthly' and param[3][11:(len(param[3]))] == str(now.day):\n  execlist.append([param[2]])\n else:\n  print ('skip ' + param[0])\n i = i + 1\ncontext.updateGridVariable('To_execute', execlist)\nprint ('Execution list:')\nprint (To_execute)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962758":{"id":2962758,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":438858066,"x":-16,"y":-80,"width":32,"height":32,"inputConnectorIDs":[2962755],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message 0"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-west-2"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"data-alerts-pagerduty-prod"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AWS Notification Message"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Item calculation in PnL report has failed - ${Execution_script}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962759":{"id":2962759,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-160,"y":-112,"width":32,"height":16,"inputConnectorIDs":[2962753],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[2962755],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Grid Iterator 0"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"To_execute"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Job"},"2":{"slot":2,"type":"STRING","value":"Execution_script"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2962754],"inputIterationConnectorIDs":[]},"2962762":{"id":2962762,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-403,"y":79,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL Script 0"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"drop table edw.gross_depository_pwif;\ndrop table edw.gross_investment_pwif;\n--drop table edw.billed_depository_pwif;\n--drop table edw.billed_investment_pwif;\ndrop table edw.interest_expense;\ndrop table edw.interest_revenue;\ndrop table edw.interchange_revenue;\ndrop table edw.cash_back;\ndrop table edw.atm_network_fee;\ndrop table edw.atm_reimbursement;\ndrop table edw.depository_pwif_charity_payment;\ndrop table edw.investment_pwif_charity_payment;\ndrop table edw.sub_adviser_fee;\ndrop table edw.mastercard_fee;\ndrop table edw.promotions;\ndrop table edw.do_good_dollars;\ndrop table edw.promontory_network_fee;\ndrop table edw.consolidated_pnl;\ndrop table edw.coastal_expense_reimbursement;\ndrop table edw.coastal_quarterly_fee;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962763":{"id":2962763,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-400,"y":-80,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2962752],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2962753":{"id":2962753,"sourceID":2962757,"targetID":2962759}},"failureConnectors":{"2962755":{"id":2962755,"sourceID":2962759,"targetID":2962758}},"unconditionalConnectors":{"2962752":{"id":2962752,"sourceID":2962763,"targetID":2962757}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"2962754":{"id":2962754,"sourceID":2962759,"targetID":2962756}},"noteConnectors":{},"notes":{"2962760":{"id":2962760,"x":-447,"y":41,"width":100,"height":91,"text":"dev","colour":"d60000"}},"variables":{"Current_day":{"definition":{"name":"Current_day","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"Execution_script":{"definition":{"name":"Execution_script","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"pnl_init_consolidated_pnl"}},"grids":{"PnL_execution_rules":{"definition":{"name":"PnL_execution_rules","scope":"TASKBATCH","definitions":[{"name":"Item","type":"TEXT"},{"name":"IsOn","type":"TEXT"},{"name":"Execution_job","type":"TEXT"},{"name":"Rule","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["Billed Depository PWIF","1","pnl_exec_billed_depository_pwif","Monthly on 6"]},{"values":["Billed Investment PWIF","1","pnl_exec_billed_investment_pwif","Monthly on 6"]},{"values":["Interest Expense","1","pnl_exec_interest_expense","Monthly on 6"]},{"values":["Interest Revenue","1","pnl_exec_interest_revenue","Daily"]},{"values":["Interchange Revenue","1","pnl_exec_interchange_revenue","Daily"]},{"values":["Cash Back","1","pnl_exec_cash_back","Daily"]},{"values":["ATM Network Fee","1","pnl_exec_atm_network_fee","Daily"]},{"values":["ATM Reimbursement","1","pnl_exec_atm_reimbursement","Daily"]},{"values":["Depository PWIF Charity Payment","1","pnl_exec_depository_pwif_charity_payment","Daily"]},{"values":["Investment PWIF Charity Payment","1","pnl_exec_investment_pwif_charity_payment","Daily"]},{"values":["Sub-adviser fee","1","pnl_exec_sub_adviser_fee","Monthly on 6"]},{"values":["MasterCard Fee","1","pnl_exec_mastercard_fee","Monthly on 6"]},{"values":["Promotions","1","pnl_exec_promotions","Monthly on 6"]},{"values":["Do Good Dollars","1","pnl_exec_do_good_dollars","Daily"]},{"values":["Promontory Network Fee","1","pnl_exec_promontory_network_fee","Monthly on 6"]},{"values":["Coastal Expense Reimbursement","1","pnl_exec_coastal_expense_reimbursement","Monthly on 6"]},{"values":["Coastal Quarterly Fee","1","pnl_exec_coastal_quarterly_fee","Monthly on 6"]},{"values":["Galileo Processing Fee","1","pnl_exec_galileo_processing_fee","Monthly on 6"]},{"values":["Return Fee","1","pnl_exec_return_fee","Daily"]},{"values":["Call Center License Fee","1","pnl_exec_call_center_license_fee","Monthly on 6"]},{"values":["Call Center Labor Cost","1","pnl_exec_call_center_labor_cost","Monthly on 6"]},{"values":["Flagship Nottingham Fee","1","pnl_exec_flagship_nottingham_fee","Monthly on 6"]},{"values":["Redwood Nottingham Fee","1","pnl_exec_redwood_nottingham_fee","Monthly on 6"]}]},"To_execute":{"definition":{"name":"To_execute","scope":"BRANCH","definitions":[{"name":"Job","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]}}},"info":{"name":"pnl_master","description":null,"type":"ORCHESTRATION","tag":"9b322ac5-8957-484d-9739-8b7b67e1221a"}}