{"job":{"components":{"2964301":{"id":2964301,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1293,"y":-159,"width":32,"height":32,"inputConnectorIDs":[2964385],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_call_center_labor_cost"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_call_center_labor_cost"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964320":{"id":2964320,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1408,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2964306],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2964399],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate etl_tymeshift"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"                                              \nTRUNCATE edw.etl_call_center_tymeshift_ace_tickets"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964321":{"id":2964321,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-560,"y":-272,"width":32,"height":16,"inputConnectorIDs":[2964311],"outputSuccessConnectorIDs":[2964317],"outputFailureConnectorIDs":[2964390],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Grid Iterator 0 (1)"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Months"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Month"},"2":{"slot":2,"type":"STRING","value":"Month_iterator"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2964386],"inputIterationConnectorIDs":[]},"2964322":{"id":2964322,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1616,"y":-448,"width":32,"height":32,"inputConnectorIDs":[2964395],"outputSuccessConnectorIDs":[2964316],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_etl_tymeshift_agents_list 0"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_etl_tymeshift_agents_list"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964323":{"id":2964323,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-992,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2964307],"outputSuccessConnectorIDs":[2964310],"outputFailureConnectorIDs":[2964391],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LC Act"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SET timezone TO 'America/Los_Angeles';\n\nCREATE TABLE IF NOT EXISTS edw.call_center_labor_cost_activities(ticket_id numeric(20),\n                                                                 act_date date,\n                                                                 seconds bigint,\n                                                                 username varchar(100),\n                                                                 assignee_id varchar(100),\n                                                                 updated_at date,\n                                                                 request_topic varchar(100),\n                                                                 user_id bigint,\n                                                                 crm_phone_number varchar(100),\n                                                                 crm_user_email varchar(100));\n\nDELETE FROM edw.call_center_labor_cost_activities;\n\nINSERT INTO edw.call_center_labor_cost_activities\n\nWITH\n\n  month_dates AS (\n    SELECT DATE_TRUNC('month', DATEADD(month, -1, current_date))::date AS month_first_day,\n           LAST_DAY(month_first_day) AS month_last_day,\n           EXTRACT(day from month_last_day) AS days_in_month\n  ),\n\n  tickets AS (\n    SELECT t.zend_nice_id::numeric(20) AS ticket_id, TO_DATE(t.ticket_date, 'YYYYMMDD') AS act_date,\n           t.seconds::bigint, t.username, al.user_id AS assignee_id,\n           (SELECT t.updated_at::date FROM bi.dt_ace_tickets t WHERE t.ticket_id = zend_nice_id\n             AND (t.updated_at <= act_date AND t.updated_at > act_date - 30)) AS updated_at,\n           (SELECT t.request_topic FROM bi.dt_ace_tickets t WHERE t.ticket_id = zend_nice_id\n             AND (t.updated_at <= act_date AND t.updated_at > act_date - 30)) AS request_topic,\n           (SELECT t.user_id::bigint FROM bi.dt_ace_tickets t WHERE t.ticket_id = zend_nice_id\n             AND (t.updated_at <= act_date AND t.updated_at > act_date - 30)) AS user_id,\n           (SELECT t.crm_phone_number FROM bi.dt_ace_tickets t WHERE t.ticket_id = zend_nice_id\n             AND (t.updated_at <= act_date AND t.updated_at > act_date - 30)) AS crm_phone_number,\n           (SELECT t.crm_user_email FROM bi.dt_ace_tickets t WHERE t.ticket_id = zend_nice_id\n             AND (t.updated_at <= act_date AND t.updated_at > act_date - 30)) AS crm_user_email\n    FROM edw.etl_call_center_tymeshift_ace_tickets t\n           INNER JOIN edw.etl_call_center_zendesk_agents_list al ON t.username = al.username\n    WHERE DATE_TRUNC('month', act_date) = (SELECT month_first_day FROM month_dates)\n  )\n\nSELECT * FROM tickets WHERE updated_at IS NOT NULL;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964324":{"id":2964324,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-1184,"y":-272,"width":32,"height":16,"inputConnectorIDs":[2964303],"outputSuccessConnectorIDs":[2964318],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Grid Iterator 0"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Billed_month"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Billed_month"},"2":{"slot":2,"type":"STRING","value":"billed_month_iterator"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"end_date"},"2":{"slot":2,"type":"STRING","value":"billed_month_day_iterator"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2964387],"inputIterationConnectorIDs":[]},"2964325":{"id":2964325,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1184,"y":-240,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_etl_parse_tymeshift_api"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_etl_parse_tymeshift_api"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Billed_month"},"2":{"slot":2,"type":"STRING","value":"${billed_month_iterator}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"end_day"},"2":{"slot":2,"type":"STRING","value":"${billed_month_day_iterator}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2964387]},"2964326":{"id":2964326,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-560,"y":-240,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Execution NonCust"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SET timezone TO 'America/Los_Angeles';\n\nINSERT INTO edw.${Target_table_n}(execution,\n                                                    crm_phone_number,\n                                                    crm_user_email,\n                                                    user_id,\n                                                    Non_customer,\n                                                    Category,\n                                                    Item,\n                                                    Date,\n                                                    Value,\n                                                    Value_type)\n\nWITH\n  month_dates AS (\n    SELECT DATE_TRUNC('month', DATEADD(month, ${Month_iterator}, current_date))::date AS month_first_day,\n           LAST_DAY(month_first_day) AS month_last_day,\n           EXTRACT(day from month_last_day) AS days_in_month\n  ),\n\n  salaries AS (\n    SELECT assignee_id,\n           MIN(annual_salary)/52/40/60/60 AS salary_per_second\n    FROM edw.etl_call_center_labor_cost_wages\n    GROUP BY assignee_id\n  ),\n\n  tickets_grouped_by_ticket_id AS (\n    SELECT ticket_id, SUM(seconds) AS total_seconds, request_topic,\n           assignee_id, crm_user_email, crm_phone_number, MAX(updated_at) AS updated_at\n    FROM edw.call_center_labor_cost_activities\n    WHERE user_id IS NULL\n    GROUP BY ticket_id, assignee_id, request_topic, crm_user_email, crm_phone_number\n  ),\n\n  tickets_avg AS (\n    SELECT AVG(total_seconds) AS avg_ticket_time, assignee_id, request_topic\n    FROM tickets_grouped_by_ticket_id\n    GROUP BY assignee_id, request_topic\n    ORDER BY assignee_id\n  ),\n\n  ticket_costs AS (\n    SELECT t.assignee_id,\n           t.request_topic,\n           sal.salary_per_second * t.avg_ticket_time AS ticket_type_cost\n    FROM tickets_avg t\n           INNER JOIN salaries sal ON t.assignee_id = sal.assignee_id\n  ),\n\n  noncustomer_tickets AS (\n    SELECT crm_phone_number,\n           crm_user_email,\n           updated_at::date AS Date,\n           (-tc.ticket_type_cost) AS Value\n    FROM tickets_grouped_by_ticket_id t\n           INNER JOIN ticket_costs tc ON t.assignee_id = tc.assignee_id\n      AND (tc.request_topic = t.request_topic OR (tc.request_topic IS NULL AND t.request_topic IS NULL))\n  )\n\nSELECT getdate() AS execution,\n       crm_phone_number,\n       crm_user_email,\n       0 AS user_id\n       TRUE AS Non_customer,\n       'Direct'::text AS Category,\n       'Call Center Labor Cost Noncustomers'::text AS Item,\n       Date,\n       Value,\n       'Cost'::text AS Value_type\nFROM noncustomer_tickets;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2964386]},"2964327":{"id":2964327,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-688,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2964312],"outputSuccessConnectorIDs":[2964311],"outputFailureConnectorIDs":[2964388],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delete -1 month n"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delete from edw.${Target_table_n}\nwhere \ndate_part(year, cast(edw.${Target_table_n}.date as date)) = date_part(year, dateadd(month, -1, current_date))\nand\ndate_part(month, cast(edw.${Target_table_n}.date as date)) = date_part(month, dateadd(month, -1, current_date))"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964328":{"id":2964328,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1296,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2964399],"outputSuccessConnectorIDs":[2964303],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Months"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nimport datetime\nimport math\nfrom dateutil.relativedelta import relativedelta\n\nnow = datetime.datetime.today()\n\nif now.month > 1:\n    first_day_prev_month = datetime.datetime(now.year, now.month - 1, 1)\nelse:\n    first_day_prev_month = datetime.datetime(now.year - 1, 12, 1)\n\nstart = first_day_prev_month\ndelta = now - start\n\nmonthslist = []\n\nmonthq = ((start.year - now.year) * 12 + start.month - now.month)\n\nprint(monthq)\n\ni = monthq\nwhile i < 0:\n monthslist.append([i])\n i = i + 1\ncontext.updateGridVariable('Months', monthslist)\nprint Months\n\n\ntotal_months = lambda dt: dt.month + 12 * dt.year\nmlist = []\n\nfor tot_m in xrange(total_months(start)-1, total_months(now)-1):\n y, m = divmod(tot_m, 12)\n day = int((datetime.datetime(y, m+1, 1)+ relativedelta(months=+1) - datetime.timedelta(1)).strftime(\"%d\"))\n month = datetime.datetime(y, m+1, 1).strftime(\"%Y%m%d\")\n while day > 0:\n  mlist.append([month,day])\n  day = day - 1\nlenl = len(mlist)\ncurend = now - datetime.timedelta(1)\n#mlist[lenl-1][1] = curend.strftime(\"%d\")\ncontext.updateGridVariable('Billed_month', mlist)  \nprint Billed_month\n\n\n\n\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964329":{"id":2964329,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1616,"y":-160,"width":32,"height":32,"inputConnectorIDs":[2964396],"outputSuccessConnectorIDs":[2964304],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_view_accounts_termination_dates"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_view_accounts_termination_dates"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964330":{"id":2964330,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1616,"y":-320,"width":32,"height":32,"inputConnectorIDs":[2964397],"outputSuccessConnectorIDs":[2964302],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_etl_call_center_labor_cost_wages"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_etl_call_center_labor_cost_wages"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964331":{"id":2964331,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-800,"y":-272,"width":32,"height":16,"inputConnectorIDs":[2964308],"outputSuccessConnectorIDs":[2964312],"outputFailureConnectorIDs":[2964389],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Grid Iterator 0"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Months"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Month"},"2":{"slot":2,"type":"STRING","value":"Month_iterator"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2964384],"inputIterationConnectorIDs":[]},"2964336":{"id":2964336,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-176,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2964315],"outputSuccessConnectorIDs":[2964314],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_consolidated_pnl NonCust"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_consolidated_pnl"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Source_table"},"2":{"slot":2,"type":"STRING","value":"${Target_table_n}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Item_name"},"2":{"slot":2,"type":"STRING","value":"${Item_name_n}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964337":{"id":2964337,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-800,"y":-448,"width":32,"height":32,"inputConnectorIDs":[2964305],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964338":{"id":2964338,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-1408,"y":-160,"width":32,"height":32,"inputConnectorIDs":[2964313],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[2964385],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[2964306],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Exist_check_Target_table"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964339":{"id":2964339,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-1408,"y":-80,"width":32,"height":32,"inputConnectorIDs":[2964393],"outputSuccessConnectorIDs":[2964313],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Target table check"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\ncursor = context.cursor()\ntry:\n\tcursor.execute('select convert (integer, (select exists (select * from edw.'+Target_table+' limit 1)))')\n\tresult = cursor.fetchone()[0]\n\tcontext.updateVariable('Exist_check_Target_table', result)\nexcept:\n  \tcontext.updateVariable('Exist_check_Target_table', '0')\n    \nprint ('Variable value: '+str(Exist_check_Target_table))"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964340":{"id":2964340,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":-1540940111,"x":-864,"y":-448,"width":32,"height":32,"inputConnectorIDs":[2964398],"outputSuccessConnectorIDs":[2964305],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rollback 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964341":{"id":2964341,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":-1785670938,"x":-1072,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2964318],"outputSuccessConnectorIDs":[2964307],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Begin 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964342":{"id":2964342,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-864,"y":-384,"width":32,"height":32,"inputConnectorIDs":[2964388,2964389,2964390,2964391,2964394],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2964398],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964343":{"id":2964343,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":977205684,"x":-464,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2964317],"outputSuccessConnectorIDs":[2964319],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Commit 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964344":{"id":2964344,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-912,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2964310],"outputSuccessConnectorIDs":[2964308],"outputFailureConnectorIDs":[2964394],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delete -1 month c"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delete from edw.${Target_table}\nwhere \ndate_part(year, cast(edw.${Target_table}.date as date)) = date_part(year, dateadd(month, -1, current_date))\nand\ndate_part(month, cast(edw.${Target_table}.date as date)) = date_part(month, dateadd(month, -1, current_date))"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964345":{"id":2964345,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-48,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2964314],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TMP"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"spashchenko.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"ashumakov.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"vfigurkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"opetrova.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"idudkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"spashchenko.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"ashumakov.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"vfigurkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"opetrova.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"idudkin.ctr\";\n\n---drop table edw.${Target_table_n}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964346":{"id":2964346,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":235671163,"x":-1504,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2964302,2964304,2964309,2964316],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2964393],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964347":{"id":2964347,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1616,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2964392],"outputSuccessConnectorIDs":[2964309],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_view_unique_user_accounts"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_view_unique_user_accounts"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964348":{"id":2964348,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1728,"y":-240,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2964392,2964395,2964396,2964397],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964349":{"id":2964349,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-352,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2964319],"outputSuccessConnectorIDs":[2964315],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_consolidated_pnl Cust"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_consolidated_pnl"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Source_table"},"2":{"slot":2,"type":"STRING","value":"${Target_table}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Item_name"},"2":{"slot":2,"type":"STRING","value":"${Item_name}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2964350":{"id":2964350,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-800,"y":-240,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Execution Cust"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SET timezone TO 'America/Los_Angeles';\n\nINSERT INTO edw.${Target_table}(execution,\n                                                 User_id,\n                                                 Non_customer,\n                                                 Category,\n                                                 Item,\n                                                 Date,\n                                                 Value,\n                                                 Value_type)\n\nWITH\n  month_dates AS (\n    SELECT DATE_TRUNC('month', DATEADD(month, ${Month_iterator}, current_date))::date AS month_first_day,\n           LAST_DAY(month_first_day) AS month_last_day,\n           EXTRACT(day from month_last_day) AS days_in_month\n  ),\n\n  salaries AS (\n    SELECT assignee_id,\n           MIN(annual_salary)/52/40/60/60 AS salary_per_second\n    FROM edw.etl_call_center_labor_cost_wages\n    GROUP BY assignee_id\n  ),\n\n  tickets_grouped_by_ticket_id AS (\n    SELECT ticket_id, SUM(seconds) AS total_seconds, request_topic,\n           assignee_id, user_id, MAX(updated_at) AS updated_at\n    FROM edw.call_center_labor_cost_activities\n    GROUP BY ticket_id, assignee_id, request_topic, user_id\n  ),\n\n  tickets_avg AS (\n    SELECT AVG(total_seconds) AS avg_ticket_time, assignee_id, request_topic\n    FROM tickets_grouped_by_ticket_id\n    GROUP BY assignee_id, request_topic\n    ORDER BY assignee_id\n  ),\n\n  ticket_costs AS (\n    SELECT t.assignee_id,\n           t.request_topic,\n           sal.salary_per_second * t.avg_ticket_time AS ticket_type_cost\n    FROM tickets_avg t\n           INNER JOIN salaries sal ON t.assignee_id = sal.assignee_id\n  ),\n\n  customers_tickets AS (\n    SELECT user_id,\n           updated_at::date AS Date,\n           SUM(-tc.ticket_type_cost) AS Value\n    FROM tickets_grouped_by_ticket_id t\n           INNER JOIN ticket_costs tc ON t.assignee_id = tc.assignee_id\n      AND (tc.request_topic = t.request_topic OR (tc.request_topic IS NULL AND t.request_topic IS NULL))\n    WHERE t.user_id IS NOT NULL\n    GROUP BY t.user_id, Date\n  )\n\nSELECT getdate() AS execution,\n       User_id,\n       FALSE AS Non_customer,\n       'Direct'::text AS Category,\n       'Call Center Labor Cost Customers'::text AS Item,\n       Date,\n       Value,\n       'Cost'::text AS Value_type\nFROM customers_tickets;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2964384]}},"successConnectors":{"2964302":{"id":2964302,"sourceID":2964330,"targetID":2964346},"2964303":{"id":2964303,"sourceID":2964328,"targetID":2964324},"2964304":{"id":2964304,"sourceID":2964329,"targetID":2964346},"2964305":{"id":2964305,"sourceID":2964340,"targetID":2964337},"2964307":{"id":2964307,"sourceID":2964341,"targetID":2964323},"2964308":{"id":2964308,"sourceID":2964344,"targetID":2964331},"2964309":{"id":2964309,"sourceID":2964347,"targetID":2964346},"2964310":{"id":2964310,"sourceID":2964323,"targetID":2964344},"2964311":{"id":2964311,"sourceID":2964327,"targetID":2964321},"2964312":{"id":2964312,"sourceID":2964331,"targetID":2964327},"2964313":{"id":2964313,"sourceID":2964339,"targetID":2964338},"2964314":{"id":2964314,"sourceID":2964336,"targetID":2964345},"2964315":{"id":2964315,"sourceID":2964349,"targetID":2964336},"2964316":{"id":2964316,"sourceID":2964322,"targetID":2964346},"2964317":{"id":2964317,"sourceID":2964321,"targetID":2964343},"2964318":{"id":2964318,"sourceID":2964324,"targetID":2964341},"2964319":{"id":2964319,"sourceID":2964343,"targetID":2964349}},"failureConnectors":{"2964385":{"id":2964385,"sourceID":2964338,"targetID":2964301},"2964388":{"id":2964388,"sourceID":2964327,"targetID":2964342},"2964389":{"id":2964389,"sourceID":2964331,"targetID":2964342},"2964390":{"id":2964390,"sourceID":2964321,"targetID":2964342},"2964391":{"id":2964391,"sourceID":2964323,"targetID":2964342},"2964394":{"id":2964394,"sourceID":2964344,"targetID":2964342}},"unconditionalConnectors":{"2964392":{"id":2964392,"sourceID":2964348,"targetID":2964347},"2964393":{"id":2964393,"sourceID":2964346,"targetID":2964339},"2964395":{"id":2964395,"sourceID":2964348,"targetID":2964322},"2964396":{"id":2964396,"sourceID":2964348,"targetID":2964329},"2964397":{"id":2964397,"sourceID":2964348,"targetID":2964330},"2964398":{"id":2964398,"sourceID":2964342,"targetID":2964340},"2964399":{"id":2964399,"sourceID":2964320,"targetID":2964328}},"trueConnectors":{"2964306":{"id":2964306,"sourceID":2964338,"targetID":2964320}},"falseConnectors":{},"iterationConnectors":{"2964384":{"id":2964384,"sourceID":2964331,"targetID":2964350},"2964386":{"id":2964386,"sourceID":2964321,"targetID":2964326},"2964387":{"id":2964387,"sourceID":2964324,"targetID":2964325}},"noteConnectors":{},"notes":{"2964334":{"id":2964334,"x":-1712,"y":-496,"width":257,"height":99,"text":"Activate when agent API issue will be fixed(by Tymeshift support)","colour":"e6e63c"},"2964335":{"id":2964335,"x":-84,"y":-282,"width":91,"height":90,"text":"for development","colour":"d60000"}},"variables":{"Consolidated_table":{"definition":{"name":"Consolidated_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"consolidated_pnl"},"Day":{"definition":{"name":"Day","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"Exist_check_Target_table":{"definition":{"name":"Exist_check_Target_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"Item_name":{"definition":{"name":"Item_name","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"'Call Center Labor Cost Customers'"},"Item_name_n":{"definition":{"name":"Item_name_n","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"'Call Center Labor Cost Noncustomers'"},"Month_iterator":{"definition":{"name":"Month_iterator","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"Pnl_schema":{"definition":{"name":"Pnl_schema","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"edw"},"Target_table":{"definition":{"name":"Target_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"call_center_labor_cost_customers"},"Target_table_n":{"definition":{"name":"Target_table_n","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"call_center_labor_cost_noncustomers"},"billed_month_day_iterator":{"definition":{"name":"billed_month_day_iterator","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"billed_month_iterator":{"definition":{"name":"billed_month_iterator","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""}},"grids":{"Billed_month":{"definition":{"name":"Billed_month","scope":"BRANCH","definitions":[{"name":"Billed_month","type":"TEXT"},{"name":"end_date","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]},"Days_in_billed_month":{"definition":{"name":"Days_in_billed_month","scope":"BRANCH","definitions":[{"name":"Day","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]},"Months":{"definition":{"name":"Months","scope":"BRANCH","definitions":[{"name":"Month","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]}}},"info":{"name":"pnl_exec_call_center_labor_cost","description":"Initialization of Item in PnL Report schema and load all data incl historical","type":"ORCHESTRATION","tag":"fc9de5fc-a797-46a0-b282-799caf0af0c6"}}