{"job":{"components":{"2963824":{"id":2963824,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-657,"y":-112,"width":32,"height":32,"inputConnectorIDs":[2963806],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963825":{"id":2963825,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-864,"y":-112,"width":32,"height":32,"inputConnectorIDs":[2963882,2963883],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2963881],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963826":{"id":2963826,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-416,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963804],"outputSuccessConnectorIDs":[2963884],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_exec_do_good_dollars"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_exec_do_good_dollars"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963827":{"id":2963827,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1312,"y":-160,"width":32,"height":32,"inputConnectorIDs":[2963887],"outputSuccessConnectorIDs":[2963803],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_view_accounts_termination_dates"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_view_accounts_termination_dates"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963828":{"id":2963828,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":-1785670938,"x":-1056,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963880],"outputSuccessConnectorIDs":[2963801],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Begin 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963829":{"id":2963829,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-560,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963805],"outputSuccessConnectorIDs":[2963804],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_consolidated_pnl"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_consolidated_pnl"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Source_table"},"2":{"slot":2,"type":"STRING","value":"${Target_table}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Item_name"},"2":{"slot":2,"type":"STRING","value":"${Item_name}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963830":{"id":2963830,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":977205684,"x":-736,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963807],"outputSuccessConnectorIDs":[2963805],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Commit 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963831":{"id":2963831,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSACTION","implementationID":-1540940111,"x":-752,"y":-112,"width":32,"height":32,"inputConnectorIDs":[2963881],"outputSuccessConnectorIDs":[2963806],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rollback 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963832":{"id":2963832,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-928,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963801],"outputSuccessConnectorIDs":[2963802],"outputFailureConnectorIDs":[2963883],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create\\Truncate"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CREATE TABLE IF NOT EXISTS edw.${Target_table}(\n                                             id bigint identity(1, 1),\n                                             execution timestamp with time zone,\n                                             User_id bigint not null,\n                                             Account_id bigint not null,\n                                             Depository_id bigint,\n                                       \t\t Investment_id bigint,\n  \t\t\t\t\t\t\t\t\t\t     Account_type varchar(50),\n    \t\t\t\t\t\t\t\t\t\t Product_type  varchar(50),\n                                             --Account_product_type_id int, --account.product_type\n                                             --Account_product_type_name varchar(50), --1 = investment, 2 = depository\n                                             --Account_product_id int, --<depository.product_id>\n                                             --Account_product_name varchar(50), --3 = Summit , 4 = Spend, 5 = Save\n                                             --Account_type_id int, --<account.account_type_id>\n                                             --Account_type_name varchar(50), --2 = Individual, 3 = IRA\n                                             --Account_investment_type_id int, --<investment.fund_id>\n                                             --Account_investment_type_name varchar(50), --1 = Flagship, 2 = Redwood\n                                             Non_customer boolean, -- True for ZenDesk/False for others\n                                             Category varchar(50) not null,\n                                             Item varchar(50) not null,\n                                             Date timestamp with time zone,\n                                             Value numeric(38,8) not null,\n                                             Value_type varchar(50),\n                                             primary key(id));\n                                                \nTRUNCATE edw.${Target_table}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963833":{"id":2963833,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-304,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963884],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TMP"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"spashchenko.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"ashumakov.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"vfigurkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"opetrova.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"idudkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"spashchenko.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"ashumakov.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"vfigurkin.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"opetrova.ctr\";\nGRANT SELECT ON ${Pnl_schema}.${Consolidated_table} TO \"idudkin.ctr\";"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963834":{"id":2963834,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":235671163,"x":-1184,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963803,2963885],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2963880],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963835":{"id":2963835,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-1312,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963886],"outputSuccessConnectorIDs":[2963885],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_view_unique_user_accounts"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"pnl_init_view_unique_user_accounts"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963838":{"id":2963838,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-816,"y":-240,"width":32,"height":32,"inputConnectorIDs":[2963802],"outputSuccessConnectorIDs":[2963807],"outputFailureConnectorIDs":[2963882],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Execution"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"set timezone = 'America/Los_Angeles';\n\n\nINSERT INTO edw.${Target_table}(execution,\n                                User_id,\n                                Account_id,\n                                Depository_id,\n                                Investment_id,\n                            \tAccount_type,\n                            \tProduct_type,\n                                --Account_product_type_id,\n                                --Account_product_type_name,\n                                --Account_product_id,\n                                --Account_product_name,\n                                --Account_type_id,\n                                --Account_type_name,\n                                --Account_investment_type_id,\n                                --Account_investment_type_name,\n                                Non_customer,\n                                Category,\n                                Item,\n                                Date,\n                                Value,\n                                Value_type)\n\nWITH do_good_amount_all_times AS (\n       SELECT user_id, SUM(amount) AS sum_amount\n       FROM web_db.user_charity_giving\n       WHERE payment_source = 5\n       GROUP BY user_id\n     ),\n\n     user_acc_dep_inv AS (\n       SELECT ua.user_id AS user_id,\n              ua.account_id AS account_id,\n              acc.product_type AS Account_product_type_id, -- for dep and inv\n              dg.sum_amount AS sum_amount,\n              dep.id AS dep_id,\n              dep.product_id AS Account_product_id, --for dep\n              inv.id AS inv_id,\n              acc.account_type_id AS Account_type_id, --for inv\n              inv.fund_id AS Account_investment_type_id -- for inv\n       FROM web_db.user_account AS ua\n              INNER JOIN do_good_amount_all_times AS dg ON ua.user_id = dg.user_id\n              LEFT JOIN web_db.depository AS dep ON dep.account_id = ua.account_id\n              LEFT JOIN web_db.investment AS inv ON inv.account_id = ua.account_id\n              INNER JOIN web_db.account AS acc ON acc.id = ua.account_id\n     ),\n\n     user_id_dep_4_cnt_1 AS (\n       SELECT user_id, COUNT(*) cnt\n       FROM user_acc_dep_inv\n       WHERE Account_product_id = 4\n       GROUP BY user_id\n       HAVING cnt = 1\n     ),\n\n     --1 to result\n     info_dep_4_cnt_1 AS (\n       SELECT user_id,\n              account_id,\n              dep_id,\n              sum_amount,\n              Account_product_type_id,\n              Account_product_id,\n              NULL AS Account_type_id,\n              NULL AS Account_investment_type_id\n       FROM user_acc_dep_inv\n       WHERE user_id IN (SELECT user_id FROM user_id_dep_4_cnt_1)\n         AND Account_product_id = 4\n     ),\n\n     user_id_dep_4_cnt_not_1 AS (\n       SELECT user_id, COUNT(*) cnt\n       FROM user_acc_dep_inv\n       WHERE Account_product_id = 4\n       GROUP BY user_id\n       HAVING cnt > 1\n     ),\n\n     dep_id_dep_4_cnt_not_1 AS (\n       SELECT user_id, MIN(dep_id) AS dep_id\n       FROM user_acc_dep_inv\n       WHERE user_id IN (SELECT user_id FROM user_id_dep_4_cnt_not_1)\n         AND Account_product_id = 4\n       GROUP BY user_id\n     ),\n\n     --2 to result\n     info_dep_4_cnt_not_1 AS (\n       SELECT ua.user_id,\n              ua.account_id,\n              ua.dep_id,\n              ua.sum_amount,\n              ua.Account_product_type_id,\n              ua.Account_product_id,\n              NULL AS Account_type_id,\n              NULL AS Account_investment_type_id\n       FROM dep_id_dep_4_cnt_not_1 AS d\n              INNER JOIN user_acc_dep_inv AS ua ON d.user_id = ua.user_id AND d.dep_id = ua.dep_id\n     ),\n\n     user_id_not_dep_4 AS (\n       SELECT DISTINCT user_id\n       FROM user_acc_dep_inv\n            EXCEPT\n       SELECT user_id\n       FROM info_dep_4_cnt_1\n            EXCEPT\n       SELECT user_id\n       FROM info_dep_4_cnt_not_1\n     ),\n\n     dep_id_not_dep_4 AS (\n       SELECT user_id, account_id, dep_id\n       FROM user_acc_dep_inv\n       WHERE user_id IN (SELECT user_id FROM user_id_not_dep_4)\n         AND dep_id IS NOT NULL\n     ),\n\n     user_id_not_dep_4_min_dep AS (\n       SELECT user_id, MIN(dep_id) AS dep_id\n       FROM dep_id_not_dep_4\n       GROUP BY user_id\n     ),\n\n     --3 to result\n     info_not_dep_4 AS (\n       SELECT ua.user_id,\n              ua.account_id,\n              ua.dep_id,\n              ua.sum_amount,\n              ua.Account_product_type_id,\n              ua.Account_product_id,\n              NULL AS Account_type_id,\n              NULL AS Account_investment_type_id\n       FROM user_id_not_dep_4_min_dep AS ud\n              INNER JOIN user_acc_dep_inv AS ua ON ud.user_id = ua.user_id AND ud.dep_id = ua.dep_id\n     ),\n\n     user_id_not_dep AS (\n       SELECT user_id\n       FROM user_id_not_dep_4\n            EXCEPT\n       SELECT user_id\n       FROM info_not_dep_4\n     ),\n\n     user_id_inv AS (\n       SELECT user_id, MIN(inv_id) AS inv_id\n       FROM user_acc_dep_inv\n       WHERE user_id IN (SELECT user_id FROM user_id_not_dep)\n         AND inv_id IS NOT NULL\n       GROUP BY user_id\n     ),\n\n     -- 4 to result\n     info_inv AS (\n       SELECT ua.user_id,\n              ua.account_id,\n              ua.inv_id,\n              ua.sum_amount,\n              ua.Account_product_type_id,\n              ua.Account_type_id,\n              ua.Account_investment_type_id,\n              NULL AS Account_product_id\n       FROM user_id_inv AS ui\n              INNER JOIN user_acc_dep_inv ua ON ui.user_id = ua.user_id AND ui.inv_id = ua.inv_id\n     ),\n\n     common_do_good AS (\n       SELECT user_id, Account_id, dep_id AS Account_dep_inv_id, sum_amount,\n              Account_product_type_id, Account_product_id,\n              Account_type_id, Account_investment_type_id\n       FROM info_dep_4_cnt_1\n       UNION\n       SELECT user_id, Account_id, dep_id AS Account_dep_inv_id, sum_amount,\n              Account_product_type_id, Account_product_id,\n              Account_type_id, Account_investment_type_id\n       FROM info_dep_4_cnt_not_1\n       UNION\n       SELECT user_id, Account_id, dep_id AS Account_dep_inv_id, sum_amount,\n              Account_product_type_id, Account_product_id,\n              Account_type_id, Account_investment_type_id\n       FROM info_not_dep_4\n       UNION\n       SELECT user_id, Account_id, inv_id AS Account_dep_inv_id, sum_amount,\n              Account_product_type_id, Account_product_id,\n              Account_type_id, Account_investment_type_id\n       FROM info_inv\n     ),\n\n     historical_do_good_user_amount AS (\n       SELECT last_updated::date AS Date, user_id, SUM(amount) AS amount\n       FROM web_db.user_charity_giving\n       WHERE payment_source = 5\n         AND last_updated::date < dateadd(day, -1, current_date)::date\n       GROUP BY last_updated, user_id\n     ),\n\n     historical_do_good_info AS (\n       SELECT hdg.user_id, hdg.amount, hdg.Date, com.account_id, com.Account_dep_inv_id,\n              com.Account_product_type_id, com.Account_product_id,\n              com.Account_type_id, com.Account_investment_type_id\n       FROM historical_do_good_user_amount AS hdg\n          INNER JOIN common_do_good AS com ON hdg.user_id = com.user_id\n     )\n\nSELECT current_date() AS execution,\n       user_id AS User_id,\n       Account_id,\n       (CASE\n          WHEN Account_product_type_id = 1 THEN NULL\n          WHEN Account_product_type_id = 2 THEN Account_dep_inv_id\n         END) AS Depository_id,\n       (CASE\n          WHEN Account_product_type_id = 1 THEN Account_dep_inv_id\n          WHEN Account_product_type_id = 2 THEN NULL\n         END) AS Investment_id,\n       (CASE\n          WHEN Account_product_type_id = 1 THEN 'Investment'::text\n          WHEN Account_product_type_id = 2 THEN 'Depository'::text\n          ELSE ''::text\n         END) AS Account_type,\n       (CASE\n          WHEN Account_product_type_id = 1 -- 'Investment'\n            AND Account_type_id = 2 -- 'Individual'\n            AND Account_investment_type_id = 1 -- 'Flagship'\n            THEN 'Flagship Individual'::text\n          WHEN Account_product_type_id = 1 -- 'Investment'\n            AND Account_type_id = 2 -- 'Individual'\n            AND Account_investment_type_id = 2 -- 'Redwood'\n            THEN 'Redwood Individual'::text\n          WHEN Account_product_type_id = 1 -- 'Investment'\n            AND Account_type_id = 3 -- 'IRA'\n            AND Account_investment_type_id = 1 -- 'Flagship'\n            THEN 'Flagship IRA'::text\n          WHEN Account_product_type_id = 1 -- 'Investment'\n            AND Account_type_id = 3 -- 'IRA'\n            AND Account_investment_type_id = 2 -- 'Redwood'\n            THEN 'Redwood IRA'::text\n          WHEN Account_product_type_id = 2 -- 'Depository'\n            AND Account_product_id = 3\n            THEN 'Summit'::text\n          WHEN Account_product_type_id = 2 -- 'Depository'\n            AND Account_product_id = 4\n            THEN 'Spend'::text\n          WHEN Account_product_type_id = 2 -- 'Depository'\n            AND Account_product_id = 5\n            THEN 'Save'::text\n          ELSE ''::text\n         END) AS Product_type,\n\n--        Account_product_type_id,\n--        (CASE\n--           WHEN Account_product_type_id = 1 THEN 'Investment'::text\n--           WHEN Account_product_type_id = 2 THEN 'Depository'::text\n--           ELSE ''::text\n--          END) AS Account_product_type_name,\n--        Account_product_id,\n--        (CASE\n--           WHEN Account_product_id = 3 THEN 'Summit'::text\n--           WHEN Account_product_id = 4 THEN 'Spend'::text\n--           WHEN Account_product_id = 5 THEN 'Save'::text\n--           ELSE NULL\n--          END) AS Account_product_name,\n--        Account_type_id,\n--        (CASE\n--           WHEN Account_type_id = 2 THEN 'Individual'::text\n--           WHEN Account_type_id = 3 THEN 'IRA'::text\n--           ELSE NULL\n--          END) AS Account_type_name,\n--        Account_investment_type_id,\n--        (CASE\n--           WHEN Account_investment_type_id = 1 THEN 'Flagship'::text\n--           WHEN Account_investment_type_id = 2 THEN 'Redwood'::text\n--           ELSE NULL\n--          END) AS Account_investment_type_name,\n       FALSE AS Non_customer,\n       'Direct'::text AS Category,\n       'Do Good Dollars'::text AS Item,\n       Date,\n       -amount AS Value,\n       'Cost'::text AS Value_type\nFROM historical_do_good_info;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2963839":{"id":2963839,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1456,"y":-240,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2963886,2963887],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2963801":{"id":2963801,"sourceID":2963828,"targetID":2963832},"2963802":{"id":2963802,"sourceID":2963832,"targetID":2963838},"2963803":{"id":2963803,"sourceID":2963827,"targetID":2963834},"2963804":{"id":2963804,"sourceID":2963829,"targetID":2963826},"2963805":{"id":2963805,"sourceID":2963830,"targetID":2963829},"2963806":{"id":2963806,"sourceID":2963831,"targetID":2963824},"2963807":{"id":2963807,"sourceID":2963838,"targetID":2963830},"2963884":{"id":2963884,"sourceID":2963826,"targetID":2963833},"2963885":{"id":2963885,"sourceID":2963835,"targetID":2963834}},"failureConnectors":{"2963882":{"id":2963882,"sourceID":2963838,"targetID":2963825},"2963883":{"id":2963883,"sourceID":2963832,"targetID":2963825}},"unconditionalConnectors":{"2963880":{"id":2963880,"sourceID":2963834,"targetID":2963828},"2963881":{"id":2963881,"sourceID":2963825,"targetID":2963831},"2963886":{"id":2963886,"sourceID":2963839,"targetID":2963835},"2963887":{"id":2963887,"sourceID":2963839,"targetID":2963827}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{"2963836":{"id":2963836,"x":-337,"y":-282,"width":91,"height":90,"text":"for development","colour":"d60000"}},"variables":{"Consolidated_table":{"definition":{"name":"Consolidated_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"consolidated_pnl"},"Item_name":{"definition":{"name":"Item_name","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"'Do Good Dollars'"},"Month_iterator_end":{"definition":{"name":"Month_iterator_end","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"Month_iterator_start":{"definition":{"name":"Month_iterator_start","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"Pnl_schema":{"definition":{"name":"Pnl_schema","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"edw"},"Target_table":{"definition":{"name":"Target_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"do_good_dollars"}},"grids":{"Months":{"definition":{"name":"Months","scope":"BRANCH","definitions":[{"name":"Month_start","type":"TEXT"},{"name":"Month_end","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]}}},"info":{"name":"pnl_init_do_good_dollars","description":"Initialization of Item in PnL Report schema and load all data incl historical","type":"ORCHESTRATION","tag":"ec0446ed-7da4-4650-bc63-8dcaaf921418"}}