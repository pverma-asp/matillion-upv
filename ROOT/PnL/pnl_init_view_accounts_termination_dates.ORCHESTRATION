{"job":{"components":{"2962684":{"id":2962684,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-192,"y":0,"width":32,"height":32,"inputConnectorIDs":[2962686],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create view"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CREATE OR REPLACE VIEW edw.view_accounts_termination_dates AS\n\n  WITH\n       termination_dates_1 AS (\n         SELECT ga.aspiration_account_number AS account_number, MIN(rgcmd.file_date)::date AS date1\n         FROM rdl.raw_galileo_customer_master_data rgcmd\n                INNER JOIN aog_db.galileo_accounts ga ON (ga.galileo_account_number = rgcmd.galileo_account_id)\n                INNER JOIN web_db.user_product_application upa ON (upa.id = ga.aspiration_application_id)\n         WHERE rgcmd.type_of_account = '6'\n           AND rgcmd.status IN ('C', 'Z')\n           AND ga.card_id IS NOT NULL\n           AND ga.active = TRUE\n           AND upa.account_type_id = 2\n         GROUP BY ga.aspiration_account_number\n       ),\n\n       termination_dates_2 AS (\n         SELECT id AS Account_id,\n                account_number,\n                termination_date::date AS date2\n         FROM web_db.account\n       )\n\n  SELECT td2.Account_id,\n         (CASE WHEN (date2 IS NULL AND date1 IS NULL) THEN NULL\n               WHEN (date2 IS NULL AND date1 IS NOT NULL) THEN date1\n               WHEN (date2 IS NOT NULL AND date1 IS NULL) THEN date2\n               WHEN date2 > date1 THEN date1\n               ELSE date2 END) AS termination_date\n  FROM termination_dates_2 td2\n      LEFT JOIN termination_dates_1 td1 ON td2.account_number = td1.account_number;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962685":{"id":2962685,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-320,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2962686],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2962687":{"id":2962687,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-20,"y":111,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TMP"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRANT SELECT ON ${Pnl_schema}.${Target_table} TO \"szhang\";"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{},"failureConnectors":{},"unconditionalConnectors":{"2962686":{"id":2962686,"sourceID":2962685,"targetID":2962684}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{"2962658":{"id":2962658,"x":-50,"y":72,"width":91,"height":78,"text":"for development","colour":"d60000"}},"variables":{"Pnl_schema":{"definition":{"name":"Pnl_schema","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"edw"},"Target_table":{"definition":{"name":"Target_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"view_accounts_termination_dates"}},"grids":{}},"info":{"name":"pnl_init_view_accounts_termination_dates","description":null,"type":"ORCHESTRATION","tag":"2d893c13-a9d8-4535-b756-9fd803caf36e"}}