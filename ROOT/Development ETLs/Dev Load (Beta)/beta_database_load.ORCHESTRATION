{"job":{"components":{"2967120":{"id":2967120,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":560,"y":32,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Diff"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"USE WAREHOUSE DEV;\nMERGE INTO ${target_database}.${target_schema}.SCHEMA_METADATA\n\t USING (\n\t\tSELECT 'D' AS OP, *\n\t\tFROM ${target_database}.${target_schema}.LOAD_METADATA\n\t\tUNION ALL\n\t\tSELECT 'I' AS OP, *\n\t\tFROM ${target_database}.${target_schema}.LOAD_METADATA\n     \t) AS LOADED ON SCHEMA_METADATA.SCHEMA_NAME = LOADED.DATABASE_NAME AND SCHEMA_METADATA.TABLE_NAME = LOADED.TABLE_NAME AND LOADED.OP = 'D'\n      WHEN MATCHED THEN DELETE\n      WHEN NOT MATCHED AND LOADED.OP = 'I' THEN INSERT (DATABASE_NAME,SCHEMA_NAME,TABLE_NAME,COLUMNS,DIFF_ID,LAST_UPDATE,EST_ROWS)\n            \t \t\t\t\t\t\t\t\tVALUES ('${target_database}',LOADED.DATABASE_NAME,LOADED.TABLE_NAME,LOADED.COLUMNS,LOADED.DIFF_ID,LOADED.LAST_UPDATE,LOADED.EST_ROWS);\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2967195]},"2967121":{"id":2967121,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":716056355,"x":480,"y":32,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Load"}}}},"visible":true},"2":{"slot":2,"name":"","elements":{},"visible":false},"3":{"slot":3,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"postgresql"}}}},"visible":true},"4":{"slot":4,"name":"RDS Endpoint","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"beta-sanitized-2021-04-06-1521.ctawxryivyva.us-west-2.rds.amazonaws.com:5432"}}}},"visible":true},"5":{"slot":5,"name":"Database Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${source_database}"}}}},"visible":true},"6":{"slot":6,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"webuser"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cAB4mu2kMV79WY"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT *\nFROM ${source_database}.${source_schema}.${table}"}}}},"visible":true},"9":{"slot":9,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_database}"}}}},"visible":true},"11":{"slot":11,"name":"JDBC Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ssl"},"2":{"slot":2,"type":"STRING","value":"true"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"logUnclosedConnections"},"2":{"slot":2,"type":"STRING","value":"true"}}}},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"8"}}}},"visible":true},"13":{"slot":13,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_schema}"}}}},"visible":true},"14":{"slot":14,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${table}"}}}},"visible":true},"15":{"slot":15,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEV"}}}},"visible":true},"16":{"slot":16,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"aspiration-etl-staging"}}}},"visible":true},"17":{"slot":17,"name":"Primary Keys","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"public"}}}},"visible":false},"101":{"slot":101,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"102":{"slot":102,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${table}"}}}},"visible":false},"103":{"slot":103,"name":"Data Selection","elements":{},"visible":false},"104":{"slot":104,"name":"Data Source Filter","elements":{},"visible":false},"105":{"slot":105,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":false},"106":{"slot":106,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1992":{"slot":1992,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1994":{"slot":1994,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"1995":{"slot":1995,"name":"Stage Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1996":{"slot":1996,"name":"Stage Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1997":{"slot":1997,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"1998":{"slot":1998,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1999":{"slot":1999,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"2000":{"slot":2000,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SSE KMS"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${kms_s3_key}"}}}},"visible":true},"40501":{"slot":40501,"name":"","elements":{},"visible":false},"40502":{"slot":40502,"name":"Load Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":""}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}}},"visible":true},"63320":{"slot":63320,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63321":{"slot":63321,"name":"Blob Container","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"84533":{"slot":84533,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88340":{"slot":88340,"name":"","elements":{},"visible":false},"88341":{"slot":88341,"name":"Staging","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Existing Amazon S3 Location"}}}},"visible":true},"98776":{"slot":98776,"name":"GCS Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2967194]},"2967122":{"id":2967122,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Schema"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"USE WAREHOUSE DEV;\nCREATE SCHEMA IF NOT EXISTS ${target_database}.${source_database};\n--DROP TABLE ${target_database}.${source_database}.SCHEMA_METADATA;\nCREATE TABLE IF NOT EXISTS ${target_database}.${source_database}.SCHEMA_METADATA (\n  DATABASE_NAME\tVARCHAR(16777216), --target_database\n  SCHEMA_NAME\tVARCHAR(16777216), --target_schema\n  TABLE_NAME\tVARCHAR(16777216),\n  COLUMNS\t\tVARCHAR(16777216),\n  DIFF_ID\t\tVARCHAR(16777216),\n  LAST_UPDATE\tDATE,\n  EST_ROWS\t\tNUMBER\n  );\n--DROP TABLE ${target_database}.${source_database}.LOAD_METADATA;\nCREATE TABLE IF NOT EXISTS ${target_database}.${source_database}.LOAD_METADATA (\n  DATABASE_NAME\tVARCHAR(16777216), \n  SCHEMA_NAME\tVARCHAR(16777216), \n  TABLE_NAME\tVARCHAR(16777216),\n  COLUMNS\t\tVARCHAR(16777216),\n  DIFF_ID\t\tVARCHAR(16777216),\n  LAST_UPDATE\tDATE,\n  EST_ROWS\t\tNUMBER\n  );\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2967192]},"2967123":{"id":2967123,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":560,"y":0,"width":32,"height":16,"inputConnectorIDs":[2967174],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Grid Iterator 0 (1)"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"table_list"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"source_schema"},"2":{"slot":2,"type":"STRING","value":"source_schema"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"table"},"2":{"slot":2,"type":"STRING","value":"table"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"source_database"},"2":{"slot":2,"type":"STRING","value":"source_database"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"target_database"},"2":{"slot":2,"type":"STRING","value":"target_database"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"target_schema"},"2":{"slot":2,"type":"STRING","value":"target_schema"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2967195],"inputIterationConnectorIDs":[]},"2967124":{"id":2967124,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":716056355,"x":80,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Metadata"}}}},"visible":true},"2":{"slot":2,"name":"","elements":{},"visible":false},"3":{"slot":3,"name":"Database Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"postgresql"}}}},"visible":true},"4":{"slot":4,"name":"RDS Endpoint","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"beta-sanitized-2021-04-06-1521.ctawxryivyva.us-west-2.rds.amazonaws.com:5432"}}}},"visible":true},"5":{"slot":5,"name":"Database Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${source_database}"}}}},"visible":true},"6":{"slot":6,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"webuser"}}}},"visible":true},"7":{"slot":7,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cAB4mu2kMV79WY"}}}},"visible":true},"8":{"slot":8,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WITH\n   meta AS (\n      SELECT DISTINCT\n             table_catalog                   AS database_name\n           , table_schema                    AS schema_name\n           , table_name                      AS table_name\n           , column_name || '::' || udt_name AS column_name\n           , ordinal_position                AS column_order\n      FROM information_schema.columns col\n      WHERE col.table_schema = 'public'\n      \tAND col.table_name <> 'pg_stat_statements'\n      ORDER BY column_order ASC\n      )\nSELECT database_name                    AS database_name\n     , schema_name\t\t\t            AS schema_name\n     , table_name                       AS table_name\n     , string_agg(column_name,', ')     AS columns\n     , null::VARCHAR\t\t\t\t\tAS diff_id\n     , now()::DATE\t\t\t\t\t\tAS last_update\n     , max(n_live_tup)                  AS est_rows\nFROM meta\nLEFT JOIN pg_catalog.pg_stat_user_tables stat ON stat.schemaname = meta.schema_name AND stat.relname = meta.table_name\nGROUP BY 1, 2, 3"}}}},"visible":true},"9":{"slot":9,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_database}"}}}},"visible":true},"11":{"slot":11,"name":"JDBC Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ssl"},"2":{"slot":2,"type":"STRING","value":"true"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"logUnclosedConnections"},"2":{"slot":2,"type":"STRING","value":"true"}}}},"visible":true},"12":{"slot":12,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"8"}}}},"visible":true},"13":{"slot":13,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${source_database}"}}}},"visible":true},"14":{"slot":14,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LOAD_METADATA"}}}},"visible":true},"15":{"slot":15,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DEV"}}}},"visible":true},"16":{"slot":16,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"aspiration-etl-staging"}}}},"visible":true},"17":{"slot":17,"name":"Primary Keys","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"101":{"slot":101,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"102":{"slot":102,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"103":{"slot":103,"name":"Data Selection","elements":{},"visible":false},"104":{"slot":104,"name":"Data Source Filter","elements":{},"visible":false},"105":{"slot":105,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":false},"106":{"slot":106,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1992":{"slot":1992,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1994":{"slot":1994,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"1995":{"slot":1995,"name":"Stage Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1996":{"slot":1996,"name":"Stage Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1997":{"slot":1997,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"1998":{"slot":1998,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1999":{"slot":1999,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"2000":{"slot":2000,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SSE KMS"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${kms_s3_key}"}}}},"visible":true},"40501":{"slot":40501,"name":"","elements":{},"visible":false},"40502":{"slot":40502,"name":"Load Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":""}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}}},"visible":true},"63320":{"slot":63320,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63321":{"slot":63321,"name":"Blob Container","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"84533":{"slot":84533,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88340":{"slot":88340,"name":"","elements":{},"visible":false},"88341":{"slot":88341,"name":"Staging","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Existing Amazon S3 Location"}}}},"visible":true},"98776":{"slot":98776,"name":"GCS Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2967198]},"2967125":{"id":2967125,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":160,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Diff (1)"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"USE WAREHOUSE DEV;\nMERGE INTO ${target_database}.${source_database}.LOAD_METADATA\n\t USING ${target_database}.${source_database}.SCHEMA_METADATA ON SCHEMA_METADATA.SCHEMA_NAME = LOAD_METADATA.DATABASE_NAME \n     \t\t\t\t\t\t\t\t\t\t\t\t\t\t\tAND SCHEMA_METADATA.TABLE_NAME = LOAD_METADATA.TABLE_NAME\n      WHEN MATCHED AND SCHEMA_METADATA.DIFF_ID  = HASH(LOAD_METADATA.COLUMNS) \n      \t\t\t   AND SCHEMA_METADATA.EST_ROWS = LOAD_METADATA.EST_ROWS\n      \t\t\t  THEN DELETE\n      WHEN MATCHED AND (   SCHEMA_METADATA.DIFF_ID IS NULL \n                    \tOR SCHEMA_METADATA.DIFF_ID <> HASH(LOAD_METADATA.COLUMNS)\n                        OR SCHEMA_METADATA.EST_ROWS <> LOAD_METADATA.EST_ROWS) \n      \t\t\t  THEN UPDATE SET LOAD_METADATA.DIFF_ID = HASH(LOAD_METADATA.COLUMNS)\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2967193]},"2967126":{"id":2967126,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":160,"y":0,"width":32,"height":16,"inputConnectorIDs":[2967169],"outputSuccessConnectorIDs":[2967173],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Grid Iterator 0 (3)"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"database_list"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"source_database"},"2":{"slot":2,"type":"STRING","value":"source_database"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2967193],"inputIterationConnectorIDs":[]},"2967127":{"id":2967127,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":80,"y":0,"width":32,"height":16,"inputConnectorIDs":[2967171],"outputSuccessConnectorIDs":[2967169],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Grid Iterator 0 (2)"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"database_list"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"source_database"},"2":{"slot":2,"type":"STRING","value":"source_database"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2967198],"inputIterationConnectorIDs":[]},"2967176":{"id":2967176,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":0,"y":0,"width":32,"height":16,"inputConnectorIDs":[2967170],"outputSuccessConnectorIDs":[2967171],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Grid Iterator 0"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"database_list"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"source_database"},"2":{"slot":2,"type":"STRING","value":"source_database"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2967192],"inputIterationConnectorIDs":[]},"2967177":{"id":2967177,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-80,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2967170,2967196],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967178":{"id":2967178,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":320,"y":0,"width":32,"height":32,"inputConnectorIDs":[2967172],"outputSuccessConnectorIDs":[2967168],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"View"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"USE WAREHOUSE DEV;\n${sqlview_database};\n${sqlview_loading};"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967179":{"id":2967179,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-144,"y":32,"width":32,"height":32,"inputConnectorIDs":[2967196],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2967197,2967199],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Execute"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"/*\nCREATE OR REPLACE ${target_database}.PUBLIC.DATABASE_METADATA (\n  DATABASE_NAME\tVARCHAR(16777216),\n  SCHEMA_NAME\tVARCHAR(16777216),\n  TABLE_NAME\tVARCHAR(16777216),\n  COLUMNS\t\tVARCHAR(16777216),\n  DIFF_ID\t\tVARCHAR(16777216),\n  LAST_UPDATE\tDATE\n  );\n*/\n\n\n--drop table adw_beta.account_approval_db.schema_metadata;\n--drop table adw_beta.account_management.schema_metadata;\n--drop table adw_beta.account_opening_alloy.schema_metadata;\n--drop table adw_beta.account_opening_galileo.schema_metadata;\n--drop table adw_beta.banking_db.schema_metadata;\n--drop table adw_beta.check_deposit.schema_metadata;\ndrop table adw_beta.credit_account_management.schema_metadata;\ndrop table adw_beta.credit_payments.schema_metadata;\ndrop table adw_beta.credit_transactions.schema_metadata;\n--drop table adw_beta.impact_db.schema_metadata;\n--drop table adw_beta.sweep_db.schema_metadata;\n--drop table adw_beta.web_db.schema_metadata;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967180":{"id":2967180,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":480,"y":0,"width":32,"height":16,"inputConnectorIDs":[2967175],"outputSuccessConnectorIDs":[2967174],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Grid Iterator 0"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"table_list"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"source_schema"},"2":{"slot":2,"type":"STRING","value":"source_schema"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"table"},"2":{"slot":2,"type":"STRING","value":"table"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"source_database"},"2":{"slot":2,"type":"STRING","value":"source_database"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"target_database"},"2":{"slot":2,"type":"STRING","value":"target_database"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"target_schema"},"2":{"slot":2,"type":"STRING","value":"target_schema"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2967194],"inputIterationConnectorIDs":[]},"2967181":{"id":2967181,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-144,"y":96,"width":32,"height":32,"inputConnectorIDs":[2967197],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Force Refresh"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"USE WAREHOUSE DEV;\nCREATE OR REPLACE TABLE ${target_database}.PUBLIC.DELETE_METADATA AS\nWITH\n   CREDIT_TABLES AS (\n      SELECT DISTINCT\n             TABLE_NAME\n           , REPLACE(TABLE_NAME,'credit_','') AS ROOT_NAME\n           , DECODE(ROOT_NAME,'users','_user',ROOT_NAME) AS CORE_TABLE\n      FROM ${target_database}.PUBLIC.DATABASE_METADATA\n      WHERE SCHEMA_NAME ILIKE '%credit%'\n         OR TABLE_NAME ILIKE '%credit%'\n         OR COLUMNS ILIKE '%credit%'\n      ),\n   CORE_TABLES AS (\n      SELECT META.TABLE_NAME\n      FROM ${target_database}.PUBLIC.DATABASE_METADATA META\n      JOIN CREDIT_TABLES ON CREDIT_TABLES.CORE_TABLE = META.TABLE_NAME\n      ),\n   STALE_TABLES AS (\n      SELECT META.TABLE_NAME\n      FROM ${target_database}.PUBLIC.DATABASE_METADATA META\n      WHERE LAST_UPDATE < (CURRENT_DATE-5)\n     \tAND DAYOFWEEK(CURRENT_DATE) = 7\n      )\nSELECT DISTINCT TABLE_NAME FROM CREDIT_TABLES\nUNION\nSELECT DISTINCT TABLE_NAME FROM CORE_TABLES\nUNION\nSELECT DISTINCT TABLE_NAME FROM STALE_TABLES\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967182":{"id":2967182,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":240,"y":0,"width":32,"height":32,"inputConnectorIDs":[2967173],"outputSuccessConnectorIDs":[2967172],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\ndblist     = [str(db[0]) for db in context.getGridVariable('database_list')]\n\nsqlview_database = 'CREATE OR REPLACE VIEW ${target_database}.PUBLIC.DATABASE_METADATA AS '\nsqlview_loading  = 'CREATE OR REPLACE VIEW ${target_database}.PUBLIC.LOAD_METADATA AS '\nsql_prefix = 'SELECT ROW_NUMBER() OVER (PARTITION BY DATABASE_NAME ORDER BY EST_ROWS ASC) AS PROC_ORDER, * FROM ('\nsql_select = '  SELECT * FROM '\nsql_union  = ' UNION ALL '\nsql_suffix = ') ORDER BY LAST_UPDATE DESC, SCHEMA_NAME ASC'\n\ndef sql_string(x,y):\n  return 'SELECT * FROM ${target_database}.' + x + '.' + y\n\nsqlview_database = sqlview_database + sql_prefix + sql_union.join(map(sql_string,dblist,['SCHEMA_METADATA']*len(dblist))) + sql_suffix\nsqlview_loading  = sqlview_loading  + sql_prefix + sql_union.join(map(sql_string,dblist,['LOAD_METADATA']*len(dblist)))   + sql_suffix\nprint(sqlview_database)\nprint(sqlview_loading)\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967183":{"id":2967183,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":400,"y":0,"width":32,"height":32,"inputConnectorIDs":[2967168],"outputSuccessConnectorIDs":[2967175],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Query Result To Grid 0"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WITH\n   SOURCES AS (\n      SELECT ROW_NUMBER() OVER (PARTITION BY DATABASE_NAME ORDER BY EST_ROWS ASC) AS LOAD_ROUND\n           , DATABASE_NAME                                                        AS SOURCE_DATABASE\n           , SCHEMA_NAME                                                          AS SOURCE_SCHEMA\n           , TABLE_NAME\n           , '${target_database}'                                                 AS TARGET_DATABASE\n           , DATABASE_NAME                                                        AS TARGET_SCHEMA\n           , EST_ROWS\n      FROM ${target_database}.PUBLIC.LOAD_METADATA\n      )\nSELECT LOAD_ROUND\n     , MOD(ROW_NUMBER() OVER (ORDER BY LOAD_ROUND ASC),4) AS DISTRIBUTE\n     , SOURCE_DATABASE\n     , SOURCE_SCHEMA\n     , TABLE_NAME\n     , TARGET_DATABASE\n     , TARGET_SCHEMA\nFROM SOURCES\nORDER BY LOAD_ROUND ASC, DISTRIBUTE ASC"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"table_list"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LOAD_ROUND"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DISTRIBUTE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE_DATABASE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE_SCHEMA"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"TABLE_NAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"TARGET_DATABASE"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"TARGET_SCHEMA"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967200":{"id":2967200,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-144,"y":-32,"width":32,"height":32,"inputConnectorIDs":[2967199],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Grants"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"--GRANT OWNERSHIP ON DATABASE ADW_BETA                   TO ROLE SYSADMIN REVOKE CURRENT GRANTS;\n--GRANT OWNERSHIP ON ALL SCHEMAS IN DATABASE ADW_BETA    TO ROLE SYSADMIN REVOKE CURRENT GRANTS;\n--GRANT OWNERSHIP ON FUTURE SCHEMAS IN DATABASE ADW_BETA TO ROLE SYSADMIN REVOKE CURRENT GRANTS;\n--GRANT OWNERSHIP ON ALL TABLES IN DATABASE ADW_BETA     TO ROLE SYSADMIN REVOKE CURRENT GRANTS;\n--GRANT OWNERSHIP ON FUTURE TABLES IN DATABASE ADW_BETA  TO ROLE SYSADMIN REVOKE CURRENT GRANTS;\n--GRANT OWNERSHIP ON ALL VIEWS IN DATABASE ADW_BETA      TO ROLE SYSADMIN REVOKE CURRENT GRANTS;\n--GRANT OWNERSHIP ON FUTURE VIEWS IN DATABASE ADW_BETA   TO ROLE SYSADMIN REVOKE CURRENT GRANTS;\n--GRANT USAGE ON DATABASE ADW_BETA                       TO ROLE BETA_FULLACCESS;\n--GRANT USAGE ON ALL SCHEMAS IN DATABASE ADW_BETA        TO ROLE BETA_FULLACCESS; \n--GRANT USAGE ON FUTURE SCHEMAS IN DATABASE ADW_BETA     TO ROLE BETA_FULLACCESS; \n--GRANT ALL ON ALL TABLES IN DATABASE ADW_BETA           TO ROLE BETA_FULLACCESS; \n--GRANT ALL ON FUTURE TABLES IN DATABASE ADW_BETA        TO ROLE BETA_FULLACCESS; \n--GRANT ROLE BETA_FULLACCESS                             TO ROLE DATA_ENGINEERING_GROUP;\n--GRANT ROLE BETA_FULLACCESS                             TO ROLE DATA_SCIENCE_ANALYTICS;\n--GRANT ROLE BETA_FULLACCESS                             TO ROLE SYSADMIN;\n--GRANT ROLE BETA_FULLACCESS                             TO ROLE LOOKER_ROLE;\n\nCREATE OR REPLACE VIEW ADW_BETA.PUBLIC.DATABASE_METADATA AS SELECT ROW_NUMBER() OVER (PARTITION BY DATABASE_NAME ORDER BY EST_ROWS ASC) AS PROC_ORDER, * FROM (SELECT * FROM ADW_BETA.account_approval_db.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.account_management.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.account_opening_alloy.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.account_opening_galileo.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.banking_db.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.check_deposit.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.credit_account_management.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.credit_payments.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.credit_transactions.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.impact_db.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.sweep_db.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.web_db.SCHEMA_METADATA) ORDER BY LAST_UPDATE DESC, SCHEMA_NAME ASC;\nCREATE OR REPLACE VIEW ADW_BETA.PUBLIC.LOAD_METADATA AS SELECT ROW_NUMBER() OVER (PARTITION BY DATABASE_NAME ORDER BY EST_ROWS ASC) AS PROC_ORDER, * FROM (SELECT * FROM ADW_BETA.account_approval_db.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.account_management.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.account_opening_alloy.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.account_opening_galileo.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.banking_db.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.check_deposit.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.credit_account_management.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.credit_payments.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.credit_transactions.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.impact_db.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.sweep_db.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.web_db.LOAD_METADATA) ORDER BY LAST_UPDATE DESC, SCHEMA_NAME ASC;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2967168":{"id":2967168,"sourceID":2967178,"targetID":2967183},"2967169":{"id":2967169,"sourceID":2967127,"targetID":2967126},"2967171":{"id":2967171,"sourceID":2967176,"targetID":2967127},"2967172":{"id":2967172,"sourceID":2967182,"targetID":2967178},"2967173":{"id":2967173,"sourceID":2967126,"targetID":2967182},"2967174":{"id":2967174,"sourceID":2967180,"targetID":2967123},"2967175":{"id":2967175,"sourceID":2967183,"targetID":2967180}},"failureConnectors":{},"unconditionalConnectors":{"2967170":{"id":2967170,"sourceID":2967177,"targetID":2967176},"2967196":{"id":2967196,"sourceID":2967177,"targetID":2967179},"2967197":{"id":2967197,"sourceID":2967179,"targetID":2967181},"2967199":{"id":2967199,"sourceID":2967179,"targetID":2967200}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"2967192":{"id":2967192,"sourceID":2967176,"targetID":2967122},"2967193":{"id":2967193,"sourceID":2967126,"targetID":2967125},"2967194":{"id":2967194,"sourceID":2967180,"targetID":2967121},"2967195":{"id":2967195,"sourceID":2967123,"targetID":2967120},"2967198":{"id":2967198,"sourceID":2967127,"targetID":2967124}},"noteConnectors":{},"notes":{"2967128":{"id":2967128,"x":-337,"y":-102,"width":160,"height":169,"text":"account_approval_db\naccount_management\naccount_opening_alloy\naccount_opening_galileo\nbanking_db\ncheck_deposit\ncredit_account_management\ncredit_payments\ncredit_transactions\nimpact_db\nsweep_db\nweb_db","colour":"e6e63c"},"2967130":{"id":2967130,"x":-336,"y":-261,"width":313,"height":70,"text":"This Job only refreshes tables that have column changes (added, removed, datatype) and tables/schemas specified in the force refresh list.\n\nRefreshes are only full load (no incremental)","colour":"d60000"},"2967131":{"id":2967131,"x":-337,"y":-159,"width":160,"height":63,"text":"\nSELECT *\nFROM pg_database\n\nWHERE datname NOT IN ('postgres','rdsadmin','template0','template1')","colour":"e6e63c"}},"variables":{"source_database":{"definition":{"name":"source_database","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"WEB_DB"},"source_schema":{"definition":{"name":"source_schema","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"PUBLIC"},"sqlview_database":{"definition":{"name":"sqlview_database","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"sqlview_loading":{"definition":{"name":"sqlview_loading","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"table":{"definition":{"name":"table","type":"TEXT","scope":"BRANCH","description":"Public","visibility":"PUBLIC"},"value":"ACCOUNT"},"target_database":{"definition":{"name":"target_database","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ADW_BETA"},"target_schema":{"definition":{"name":"target_schema","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"WEB_DB"}},"grids":{"database_list":{"definition":{"name":"database_list","scope":"BRANCH","definitions":[{"name":"source_database","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["account_approval_db"]},{"values":["account_management"]},{"values":["account_opening_alloy"]},{"values":["account_opening_galileo"]},{"values":["banking_db"]},{"values":["check_deposit"]},{"values":["credit_account_management"]},{"values":["credit_payments"]},{"values":["credit_transactions"]},{"values":["impact_db"]},{"values":["sweep_db"]},{"values":["web_db"]}]},"table_list":{"definition":{"name":"table_list","scope":"BRANCH","definitions":[{"name":"load_round","type":"TEXT"},{"name":"distribute","type":"TEXT"},{"name":"source_database","type":"TEXT"},{"name":"source_schema","type":"TEXT"},{"name":"table","type":"TEXT"},{"name":"target_database","type":"TEXT"},{"name":"target_schema","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["web_db","public","_user","ADW_BETA","WEB_DB","",""]}]}}},"info":{"name":"beta_database_load","description":"","type":"ORCHESTRATION","tag":"f0d53432-d902-4b5d-b2c6-c84403cb0cba"}}