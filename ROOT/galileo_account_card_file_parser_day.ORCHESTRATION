{"job":{"components":{"2956816":{"id":2956816,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-288,"y":0,"width":32,"height":32,"inputConnectorIDs":[2956857],"outputSuccessConnectorIDs":[2956863],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Unload file sections"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"copy into '${file_staging_path}/galileo_account_card_file_header.txt'\n('select record_data from ${staging_schema}.${file_staging_table_name} where record_type = ''H''')\ncredentials = (AWS_ROLE='arn:aws:iam::332894900161:role/RedshiftClusterRole')\nENCRYPTION = (KMS_KEY_ID='${kms_key_id}')\nOVERWRITE =TRUE;\n\n\ncopy into '${file_staging_path}/galileo_account_card_file_detail.txt'\n('select record_data from ${staging_schema}.${file_staging_table_name} where record_type = ''D''')\ncredentials = (AWS_ROLE='arn:aws:iam::332894900161:role/RedshiftClusterRole')\nENCRYPTION = (KMS_KEY_ID='${kms_key_id}')\nOVERWRITE =TRUE ;\n\n\n\ncopy into '${file_staging_path}/galileo_account_card_file_trailer.txt'\n('select record_data from ${staging_schema}.${file_staging_table_name} where record_type = ''T''')\ncredentials = (AWS_ROLE='arn:aws:iam::332894900161:role/RedshiftClusterRole')\nENCRYPTION = (KMS_KEY_ID='${kms_key_id}')\nOVERWRITE =TRUE ;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2956817":{"id":2956817,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1072,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2956852],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2956818":{"id":2956818,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-944,"y":0,"width":32,"height":32,"inputConnectorIDs":[2956852],"outputSuccessConnectorIDs":[2956862],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Initialize Vars"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\nl_s3_file_path = '{0}/{1}'.format(current_year, int(current_month))\ncontext.updateVariable(\"s3_file_path\", l_s3_file_path)\n\n#print(l_s3_file_path)\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2956819":{"id":2956819,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-144,"y":0,"width":32,"height":32,"inputConnectorIDs":[2956863],"outputSuccessConnectorIDs":[2956856],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load file sections"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"copy ${staging_schema}.galileo_account_card_file_header_staging(\"HEADER\", \"PROCESSOR_NAME\", \"REPORT_DATA_FEED_NAME\", \"FILE_TRANSMIT_DATE\", \"WORK_OF_DATE\")\nfrom '${file_staging_path}/galileo_account_card_file_header.txt'\niam_role 'arn:aws:iam::332894900161:role/RedshiftClusterRole'\nfixedwidth 'HEADER:6,PROCESSOR_NAME:50,REPORT_DATA_FEED_NAME:50,FILE_TRANSMIT_DATE:8,WORK_OF_DATE:8'\nTRIMBLANKS\nEMPTYASNULL\nBLANKSASNULL\nCOMPUPDATE OFF\nSTATUPDATE OFF\nACCEPTINVCHARS AS '?'\n;\n\ncopy ${staging_schema}.galileo_account_card_file_detail_staging(\"UNIQUE_PROGRAM_ID\", \"GROUP_ID\", \"PRODUCT_ID\", \"GALILEO_ACCOUNT_ID\", \"PRN\", \"EXPIRATION_DATE\", \"STATUS\", \"CARD_ID\", \"CARD_NUMBER\", \"TYPE_OF_CARD\", \"PRN_2\", \"FLAG_1\")\nfrom '${file_staging_path}/galileo_account_card_file_detail.txt'\niam_role 'arn:aws:iam::332894900161:role/RedshiftClusterRole'\nfixedwidth 'UNIQUE_PROGRAM_ID:15,GROUP_ID:15,PRODUCT_ID:15,GALILEO_ACCOUNT_ID:30,PRN:12,EXPIRATION_DATE:8,STATUS:5,CARD_ID:30,CARD_NUMBER:16,TYPE_OF_CARD:10,PRN_2:12,FLAG_1:1'\nTRIMBLANKS\nEMPTYASNULL\nBLANKSASNULL\nCOMPUPDATE OFF\nSTATUPDATE OFF\nACCEPTINVCHARS AS '?'\n;\n\ncopy ${staging_schema}.galileo_account_card_file_trailer_staging(\"TRAILER\", \"COUNT\")\nfrom '${file_staging_path}/galileo_account_card_file_trailer.txt'\niam_role 'arn:aws:iam::332894900161:role/RedshiftClusterRole'\nfixedwidth 'TRAILER:7,COUNT:9'\nTRIMBLANKS\nEMPTYASNULL\nBLANKSASNULL\nCOMPUPDATE OFF\nSTATUPDATE OFF\nACCEPTINVCHARS AS '?'\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2956820":{"id":2956820,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-816,"y":0,"width":32,"height":32,"inputConnectorIDs":[2956862],"outputSuccessConnectorIDs":[2956859],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Initialize Vars - test"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nimport datetime\n\nl_current_year = datetime.date.today().strftime('%Y')\nl_current_month = datetime.date.today().strftime('%m')\nl_current_day = datetime.date.today().strftime('%d')\n\nl_s3_file_path = '{0}/{1}'.format(l_current_year, l_current_month)\nl_s3_filename = 'interest_accrual_{0}{1}{2}.csv'.format(l_current_year, l_current_month, l_current_day)\n\ncontext.updateVariable(\"s3_file_path\", l_s3_file_path)\ncontext.updateVariable(\"s3_filename\", l_s3_filename)\n\n#print(l_s3_file_path)\n#print(l_s3_filename)\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2956822":{"id":2956822,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[2956856],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Process file data"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delete from rdl.raw_galileo_account_card_data\nwhere file_date = '${current_year}-${current_month}-${current_day}'\n;\n\ninsert into rdl.raw_galileo_account_card_data(\"file_date\", \"record_type\", \"unique_program_id\", \"group_id\", \"product_id\", \"galileo_account_id\", \"prn\", \"expiration_date\", \"status\", \"card_id\", \"card_number\", \"type_of_card\", \"prn_2\", \"flag_1\")\nselect '${current_year}-${current_month}-${current_day}', \"record_type\", \"unique_program_id\", \"group_id\", \"product_id\", \"galileo_account_id\", \"prn\", \"expiration_date\", \"status\", \"card_id\", \"card_number\", \"type_of_card\", \"prn_2\", \"flag_1\"\nfrom etl.galileo_account_card_file_detail_staging\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2956823":{"id":2956823,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":773867971,"x":-432,"y":0,"width":32,"height":32,"inputConnectorIDs":[2956853],"outputSuccessConnectorIDs":[2956857],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load file to staging table"}}}},"visible":true},"4":{"slot":4,"name":"S3 Object Prefix","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${file_staging_output_path}/${s3_file_path}/"}}}},"visible":true},"5":{"slot":5,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"8":{"slot":8,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GALILEO_ACCOUNT_CARD_FILE_DETAIL_STAGING"}}}},"visible":true},"9":{"slot":9,"name":"Load Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"RECORD_TYPE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"UNIQUE_PROGRAM_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"GROUP_ID"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PRODUCT_ID"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"GALILEO_ACCOUNT_ID"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"PRN"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"EXPIRATION_DATE"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"STATUS"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"CARD_ID"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"CARD_NUMBER"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"TYPE_OF_CARD"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"PRN_2"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"FLAG_1"}}}},"visible":true},"10":{"slot":10,"name":"Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"11":{"slot":11,"name":"File Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSV"}}}},"visible":true},"12":{"slot":12,"name":"Compression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUTO"}}}},"visible":true},"20":{"slot":20,"name":"Record Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR","value":""}}}},"visible":true},"21":{"slot":21,"name":"Field Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR","value":""}}}},"visible":true},"22":{"slot":22,"name":"Skip Header","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"23":{"slot":23,"name":"Date Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"24":{"slot":24,"name":"Time Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"25":{"slot":25,"name":"Timestamp Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"26":{"slot":26,"name":"","elements":{},"visible":false},"27":{"slot":27,"name":"Escape","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"28":{"slot":28,"name":"Escape Unenclosed Field","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR","value":""}}}},"visible":true},"29":{"slot":29,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"30":{"slot":30,"name":"Field Optionally Enclosed","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\""}}}},"visible":true},"31":{"slot":31,"name":"Null If","elements":{},"visible":true},"32":{"slot":32,"name":"Error On Column Count Mismatch","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"33":{"slot":33,"name":"Empty Field as Null","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"34":{"slot":34,"name":"Encoding Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"40":{"slot":40,"name":"Enable Octal","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"41":{"slot":41,"name":"Allow Duplicates","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"42":{"slot":42,"name":"Strip Outer Array","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"43":{"slot":43,"name":"Strip Null Values","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"44":{"slot":44,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"60":{"slot":60,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"61":{"slot":61,"name":"Preserve Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"62":{"slot":62,"name":"Strip Outer Element","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"63":{"slot":63,"name":"Disable Snowflake Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"64":{"slot":64,"name":"Disable Auto Convert","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"120":{"slot":120,"name":"On Error","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Abort Statement"}}}},"visible":true},"121":{"slot":121,"name":"n","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"122":{"slot":122,"name":"Size Limit (B)","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"123":{"slot":123,"name":"Purge Files","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"124":{"slot":124,"name":"Truncate Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"125":{"slot":125,"name":"Force Load","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"140":{"slot":140,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"141":{"slot":141,"name":"Master Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"142":{"slot":142,"name":"KMS Key Id","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"200":{"slot":200,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"201":{"slot":201,"name":"Pattern","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":".*accountcard_${current_year}${current_month}${current_day}[.]csv"}}}},"visible":true},"203":{"slot":203,"name":"Metadata Fields","elements":{},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2956860":{"id":2956860,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-560,"y":0,"width":32,"height":32,"inputConnectorIDs":[2956858],"outputSuccessConnectorIDs":[2956853],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python Script 0"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nimport boto3\n#python function to call lambda to encrypt s3 file to send to galileo\n\nbody = json.dumps(dict(source_file='s3://aspiration-galileo-prod-sftp-all/${s3_file_path}/accountcard_${current_year}${current_month}${current_day}.txt',\n                       target_file='${file_staging_output_path}/${s3_file_path}/accountcard_${current_year}${current_month}${current_day}.csv',\n                       column_format='1,15,15,15,30,12,8,5,30,16,10,12,1',\n                       ignore_header='1',\n                       ignore_trailer='1',\n                       trim_blanks=True\n                      ))\n\ndef run_lambda():\n    client = boto3.client('lambda', region_name='us-west-2')\n    response = client.invoke(\n    FunctionName='${lambda_arn}',\n    InvocationType='Event',\n    LogType='Tail',\n    Payload=body\n    )\n\n\nrun_lambda()\n#{\n#   \"operation\": \"enc\",\n#   \"file\": \"s3://aspiration-datateam/dump/szhang/btrans_584_20200226_005.txt\",\n#   \"encrypted_file_path\": \"s3://aspiration-datateam/dump/szhang/\",\n#   \"gpg_key\": \"galileo_public_key\",\n#   \"extension\": \"gpg\"\n# }\n\n#{\n#   \"source_file\": \"s3://aspiration-datateam/dump/lnguyen/test_folder/accountcard_20200527.txt\",\n#   \"target_file\": \"s3://aspiration-datateam/dump/lnguyen/test_folder/accountcard_20200527.csv\",\n#   \"column_format\": \"1,15,15,15,30,12,8,5,30,16,10\",\n#   \"ignore_header\": 1,\n#   \"ignore_trailer\": 1,\n#   \"trim_blanks\": true\n# }"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2956861":{"id":2956861,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":237373210,"x":-688,"y":0,"width":32,"height":32,"inputConnectorIDs":[2956859],"outputSuccessConnectorIDs":[2956858],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate Table 0"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"4":{"slot":4,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GALILEO_ACCOUNT_CARD_FILE_DETAIL_STAGING"}}}},"visible":true},"6":{"slot":6,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2956853":{"id":2956853,"sourceID":2956860,"targetID":2956823},"2956856":{"id":2956856,"sourceID":2956819,"targetID":2956822},"2956857":{"id":2956857,"sourceID":2956823,"targetID":2956816},"2956858":{"id":2956858,"sourceID":2956861,"targetID":2956860},"2956859":{"id":2956859,"sourceID":2956820,"targetID":2956861},"2956862":{"id":2956862,"sourceID":2956818,"targetID":2956820},"2956863":{"id":2956863,"sourceID":2956816,"targetID":2956819}},"failureConnectors":{},"unconditionalConnectors":{"2956852":{"id":2956852,"sourceID":2956817,"targetID":2956818}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"current_day":{"definition":{"name":"current_day","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"27"},"current_month":{"definition":{"name":"current_month","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"05"},"current_year":{"definition":{"name":"current_year","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"2020"},"file_staging_output_path":{"definition":{"name":"file_staging_output_path","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"s3://aspiration-etl-staging/file_processing/stage_files"},"file_staging_path":{"definition":{"name":"file_staging_path","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"s3://aspiration-etl-staging/file_processing/galileo_account_card"},"file_staging_table_name":{"definition":{"name":"file_staging_table_name","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"galileo_account_card_file_staging"},"lambda_arn":{"definition":{"name":"lambda_arn","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"arn:aws:lambda:us-west-2:332894900161:function:data-python-fixedwidth-converter"},"s3_file_path":{"definition":{"name":"s3_file_path","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"2020/5"},"s3_filename":{"definition":{"name":"s3_filename","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"test_20181112.csv"}},"grids":{"file_dates":{"definition":{"name":"file_dates","scope":"BRANCH","definitions":[{"name":"file_date_year","type":"TEXT"},{"name":"file_date_month","type":"TEXT"},{"name":"file_date_day","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]},"table_list":{"definition":{"name":"table_list","scope":"BRANCH","definitions":[{"name":"table_name","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["galileo_account_card_file_staging"]},{"values":["galileo_account_card_file_header_staging"]},{"values":["galileo_account_card_file_detail_staging"]},{"values":["galileo_account_card_file_trailer_staging"]}]}}},"info":{"name":"galileo_account_card_file_parser_day","description":"","type":"ORCHESTRATION","tag":"56c70ee8-808d-4382-8c4a-1ad8d5c3dece"}}