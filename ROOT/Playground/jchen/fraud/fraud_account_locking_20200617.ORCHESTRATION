{"job":{"components":{"2959072":{"id":2959072,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":144,"y":176,"width":32,"height":32,"inputConnectorIDs":[2959098],"outputSuccessConnectorIDs":[2959099],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"load suspend_account_20200617"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP TABLE if exists etl.fraud_account_suspend_20200617;\n\nCREATE TABLE if not exists etl.fraud_account_suspend_20200617 (\n  prn varchar(255)\n)\n;\n\ntruncate etl.fraud_account_suspend_20200617;\n\ncopy into etl.fraud_account_suspend_20200617\n\tfrom @public.datateam/dump/jchen/fraud_account_locking/Suspending_Accounts_20200617.csv\nfile_format = (type ='CSV'\n    field_DELIMITER = ','\n    ESCAPE = '\\\\'\n    SKIP_HEADER = 1\n    )\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959073":{"id":2959073,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2959092,2959093],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959074":{"id":2959074,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":80,"y":80,"width":32,"height":32,"inputConnectorIDs":[2959092],"outputSuccessConnectorIDs":[2959098],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"load fraud_account_locking_20200617"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP TABLE if exists etl.fraud_account_locking_20200617;\n\nCREATE TABLE if not exists etl.fraud_account_locking_20200617 (\n  email varchar(255)\n)\n;\n\n-- truncate etl.fraud_account_locking_20200617;\n\ncopy etl.fraud_account_locking_20200617\nfrom 's3://aspiration-datateam/dump/jchen/fraud_account_locking/Accounts_for_Locking_20200617.csv'\niam_role 'arn:aws:iam::332894900161:role/RedshiftClusterRole'\ndelimiter ','\nremovequotes\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959075":{"id":2959075,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":208,"y":272,"width":32,"height":32,"inputConnectorIDs":[2959099],"outputSuccessConnectorIDs":[2959096],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of create galileo account change table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE etl.galileo_account_changes_batch_header\nSET file_name = 'bchanges_584_20200618_as021.txt.gpg',\n       file_transmit_date = '06182020'\nWHERE record_type = 'H'\n;\n\ndelete from etl.galileo_account_changes_batch_detail;\ninsert into etl.galileo_account_changes_batch_detail(record_type, record_number, account_id_type, account_identifier, action_code, action_value)\nselect\n  'D' as record_type\n  ,row_number() over (order by prn) as recordnumber\n  ,'R' as accountidtype\n  ,prn::varchar as accountidentifier\n  ,'2' as actioncode\n  ,'X' as actionvalue\nfrom etl.fraud_account_suspend_20200617\nWHERE 1=1\n  and prn not in (\n223103172274,\n223105599151,\n223106835141\n  )\n;\n\n--trailer data\nUPDATE etl.galileo_account_changes_batch_trailer\n   SET \"count\" = (select count(*) from etl.galileo_account_changes_batch_detail)\nWHERE record_type = 'T';\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959097":{"id":2959097,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-128,"y":192,"width":32,"height":32,"inputConnectorIDs":[2959093],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"table creation - galileo_account_change_batch"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create table etl.galileo_bchanges_file_temp_jchen\n(\n\trow_no bigint,\n\t\"row\" varchar(20000)\n);\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959100":{"id":2959100,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":240,"y":368,"width":32,"height":32,"inputConnectorIDs":[2959096],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of create galileo account change file"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"drop table if exists etl.galileo_bchanges_file_temp_jchen;\ncreate table etl.galileo_bchanges_file_temp_jchen (\n  row_no BIGINT,\n  \"row\"    varchar(20000)\n)\n;\n\ninsert into etl.galileo_bchanges_file_temp_jchen (row_no, \"row\")\nselect\n  0,\n  record_type ||\n  header ||\n  rpad(client_id, 10, ' ') ||\n  rpad(program_id, 10, ' ') ||\n  rpad((file_name), 50, ' ') ||\n  file_transmit_date\nfrom etl.galileo_account_changes_batch_header\n;\n\ninsert into etl.galileo_bchanges_file_temp_jchen (row_no, \"row\")\nselect record_number::BIGINT,\n       'D' ||\n       rpad(record_number, 6, ' ') ||\n       'R' ||\n       rpad(account_identifier,50,' ') ||\n       rpad((action_code),5,' ') ||\n       rpad((action_value),255,' ')\nfrom etl.galileo_account_changes_batch_detail\n;\n\ninsert into etl.galileo_bchanges_file_temp_jchen (row_no, \"row\")\nselect 10000000,\n       record_type ||\n       trailer || rpad(count, 6,' ')\nfrom etl.galileo_account_changes_batch_trailer\n;\n\ncopy into @public.DATATEAM/dump/jchen/galileo_snowflake/bchanges_584_20200618_as021.txt\nfrom (\n\tSELECT \"row\" FROM etl.galileo_bchanges_file_temp_jchen ORDER BY row_no\n)\nfile_format = (format_name = GALILEO_CSV_FORMAT, compression = NONE)\nSINGLE=true\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2959096":{"id":2959096,"sourceID":2959075,"targetID":2959100},"2959098":{"id":2959098,"sourceID":2959074,"targetID":2959072},"2959099":{"id":2959099,"sourceID":2959072,"targetID":2959075}},"failureConnectors":{},"unconditionalConnectors":{"2959092":{"id":2959092,"sourceID":2959073,"targetID":2959074},"2959093":{"id":2959093,"sourceID":2959073,"targetID":2959097}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"fraud_account_locking_20200617","description":null,"type":"ORCHESTRATION","tag":"9686f837-0d3e-4a50-aa5d-d4e396a1aed1"}}