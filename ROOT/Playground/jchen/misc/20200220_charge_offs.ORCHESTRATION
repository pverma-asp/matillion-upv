{"job":{"components":{"2959028":{"id":2959028,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":160,"y":176,"width":32,"height":32,"inputConnectorIDs":[2959030],"outputSuccessConnectorIDs":[2959025],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create galileo account change table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE etl.galileo_account_changes_batch_header\nSET file_name = 'bchanges_584_20200220_021.txt.gpg',\n       file_transmit_date = '02202020'\nWHERE record_type = 'H'\n;\n\ndelete from etl.galileo_account_changes_batch_detail;\ninsert into etl.galileo_account_changes_batch_detail(record_type, record_number, account_id_type, account_identifier, action_code, action_value)\nselect\n  'D' as record_type\n  ,row_number() over () as recordnumber\n  ,'R' as accountidtype\n  ,save_galileo_prn::varchar as accountidentifier\n  ,'2' as actioncode\n  ,'C' as actionvalue\nfrom etl.charge_offs_20200220\nWHERE 1=1\n;\n\n--trailer data\nUPDATE etl.galileo_account_changes_batch_trailer\n   SET \"count\" = (select count(*) from etl.galileo_account_changes_batch_detail)\nWHERE record_type = 'T';\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959029":{"id":2959029,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":128,"y":64,"width":32,"height":32,"inputConnectorIDs":[2959024],"outputSuccessConnectorIDs":[2959030],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"load charge_offs.csv"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP TABLE if exists etl.charge_offs_20200220;\n\nCREATE TABLE if not exists etl.charge_offs_20200220 (\n  full_name varchar(255),\n  first_name varchar(255),\n  external_user_id varchar(255),\n  email varchar(255),\n  save_galileo_prn varchar(255)\n);\n\n-- truncate etl.charge_offs_20200220;\n\ncopy etl.charge_offs_20200220\nfrom 's3://aspiration-datateam/dump/jchen/charge_offs/Final_Charge-off_Save_PRNs_Clean.csv'\niam_role 'arn:aws:iam::332894900161:role/RedshiftClusterRole'\ndelimiter ','\nIGNOREHEADER 1\nremovequotes\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959031":{"id":2959031,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":160,"y":288,"width":32,"height":32,"inputConnectorIDs":[2959025],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create galileo account change file"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"drop table if exists etl.galileo_bchanges_file_temp_jchen;\ncreate table etl.galileo_bchanges_file_temp_jchen (\n  row_no BIGINT,\n  row    varchar(20000)\n)\n;\n\ninsert into etl.galileo_bchanges_file_temp_jchen (row_no, row)\nselect\n  0,\n  record_type ||\n  header ||\n  rpad(client_id, 10, ' ') ||\n  rpad(program_id, 10, ' ') ||\n  rpad((file_name), 50, ' ') ||\n  file_transmit_date\nfrom etl.galileo_account_changes_batch_header\n;\n\ninsert into etl.galileo_bchanges_file_temp_jchen (row_no, row)\nselect record_number::BIGINT,\n       'D' ||\n       rpad(record_number, 6, ' ') ||\n       'R' ||\n       rpad(account_identifier,50,' ') ||\n       rpad((action_code),5,' ') ||\n       rpad((action_value),255,' ')\nfrom etl.galileo_account_changes_batch_detail\n;\n\ninsert into etl.galileo_bchanges_file_temp_jchen (row_no, row)\nselect 10000000,\n       record_type ||\n       trailer || rpad(count, 6,' ')\nfrom etl.galileo_account_changes_batch_trailer\n;\n\nUNLOAD ('SELECT row FROM etl.galileo_bchanges_file_temp_jchen ORDER BY row_no') \nTO 's3://aspiration-datateam/dump/jchen/galileo/bchanges_584_20200220_021.txt'\niam_role '${redshift_role}'\nPARALLEL OFF \nENCRYPTED   \nALLOWOVERWRITE; \n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959034":{"id":2959034,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2959024],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2959025":{"id":2959025,"sourceID":2959028,"targetID":2959031},"2959030":{"id":2959030,"sourceID":2959029,"targetID":2959028}},"failureConnectors":{},"unconditionalConnectors":{"2959024":{"id":2959024,"sourceID":2959034,"targetID":2959029}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"20200220_charge_offs","description":"","type":"ORCHESTRATION","tag":"0d4e8fd4-c51f-4751-870b-5f43a0c23c5f"}}