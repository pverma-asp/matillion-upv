{"job":{"components":{"2959008":{"id":2959008,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":160,"y":368,"width":32,"height":32,"inputConnectorIDs":[2959038],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of create galileo file"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"drop table if exists etl.galileo_file_temp_jchen;\ncreate table etl.galileo_file_temp_jchen (\n  row_no BIGINT,\n  row    varchar(20000)\n)\n;\n\ninsert into etl.galileo_file_temp_jchen (row_no, row)\nselect\n  0,\n  recordtype ||\n  header ||\n  rpad(clientid, 10, ' ') ||\n  rpad(programid, 10, ' ') ||\n  rpad((filename), 50, ' ') ||\n  filetransmitdate\nfrom etl.galileo_transaction_batch_header\n;\n\n\ninsert into etl.galileo_file_temp_jchen (row_no, row)\nselect recordnumber::BIGINT,\n       'D' ||\n       rpad(recordnumber, 6, ' ') ||\n       'R' ||\n       rpad(accountidentifier,50,' ') ||\n       lpad('',21,' ') ||\n       transactiontype ||\n       rpad(transactionsubtype, 3, ' ') ||\n       rpad(transactionamount,13,' ') ||\n       rpad((transactiondescription),40,' ') ||\n       rpad((transactionidentifier),20,' ')\nfrom etl.galileo_transaction_batch_detail\n;\n\ninsert into etl.galileo_file_temp_jchen (row_no, row)\nselect 10000000,\n       recordtype ||\n       trailer || rpad(count, 6,' ')\nfrom etl.galileo_transaction_batch_trailer\n;\n\n\nUNLOAD ('SELECT row FROM etl.galileo_file_temp_jchen ORDER BY row_no') \nTO 's3://aspiration-datateam/dump/jchen/galileo/btrans_584_20200211_022.txt'\niam_role '${redshift_role}'\nPARALLEL OFF \nENCRYPTED   \nALLOWOVERWRITE; \n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959010":{"id":2959010,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2959032],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959011":{"id":2959011,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":160,"y":272,"width":32,"height":32,"inputConnectorIDs":[2959039],"outputSuccessConnectorIDs":[2959038],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create galileo btrans table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE etl.galileo_transaction_batch_header\nSET filename = 'btrans_584_20200211_022.txt.gpg',\nfiletransmitdate = '02112020'\nWHERE recordtype = 'H'\n;\n\n\ndelete from etl.galileo_transaction_batch_detail;\ninsert into etl.galileo_transaction_batch_detail(recordtype,\nrecordnumber, accountidtype, accountidentifier, transactiontype,\ntransactionsubtype, transactionamount, transactiondescription, transactionidentifier)\nSELECT\n    'D' as recordtype\n     , row_number() over(order by spend_galileo_prn) as recordnumber\n     , 'R' as accountidtype\n     ,  spend_galileo_prn as accountidentifier\n     , 'A' as transactiontype\n     , 'Q' as transactionsubtype\n     ,  replace(charge_off_balance, '$', '')::numeric(18,2)::varchar(100) as transactionamount\n     , 'Balance Offset' as transactiondescription\n     , 'BO_200211-R' || lpad(row_number() over(order by spend_galileo_prn), 4, '0') as transactionidentifier\nFROM etl.charge_offs_reversal_20200211\nWHERE 1=1\n--  AND spend_galileo_prn=223103420145\n;\n\n\nUPDATE etl.galileo_transaction_batch_trailer\nSET \"count\" = (SELECT count(1) from etl.galileo_transaction_batch_detail)\nWHERE recordtype = 'T'\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959036":{"id":2959036,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":160,"y":176,"width":32,"height":32,"inputConnectorIDs":[2959033],"outputSuccessConnectorIDs":[2959039],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create galileo account change table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE etl.galileo_account_changes_batch_header\nSET file_name = 'bchanges_584_20200207_023.txt.gpg',\n       file_transmit_date = '02072020'\nWHERE record_type = 'H'\n;\n\ndelete from etl.galileo_account_changes_batch_detail;\ninsert into etl.galileo_account_changes_batch_detail(record_type, record_number, account_id_type, account_identifier, action_code, action_value)\nselect\n  'D' as record_type\n  ,row_number() over () as recordnumber\n  ,'R' as accountidtype\n  ,spend_galileo_prn::varchar as accountidentifier\n  ,'2' as actioncode\n  ,'C' as actionvalue\nfrom etl.charge_offs_20200207\nWHERE 1=1\n  AND spend_galileo_prn!=223103420145;\n\n--trailer data\nUPDATE etl.galileo_account_changes_batch_trailer\n   SET \"count\" = (select count(*) from etl.galileo_account_changes_batch_detail)\nWHERE record_type = 'T';\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959037":{"id":2959037,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":128,"y":64,"width":32,"height":32,"inputConnectorIDs":[2959032],"outputSuccessConnectorIDs":[2959033],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"load reversal.csv"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP TABLE if exists etl.charge_offs_reversal_20200211;\n\nCREATE TABLE if not exists etl.charge_offs_reversal_20200211 (\n  spend_galileo_prn varchar(255),\n  charge_off_balance varchar(255)\n)\n;\n\n-- truncate etl.charge_offs_20200211;\n\ncopy etl.charge_offs_reversal_20200211\nfrom 's3://aspiration-datateam/dump/jchen/charge_offs/Reversal_Clean.csv'\niam_role 'arn:aws:iam::332894900161:role/RedshiftClusterRole'\ndelimiter ','\nIGNOREHEADER 1\nremovequotes\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2959033":{"id":2959033,"sourceID":2959037,"targetID":2959036},"2959038":{"id":2959038,"sourceID":2959011,"targetID":2959008},"2959039":{"id":2959039,"sourceID":2959036,"targetID":2959011}},"failureConnectors":{},"unconditionalConnectors":{"2959032":{"id":2959032,"sourceID":2959010,"targetID":2959037}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"20200211_charge_offs_reversal","description":"","type":"ORCHESTRATION","tag":"5b2b42aa-68d9-483f-9e2d-2568abad0dfb"}}