{"job":{"components":{"2959410":{"id":2959410,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":16,"y":208,"width":32,"height":32,"inputConnectorIDs":[2959438],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Send_File_to_Galileo 0"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Send_File_to_Galileo"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"galileo_filename"},"2":{"slot":2,"type":"STRING","value":"btrans_584_20210611_bt021.txt"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959436":{"id":2959436,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":16,"y":112,"width":32,"height":32,"inputConnectorIDs":[2959433],"outputSuccessConnectorIDs":[2959438],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create galileo btrans table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE etl.galileo_transaction_batch_header\nSET filename = 'btrans_584_20210611_bt021.txt.gpg',\nfiletransmitdate = '06112021'\nWHERE recordtype = 'H'\n;\n\ntruncate table etl.galileo_transaction_batch_detail;\ninsert into etl.galileo_transaction_batch_detail(recordtype,\nrecordnumber, accountidtype, accountidentifier, transactiontype,\ntransactionsubtype, transactionamount, transactiondescription, transactionidentifier)\n\nwith a as (\n    select OLD_PRN         as prn,\n           BALANCE_TO_MOVE as amount\n    from etl.prns_and_balances_20210611_001\n    union all\n    select NEW_PRN          as prn,\n           -BALANCE_TO_MOVE as amount\n    from etl.prns_and_balances_20210611_001\n)\n-- select *\n-- from a\n-- where prn in (223101074654,223117642361)\n\nSELECT\n       'D' as recordtype\n     , row_number() over(order by prn) as recordnumber\n     , 'R' as accountidtype\n     ,  prn as accountidentifier\n     , 'A' as transactiontype\n     , 'Q' as transactionsubtype\n     ,  amount as transactionamount\n     , 'New account balance transfer' as transactiondescription\n     , 'BT_210610-1' || lpad(row_number() over(order by prn), 5, '0') as transactionidentifier\nfrom a\n;\n\nUPDATE etl.galileo_transaction_batch_trailer\nSET \"count\" = (SELECT count(1) from etl.galileo_transaction_batch_detail)\nWHERE recordtype = 'T'\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959437":{"id":2959437,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2959432,2959433],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959439":{"id":2959439,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-192,"y":96,"width":32,"height":32,"inputConnectorIDs":[2959432],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import csv file"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP TABLE if exists etl.prns_and_balances_20210611_001;\n\nCREATE TABLE if not exists etl.prns_and_balances_20210611_001 (\n  old_prn varchar(255),\n  new_prn varchar(255),\n  balance_to_move numeric(20,2)\n)\n;\n\ncopy into etl.prns_and_balances_20210611_001\n\tfrom @public.datateam/dump/jchen/promotions/prns_and_balances_20210611_001.csv\nfile_format = (type ='CSV'\n    field_DELIMITER = ','\n    ESCAPE = '\\\\'\n--    SKIP_HEADER = 1\n    )\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2959438":{"id":2959438,"sourceID":2959436,"targetID":2959410}},"failureConnectors":{},"unconditionalConnectors":{"2959432":{"id":2959432,"sourceID":2959437,"targetID":2959439},"2959433":{"id":2959433,"sourceID":2959437,"targetID":2959436}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"20210611_balance_transfer_test","description":"","type":"ORCHESTRATION","tag":"424335ff-0508-4b84-94f5-676f85a4c1a7"}}