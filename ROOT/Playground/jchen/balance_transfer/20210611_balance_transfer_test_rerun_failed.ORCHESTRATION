{"job":{"components":{"2959428":{"id":2959428,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2959424,2959425],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959429":{"id":2959429,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-192,"y":96,"width":32,"height":32,"inputConnectorIDs":[2959424],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import csv file"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP TABLE if exists etl.prns_and_balances_20210611_001;\n\nCREATE TABLE if not exists etl.prns_and_balances_20210611_001 (\n  old_prn varchar(255),\n  new_prn varchar(255),\n  balance_to_move numeric(20,2)\n)\n;\n\ncopy into etl.prns_and_balances_20210611_001\n\tfrom @public.datateam/dump/jchen/promotions/prns_and_balances_20210611_001.csv\nfile_format = (type ='CSV'\n    field_DELIMITER = ','\n    ESCAPE = '\\\\'\n--    SKIP_HEADER = 1\n    )\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959431":{"id":2959431,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":16,"y":112,"width":32,"height":32,"inputConnectorIDs":[2959425],"outputSuccessConnectorIDs":[2959430],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create galileo btrans table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE etl.galileo_transaction_batch_header\nSET filename = 'btrans_584_20210611_bt022.txt.gpg',\nfiletransmitdate = '06112021'\nWHERE recordtype = 'H'\n;\n\ntruncate table etl.galileo_transaction_batch_detail;\ninsert into etl.galileo_transaction_batch_detail(recordtype,\nrecordnumber, accountidtype, accountidentifier, transactiontype,\ntransactionsubtype, transactionamount, transactiondescription, transactionidentifier)\n\nwith a as (\n    select OLD_PRN         as prn,\n           BALANCE_TO_MOVE as amount\n    from etl.prns_and_balances_20210611_001\n    union all\n    select NEW_PRN          as prn,\n           -BALANCE_TO_MOVE as amount\n    from etl.prns_and_balances_20210611_001\n)\n-- select *\n-- from a\n-- where prn in (223101074654,223117642361)\n\nSELECT\n       'D' as recordtype\n     , row_number() over(order by prn) as recordnumber\n     , 'R' as accountidtype\n     ,  prn as accountidentifier\n     , 'A' as transactiontype\n     , 'Q' as transactionsubtype\n     ,  amount as transactionamount\n     , 'New account balance transfer' as transactiondescription\n     , 'BT_210611-2' || lpad(row_number() over(order by prn), 5, '0') as transactionidentifier\nfrom a\nwhere 1=1\n  and prn in (\n    select\n        ACCOUNT_IDENTIFIER\n    from etl.GALILEO_TRANSACTION_BATCH_RESPONSE_JCHEN\n    where 1=1\n      and FILENAME='btrans_584_20210611_bt021.txt'\n      and GALILEO_RESPONSE_CODE !='0000'\n    )\n;\n\nUPDATE etl.galileo_transaction_batch_trailer\nSET \"count\" = (SELECT count(1) from etl.galileo_transaction_batch_detail)\nWHERE recordtype = 'T'\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959434":{"id":2959434,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":16,"y":208,"width":32,"height":32,"inputConnectorIDs":[2959430],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Send_File_to_Galileo 0"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Send_File_to_Galileo"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"galileo_filename"},"2":{"slot":2,"type":"STRING","value":"btrans_584_20210611_bt022.txt"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2959430":{"id":2959430,"sourceID":2959431,"targetID":2959434}},"failureConnectors":{},"unconditionalConnectors":{"2959424":{"id":2959424,"sourceID":2959428,"targetID":2959429},"2959425":{"id":2959425,"sourceID":2959428,"targetID":2959431}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"20210611_balance_transfer_test_rerun_failed","description":"","type":"ORCHESTRATION","tag":"afb9318c-4097-4bad-82e8-905469e2a69c"}}