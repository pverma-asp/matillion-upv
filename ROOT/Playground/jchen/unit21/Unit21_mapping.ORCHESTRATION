{"job":{"components":{"2959384":{"id":2959384,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":48,"y":160,"width":32,"height":32,"inputConnectorIDs":[2959386],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"transaction type mapping table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"drop table if exists unit21.instrument_transaction_type_mapping;\n\ncreate table unit21.instrument_transaction_type_mapping as\nselect\n    'debit_card' as instrument,\n    'ATM Withdrawal' as aspiration_transaction_type\nunion all select 'debit_card', 'Purchase'\nunion all select 'debit_card', 'Purchase with PIN'\nunion all select 'debit_card', 'Debit Card - No PIN'\nunion all select 'debit_card', 'Debit Card - PIN'\nunion all select 'debit_card', 'Retail Sale'\nunion all select 'debit_card', 'Unique Transactions'\nunion all select 'debit_card', 'Pre-auth completion'\nunion all select 'debit_card', 'ATM Deposit'\nunion all select 'debit_card', 'Paypal Deposit'\nunion all select 'debit_card', 'Cash Disbursement'\n\nunion all select 'ach', 'Coastal ACH Debit'\nunion all select 'ach', 'Coastal ACH Deposit'\nunion all select 'ach', 'Money Transfer'\nunion all select 'ach', 'E-Check'\nunion all select 'ach', 'ACH Deposit'\nunion all select 'ach', 'ACH Withdrawal'\n\nunion all select 'wire', 'API funds transfer'\nunion all select 'wire', 'API funds transfer offset'\n\nunion all select 'check', 'RDC Other Check Deposit'\nunion all select 'check', 'Bill Pay Check Payment'\nunion all select 'check', 'Bill Payment - Check'\nunion all select 'check', 'Check Deposit'\nunion all select 'check', 'Check Withdrawal'\n\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959385":{"id":2959385,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-176,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2959383],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"fix unit21 tables permissions"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRANT USAGE ON SCHEMA ADW.unit21 TO DATA_ENGINEERING_GROUP;\n\nGRANT SELECT ON ALL TABLES IN SCHEMA ADW.unit21 TO DATA_ENGINEERING_GROUP;\n-- GRANT SELECT ON FUTURE TABLES IN SCHEMA ADW.BANK_DB TO DATA_ENGINEERING_GROUP;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959387":{"id":2959387,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":176,"y":96,"width":32,"height":32,"inputConnectorIDs":[2959381],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"external entities"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"drop table if exists unit21.external_instruments_ach;\n\ncreate table unit21.external_instruments_ach as\nwith external_bank_accounts as (\n    select NAME,\n           ROUTING_NUMBER,\n           ACCOUNT_NUMBER,\n           min(DATE_CREATED) as date_created\n    from WEB_DB.USER_PAYMENT_ACCOUNT\n    where 1 = 1\n      and name not in ('Aspiration Spend', 'Aspiration Save')\n      and USER_ID in (\n        select user_id\n        from ujc.active_customers\n        where 1 = 1\n          and INCEPTION_DATE = '2021-01-01'\n    )\n    group by NAME, ROUTING_NUMBER, ACCOUNT_NUMBER\n)\nselect\n    replace(uuid_string(), '-', '') as instrument_id,\n    NAME as entity_name,\n    ROUTING_NUMBER,\n    ACCOUNT_NUMBER,\n    date_created\nfrom external_bank_accounts;\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959390":{"id":2959390,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2959380,2959381,2959383,2959386],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2959391":{"id":2959391,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-112,"y":112,"width":32,"height":32,"inputConnectorIDs":[2959380],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"instrument mapping table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delete from unit21.instrument_mapping\nwhere INSTRUMENT_TYPE='ach'\n;\n\ninsert into unit21.instrument_mapping\n    (INSTRUMENT_ID, INSTRUMENT_TYPE, USER_ID, USER_PAYMENT_ACCOUNT_ID)\nselect\n--     count(1)\n    replace(uuid_string(), '-', '') as instrument_id,\n    'ach' as instrument_type,\n    user_id,\n    id as user_payment_account_id\nfrom WEB_DB.USER_PAYMENT_ACCOUNT\nwhere 1=1\n  and CLASS='com.aspiration.bank.UserBankAccount'\n-- limit 5\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{},"failureConnectors":{},"unconditionalConnectors":{"2959380":{"id":2959380,"sourceID":2959390,"targetID":2959391},"2959381":{"id":2959381,"sourceID":2959390,"targetID":2959387},"2959383":{"id":2959383,"sourceID":2959390,"targetID":2959385},"2959386":{"id":2959386,"sourceID":2959390,"targetID":2959384}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"Unit21_mapping","description":null,"type":"ORCHESTRATION","tag":"c04c38ba-96ec-45f0-867d-5205d811bade"}}