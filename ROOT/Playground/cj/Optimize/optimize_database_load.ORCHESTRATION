{"job":{"components":{"2958180":{"id":2958180,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":320,"y":32,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"optimize_table_load"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"optimize_table_load"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"source_database"},"2":{"slot":2,"type":"STRING","value":"${source_database}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"target_database"},"2":{"slot":2,"type":"STRING","value":"${target_database}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"target_schema"},"2":{"slot":2,"type":"STRING","value":"${target_schema}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"source_schema"},"2":{"slot":2,"type":"STRING","value":"${source_schema}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"table"},"2":{"slot":2,"type":"STRING","value":"${table}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2958198]},"2958181":{"id":2958181,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":320,"y":0,"width":32,"height":16,"inputConnectorIDs":[2958179],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Grid Iterator 0"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"table_list"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"source_schema"},"2":{"slot":2,"type":"STRING","value":"source_schema"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"table"},"2":{"slot":2,"type":"STRING","value":"table"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"source_database"},"2":{"slot":2,"type":"STRING","value":"source_database"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"target_database"},"2":{"slot":2,"type":"STRING","value":"target_database"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"target_schema"},"2":{"slot":2,"type":"STRING","value":"target_schema"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2958198],"inputIterationConnectorIDs":[]},"2958182":{"id":2958182,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-144,"y":-32,"width":32,"height":32,"inputConnectorIDs":[2958199],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Grants"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"--GRANT OWNERSHIP ON DATABASE ADW_BETA                   TO ROLE SYSADMIN REVOKE CURRENT GRANTS;\n--GRANT OWNERSHIP ON ALL SCHEMAS IN DATABASE ADW_BETA    TO ROLE SYSADMIN REVOKE CURRENT GRANTS;\n--GRANT OWNERSHIP ON FUTURE SCHEMAS IN DATABASE ADW_BETA TO ROLE SYSADMIN REVOKE CURRENT GRANTS;\n--GRANT OWNERSHIP ON ALL TABLES IN DATABASE ADW_BETA     TO ROLE SYSADMIN REVOKE CURRENT GRANTS;\n--GRANT OWNERSHIP ON FUTURE TABLES IN DATABASE ADW_BETA  TO ROLE SYSADMIN REVOKE CURRENT GRANTS;\n--GRANT OWNERSHIP ON ALL VIEWS IN DATABASE ADW_BETA      TO ROLE SYSADMIN REVOKE CURRENT GRANTS;\n--GRANT OWNERSHIP ON FUTURE VIEWS IN DATABASE ADW_BETA   TO ROLE SYSADMIN REVOKE CURRENT GRANTS;\n--GRANT USAGE ON DATABASE ADW_BETA                       TO ROLE BETA_FULLACCESS;\n--GRANT USAGE ON ALL SCHEMAS IN DATABASE ADW_BETA        TO ROLE BETA_FULLACCESS; \n--GRANT USAGE ON FUTURE SCHEMAS IN DATABASE ADW_BETA     TO ROLE BETA_FULLACCESS; \n--GRANT ALL ON ALL TABLES IN DATABASE ADW_BETA           TO ROLE BETA_FULLACCESS; \n--GRANT ALL ON FUTURE TABLES IN DATABASE ADW_BETA        TO ROLE BETA_FULLACCESS; \n--GRANT ROLE BETA_FULLACCESS                             TO ROLE DATA_ENGINEERING_GROUP;\n--GRANT ROLE BETA_FULLACCESS                             TO ROLE DATA_SCIENCE_ANALYTICS;\n--GRANT ROLE BETA_FULLACCESS                             TO ROLE SYSADMIN;\n--GRANT ROLE BETA_FULLACCESS                             TO ROLE LOOKER_ROLE;\n\nCREATE OR REPLACE VIEW ADW_BETA.PUBLIC.DATABASE_METADATA AS SELECT ROW_NUMBER() OVER (PARTITION BY DATABASE_NAME ORDER BY EST_ROWS ASC) AS PROC_ORDER, * FROM (SELECT * FROM ADW_BETA.account_approval_db.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.account_management.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.account_opening_alloy.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.account_opening_galileo.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.banking_db.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.check_deposit.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.credit_account_management.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.credit_payments.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.credit_transactions.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.impact_db.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.sweep_db.SCHEMA_METADATA UNION ALL SELECT * FROM ADW_BETA.web_db.SCHEMA_METADATA) ORDER BY LAST_UPDATE DESC, SCHEMA_NAME ASC;\nCREATE OR REPLACE VIEW ADW_BETA.PUBLIC.LOAD_METADATA AS SELECT ROW_NUMBER() OVER (PARTITION BY DATABASE_NAME ORDER BY EST_ROWS ASC) AS PROC_ORDER, * FROM (SELECT * FROM ADW_BETA.account_approval_db.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.account_management.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.account_opening_alloy.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.account_opening_galileo.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.banking_db.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.check_deposit.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.credit_account_management.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.credit_payments.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.credit_transactions.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.impact_db.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.sweep_db.LOAD_METADATA UNION ALL SELECT * FROM ADW_BETA.web_db.LOAD_METADATA) ORDER BY LAST_UPDATE DESC, SCHEMA_NAME ASC;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2958183":{"id":2958183,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-144,"y":96,"width":32,"height":32,"inputConnectorIDs":[2958197],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Force Refresh"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"USE WAREHOUSE DEV;\nCREATE OR REPLACE TABLE ${target_database}.PUBLIC.DELETE_METADATA AS\nWITH\n   CREDIT_TABLES AS (\n      SELECT DISTINCT\n             TABLE_NAME\n           , REPLACE(TABLE_NAME,'credit_','') AS ROOT_NAME\n           , DECODE(ROOT_NAME,'users','_user',ROOT_NAME) AS CORE_TABLE\n      FROM ${target_database}.PUBLIC.DATABASE_METADATA\n      WHERE SCHEMA_NAME ILIKE '%credit%'\n         OR TABLE_NAME ILIKE '%credit%'\n         OR COLUMNS ILIKE '%credit%'\n      ),\n   CORE_TABLES AS (\n      SELECT META.TABLE_NAME\n      FROM ${target_database}.PUBLIC.DATABASE_METADATA META\n      JOIN CREDIT_TABLES ON CREDIT_TABLES.CORE_TABLE = META.TABLE_NAME\n      ),\n   STALE_TABLES AS (\n      SELECT META.TABLE_NAME\n      FROM ${target_database}.PUBLIC.DATABASE_METADATA META\n      WHERE LAST_UPDATE < (CURRENT_DATE-5)\n     \tAND DAYOFWEEK(CURRENT_DATE) = 7\n      )\nSELECT DISTINCT TABLE_NAME FROM CREDIT_TABLES\nUNION\nSELECT DISTINCT TABLE_NAME FROM CORE_TABLES\nUNION\nSELECT DISTINCT TABLE_NAME FROM STALE_TABLES\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2958184":{"id":2958184,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-144,"y":32,"width":32,"height":32,"inputConnectorIDs":[2958196],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2958197,2958199],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Execute"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"/*\nCREATE OR REPLACE ${target_database}.PUBLIC.DATABASE_METADATA (\n  DATABASE_NAME\tVARCHAR(16777216),\n  SCHEMA_NAME\tVARCHAR(16777216),\n  TABLE_NAME\tVARCHAR(16777216),\n  COLUMNS\t\tVARCHAR(16777216),\n  DIFF_ID\t\tVARCHAR(16777216),\n  LAST_UPDATE\tDATE\n  );\n*/\n\n\ndrop table adw_beta.account_approval_db.schema_metadata;\ndrop table adw_beta.account_management.schema_metadata;\ndrop table adw_beta.account_opening_alloy.schema_metadata;\ndrop table adw_beta.account_opening_galileo.schema_metadata;\ndrop table adw_beta.banking_db.schema_metadata;\ndrop table adw_beta.check_deposit.schema_metadata;\ndrop table adw_beta.credit_account_management.schema_metadata;\ndrop table adw_beta.credit_payments.schema_metadata;\ndrop table adw_beta.credit_transactions.schema_metadata;\ndrop table adw_beta.impact_db.schema_metadata;\ndrop table adw_beta.sweep_db.schema_metadata;\ndrop table adw_beta.web_db.schema_metadata;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2958185":{"id":2958185,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":240,"y":0,"width":32,"height":32,"inputConnectorIDs":[2958178],"outputSuccessConnectorIDs":[2958179],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Query Result To Grid 0"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT DATABASE_NAME AS SOURCE_DATABASE\n\t , SCHEMA_NAME AS SOURCE_SCHEMA\n     , TABLE_NAME\n     , '${target_database}' AS TARGET_DATABASE\n     , DATABASE_NAME AS TARGET_SCHEMA\nFROM ${target_database}.PUBLIC.LOAD_METADATA\nORDER BY PROC_ORDER ASC, EST_ROWS ASC"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"table_list"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE_DATABASE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE_SCHEMA"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"TABLE_NAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"TARGET_DATABASE"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"TARGET_SCHEMA"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2958186":{"id":2958186,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-80,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2958196,2958200],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2958187":{"id":2958187,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":0,"y":0,"width":32,"height":16,"inputConnectorIDs":[2958200],"outputSuccessConnectorIDs":[2958177],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Grid Iterator 0"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"database_list"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"source_database"},"2":{"slot":2,"type":"STRING","value":"source_database"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2958190":{"id":2958190,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":160,"y":0,"width":32,"height":32,"inputConnectorIDs":[2958176],"outputSuccessConnectorIDs":[2958178],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"View"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"USE WAREHOUSE DEV;\n${sqlview_database};\n${sqlview_loading};"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2958191":{"id":2958191,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":80,"y":0,"width":32,"height":32,"inputConnectorIDs":[2958177],"outputSuccessConnectorIDs":[2958176],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\ndblist     = [str(db[0]) for db in context.getGridVariable('database_list')]\n\nsqlview_database = 'CREATE OR REPLACE VIEW ${target_database}.PUBLIC.DATABASE_METADATA AS '\nsqlview_loading  = 'CREATE OR REPLACE VIEW ${target_database}.PUBLIC.LOAD_METADATA AS '\nsql_prefix = 'SELECT ROW_NUMBER() OVER (PARTITION BY DATABASE_NAME ORDER BY EST_ROWS ASC) AS PROC_ORDER, * FROM ('\nsql_select = '  SELECT * FROM '\nsql_union  = ' UNION ALL '\nsql_suffix = ') ORDER BY LAST_UPDATE DESC, SCHEMA_NAME ASC'\n\ndef sql_string(x,y):\n  return 'SELECT * FROM ${target_database}.' + x + '.' + y\n\nsqlview_database = sqlview_database + sql_prefix + sql_union.join(map(sql_string,dblist,['SCHEMA_METADATA']*len(dblist))) + sql_suffix\nsqlview_loading  = sqlview_loading  + sql_prefix + sql_union.join(map(sql_string,dblist,['LOAD_METADATA']*len(dblist)))   + sql_suffix\nprint(sqlview_database)\nprint(sqlview_loading)\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2958176":{"id":2958176,"sourceID":2958191,"targetID":2958190},"2958177":{"id":2958177,"sourceID":2958187,"targetID":2958191},"2958178":{"id":2958178,"sourceID":2958190,"targetID":2958185},"2958179":{"id":2958179,"sourceID":2958185,"targetID":2958181}},"failureConnectors":{},"unconditionalConnectors":{"2958196":{"id":2958196,"sourceID":2958186,"targetID":2958184},"2958197":{"id":2958197,"sourceID":2958184,"targetID":2958183},"2958199":{"id":2958199,"sourceID":2958184,"targetID":2958182},"2958200":{"id":2958200,"sourceID":2958186,"targetID":2958187}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"2958198":{"id":2958198,"sourceID":2958181,"targetID":2958180}},"noteConnectors":{},"notes":{},"variables":{"source_database":{"definition":{"name":"source_database","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"source_schema":{"definition":{"name":"source_schema","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"sqlview_database":{"definition":{"name":"sqlview_database","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"sqlview_loading":{"definition":{"name":"sqlview_loading","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"table":{"definition":{"name":"table","type":"TEXT","scope":"BRANCH","description":"Public","visibility":"PUBLIC"},"value":""},"target_database":{"definition":{"name":"target_database","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ADW_BETA"},"target_schema":{"definition":{"name":"target_schema","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""}},"grids":{"database_list":{"definition":{"name":"database_list","scope":"BRANCH","definitions":[{"name":"source_database","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["account_approval_db"]},{"values":["account_management"]},{"values":["account_opening_alloy"]},{"values":["account_opening_galileo"]},{"values":["banking_db"]},{"values":["check_deposit"]},{"values":["credit_account_management"]},{"values":["credit_payments"]},{"values":["credit_transactions"]},{"values":["impact_db"]},{"values":["sweep_db"]},{"values":["web_db"]}]},"table_list":{"definition":{"name":"table_list","scope":"BRANCH","definitions":[{"name":"source_database","type":"TEXT"},{"name":"source_schema","type":"TEXT"},{"name":"table","type":"TEXT"},{"name":"target_database","type":"TEXT"},{"name":"target_schema","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["web_db","public","user_profile","ADW_DEV","PUBLIC"]},{"values":["web_db","public","company","ADW_DEV","PUBLIC"]}]}}},"info":{"name":"optimize_database_load","description":"","type":"ORCHESTRATION","tag":"dd60aadc-6c14-45f9-8772-b5847143e12c"}}