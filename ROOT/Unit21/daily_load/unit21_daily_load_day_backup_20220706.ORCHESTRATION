{"job":{"components":{"2966912":{"id":2966912,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-304,"y":144,"width":32,"height":32,"inputConnectorIDs":[2966930],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of fix permission"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRANT USAGE ON SCHEMA ADW.UNIT21 TO DATA_ENGINEERING_GROUP;\n\nGRANT SELECT ON ALL TABLES IN SCHEMA ADW.UNIT21 TO DATA_ENGINEERING_GROUP;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966913":{"id":2966913,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":208,"y":448,"width":32,"height":32,"inputConnectorIDs":[2966935],"outputSuccessConnectorIDs":[2966905],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"extract wire txns"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use warehouse unit_21;\n\n\ncreate or replace file format UNIT21_JSON_FORMAT \n  type = 'JSON'\n  comment = 'JSON format for unit21 export files'\n;\n\n\ncopy into ${unit21_s3_staging_folder}/${file_date}/wire_transaction_extract_daily_${file_date}_seq_${sequence_number}.json\nfrom (\n\nselect\narray_agg(objs) from (\n        select\n            object_construct(\n                'general_data', object_construct(\n                    'event_id', 'p' || pt.ID,\n                    'event_type', 'transaction',\n                    'event_subtype', gl.DESCRIPTION,\n                    'event_time', DATE_PART(EPOCH_SECOND, pt.TRANSACTION_DATE::timestamp),\n                    'status', 'complete'\n                ),\n                'custom_data', object_construct(\n                    'description', replace(pt.DESCRIPTION, ':', ','),\n                    'post_date', pt.POST_DATE\n                ),\n                'transaction_data',\n                    case when amount < 0 then\n                        object_construct(\n                            'sent_amount', -pt.AMOUNT,\n                            'sender_entity_id', u.UUID,\n                            'sender_entity_type', 'user',\n                            'sender_source', 'internal',\n                            'sender_instrument_id', upa.ACCOUNT_NUMBER,\n--                             'received_amount', -ddt.AMOUNT,\n--                             'receiver_entity_id', ee.external_entity_id,\n--                             'receiver_entity_type', 'business',\n--                             'receiver_source', 'external',\n                            'amount', -pt.AMOUNT\n                        )\n                    else object_construct(\n                            'received_amount', pt.AMOUNT,\n                            'receiver_entity_id', u.UUID,\n                            'receiver_entity_type', 'user',\n                            'receiver_source', 'internal',\n                            'receiver_instrument_id', upa.ACCOUNT_NUMBER,\n--                             'sent_amount', ddt.AMOUNT,\n--                             'sender_entity_id', ee.external_entity_id,\n--                             'sender_entity_type', 'business',\n--                             'sender_source', 'external',\n                            'amount', pt.AMOUNT\n                        )\n                    end\n            ) as objs\n        from WEB_DB.GALILEO_POSTED_TRANSACTION gpt\n        join WEB_DB.POSTED_TRANSACTION pt on gpt.POSTED_TRANSACTION_ID = pt.ID\n        join WEB_DB.DEPOSITORY d on pt.DEPOSITORY_ID = d.ID\n        join WEB_DB.USER_ACCOUNT ua on d.ACCOUNT_ID=ua.ACCOUNT_ID\n        join WEB_DB.USER_PAYMENT_ACCOUNT upa on d.ID = upa.DEPOSITORY_ID\n        join WEB_DB._USER u on ua.USER_ID=u.id\n        JOIN web_db.galileo_lookup gl\n          ON (gl.code = gpt.transaction_code_type AND gl.file = 'P' AND gl.field_name = 'TRANSACTION CODE/TYPE')\n        join unit21.INSTRUMENT_TRANSACTION_TYPE_MAPPING ittm on ittm.ASPIRATION_TRANSACTION_TYPE=gl.DESCRIPTION\n--         join unit21.instrument_mapping im on im.INSTRUMENT_TYPE=ittm.INSTRUMENT and im.user_id=ua.USER_ID\n        where 1=1\n--           and u.UUID='df0c40c91dc645b0a06c266c247f8448'\n--           and u.id in (605772, 1111966)\n\n--           and ua.USER_ID=2192747    -- debit card test user\n          and ittm.INSTRUMENT='wire'\n          and pt.POST_DATE='${current_year}-${current_month}-${current_day}'\n\n    )\n\n)\nfile_format = (format_name = UNIT21_JSON_FORMAT, compression = NONE)\nSINGLE=true\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966914":{"id":2966914,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":208,"y":112,"width":32,"height":32,"inputConnectorIDs":[2966929],"outputSuccessConnectorIDs":[2966928],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert debit card txns pagination table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delete from unit21.txn_pagination\nwhere 1=1\n  and post_date='${current_year}-${current_month}-${current_day}'\n  and INSTRUMENT='debit_card'\n;\n\ninsert into unit21.txn_pagination\n(POSTED_TRANSACTION_ID, POST_DATE, PAGE_NUMBER, INSTRUMENT)\nwith a as (\n    select pt.id,\n           pt.POST_DATE,\n           row_number() over (order by pt.ID)    as row_num,\n           ceil(row_num / 20000)                 as page_number\n        from WEB_DB.GALILEO_POSTED_TRANSACTION gpt\n        join WEB_DB.POSTED_TRANSACTION pt on gpt.POSTED_TRANSACTION_ID = pt.ID\n        join WEB_DB.DEPOSITORY d on pt.DEPOSITORY_ID = d.ID\n        JOIN web_db.galileo_lookup gl\n          ON (gl.code = gpt.transaction_code_type AND gl.file = 'P' AND gl.field_name = 'TRANSACTION CODE/TYPE')\n        join unit21.INSTRUMENT_TRANSACTION_TYPE_MAPPING ittm on ittm.ASPIRATION_TRANSACTION_TYPE=gl.DESCRIPTION\n    where 1 = 1\n      and pt.POST_DATE = '${current_year}-${current_month}-${current_day}'\n      and ittm.INSTRUMENT='debit_card'\n)\nselect \n    id,\n    POST_DATE,\n    page_number,\n    'debit_card'\nfrom a\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966915":{"id":2966915,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-208,"y":96,"width":32,"height":32,"inputConnectorIDs":[2966957],"outputSuccessConnectorIDs":[2966930],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"adhoc"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create table unit21.entity_pagination (\n  USER_ID numeric(38),\n  POST_DATE date,\n  PAGE_NUMBER INTEGER,\n  etl_load_date timestamp_tz default current_timestamp not null\n)\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966916":{"id":2966916,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":0,"y":448,"width":32,"height":32,"inputConnectorIDs":[2966906],"outputSuccessConnectorIDs":[2966935],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"extract ach transfer txns - external originated"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use warehouse unit_21;\n\n\ncreate or replace file format UNIT21_JSON_FORMAT \n  type = 'JSON'\n  comment = 'JSON format for unit21 export files'\n;\n\n\ncopy into ${unit21_s3_staging_folder}/${file_date}/ach_transaction_external_extract_daily_${file_date}_seq_${sequence_number}.json\nfrom (\n\nselect\narray_agg(objs) from (\n        select\n            object_construct(\n                'general_data', object_construct(\n                    'event_id', 'p' || pt.ID,\n                    'event_type', 'transaction',\n                    'event_subtype', gl.DESCRIPTION,\n                    'event_time', DATE_PART(EPOCH_SECOND, pt.TRANSACTION_DATE::timestamp),\n                    'status', 'complete'\n                ),\n                'custom_data', object_construct(\n                    'description', replace(pt.DESCRIPTION, ':', ','),\n                    'post_date', pt.POST_DATE\n                ),\n                'transaction_data',\n                    case when pt.amount < 0 then\n                        object_construct(\n--                             'sent_amount', -ddt.AMOUNT,\n                            'sender_entity_id', u.UUID,\n                            'sender_entity_type', 'user',\n                            'sender_source', 'internal',\n                            'sender_instrument_id', upa.ACCOUNT_NUMBER,\n--                             'received_amount', -ddt.AMOUNT,\n--                             'receiver_entity_id', eea.external_entity_id,\n--                             'receiver_entity_type', 'business',\n--                             'receiver_source', 'external',\n--                             'receiver_instrument_id', eia.INSTRUMENT_ID,\n                            'amount', -pt.AMOUNT\n                        )\n                    else object_construct(\n--                             'received_amount', ddt.AMOUNT,\n                            'receiver_entity_id', u.UUID,\n                            'receiver_entity_type', 'user',\n                            'receiver_source', 'internal',\n                            'receiver_instrument_id', upa.ACCOUNT_NUMBER,\n--                             'sent_amount', ddt.AMOUNT,\n--                             'sender_entity_id', eea.external_entity_id,\n--                             'sender_entity_type', 'business',\n--                             'sender_source', 'external',\n--                             'sender_instrument_id', eia.INSTRUMENT_ID,\n                            'amount', pt.AMOUNT\n                        )\n                    end\n            ) as objs\n        from WEB_DB.GALILEO_POSTED_TRANSACTION gpt\n        join WEB_DB.POSTED_TRANSACTION pt on gpt.POSTED_TRANSACTION_ID = pt.ID\n        join WEB_DB.DEPOSITORY d on pt.DEPOSITORY_ID = d.ID\n        join WEB_DB.USER_ACCOUNT ua on d.ACCOUNT_ID=ua.ACCOUNT_ID\n        join WEB_DB.USER_PAYMENT_ACCOUNT upa on d.ID = upa.DEPOSITORY_ID\n        join WEB_DB._USER u on ua.USER_ID=u.id\n        JOIN web_db.galileo_lookup gl\n          ON (gl.code = gpt.transaction_code_type AND gl.file = 'P' AND gl.field_name = 'TRANSACTION CODE/TYPE')\n        join unit21.INSTRUMENT_TRANSACTION_TYPE_MAPPING ittm on ittm.ASPIRATION_TRANSACTION_TYPE=gl.DESCRIPTION\n        where 1=1\n          and ittm.INSTRUMENT='ach'\n--           and im.USER_PAYMENT_ACCOUNT_ID is null\n          and gl.DESCRIPTION in ('Coastal ACH Debit', 'Coastal ACH Deposit')\n          and pt.POST_DATE='${current_year}-${current_month}-${current_day}'\n\n    )\n\n)\nfile_format = (format_name = UNIT21_JSON_FORMAT, compression = NONE)\nSINGLE=true\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966917":{"id":2966917,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":784,"y":528,"width":32,"height":32,"inputConnectorIDs":[2966909],"outputSuccessConnectorIDs":[2966903],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"extract ach txns - internal originated"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use warehouse unit_21;\n\n\ncreate or replace file format UNIT21_JSON_FORMAT \n  type = 'JSON'\n  comment = 'JSON format for unit21 export files'\n;\n\n\ncopy into ${unit21_s3_staging_folder}/${file_date}/ach_transaction_internal_extract_daily_${file_date}_seq_${sequence_number}.json\nfrom (\n\nselect\narray_agg(objs) from (\n        select\n            object_construct(\n                'general_data', object_construct(\n                    'event_id', 'p' || pt.id,\n                    'event_type', 'transaction',\n                    'event_subtype', gl.DESCRIPTION,\n                    'event_time', DATE_PART(EPOCH_SECOND, pt.TRANSACTION_DATE::timestamp),\n                    'status', 'complete'\n                ),\n                'custom_data', object_construct(\n                    'description', replace(pt.DESCRIPTION, ':', ','),\n                    'post_date', pt.POST_DATE\n                ),\n                'transaction_data',\n                    case when pt.amount < 0 then\n                        object_construct(\n                            'sender_entity_id', u.UUID,\n                            'sender_entity_type', 'user',\n                            'sender_source', 'internal',\n                            'sender_instrument_id', upa.ACCOUNT_NUMBER,\n                            'receiver_entity_id', eea.external_entity_id,\n                            'receiver_entity_type', 'business',\n                            'receiver_source', 'external',\n                            'receiver_instrument_id', eia.INSTRUMENT_ID,\n                            'amount', -pt.AMOUNT\n                        )\n                    else object_construct(\n--                             'received_amount', ddt.AMOUNT,\n                            'receiver_entity_id', u.UUID,\n                            'receiver_entity_type', 'user',\n                            'receiver_source', 'internal',\n                            'receiver_instrument_id', upa.ACCOUNT_NUMBER,\n                            'sender_entity_id', eea.external_entity_id,\n                            'sender_entity_type', 'business',\n                            'sender_source', 'external',\n                            'sender_instrument_id', eia.INSTRUMENT_ID,\n                            'amount', pt.AMOUNT\n                        )\n                    end\n            ) as objs\n        from WEB_DB.GALILEO_POSTED_TRANSACTION gpt\n        join WEB_DB.POSTED_TRANSACTION pt on gpt.POSTED_TRANSACTION_ID = pt.ID\n        join WEB_DB.DEPOSITORY d on pt.DEPOSITORY_ID = d.ID\n        join WEB_DB.USER_ACCOUNT ua on d.ACCOUNT_ID=ua.ACCOUNT_ID\n        join WEB_DB.USER_PAYMENT_ACCOUNT upa on d.ID = upa.DEPOSITORY_ID\n        join WEB_DB._USER u on ua.USER_ID=u.id\n        JOIN web_db.galileo_lookup gl\n          ON (gl.code = gpt.transaction_code_type AND gl.file = 'P' AND gl.field_name = 'TRANSACTION CODE/TYPE')\n        join unit21.INSTRUMENT_TRANSACTION_TYPE_MAPPING ittm on ittm.ASPIRATION_TRANSACTION_TYPE=gl.DESCRIPTION\n\n        -- join to linked bank accounts\n        join WEB_DB.GALILEO_ACH_TRANSACTION gat on gpt.EXTERNAL_TRANSACTION_ID=gat.TRANSACTION_ID\n        join WEB_DB.USER_PAYMENT_ACCOUNT upa1 on gat.USER_PAYMENT_ACCOUNT_ID = upa1.ID\n        join unit21.EXTERNAL_ENTITIES_ACH eea on upa1.NAME=eea.ENTITY_NAME\n        join unit21.EXTERNAL_INSTRUMENTS_ACH eia on upa1.NAME=eia.ENTITY_NAME\n                                                and upa1.ROUTING_NUMBER=eia.ROUTING_NUMBER\n                                                and upa1.ACCOUNT_NUMBER=eia.ACCOUNT_NUMBER\n        where 1=1\n          and ittm.INSTRUMENT='ach'\n--           and im.user_payment_account_id is null\n          and ittm.ASPIRATION_TRANSACTION_TYPE in ('E-Check', 'Money Transfer')     -- ach transfer (internal)\n          and pt.POST_DATE='${current_year}-${current_month}-${current_day}'\n          -- and u.id=916152\n\n    )\n)\nfile_format = (format_name = UNIT21_JSON_FORMAT, compression = NONE)\nSINGLE=true\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966918":{"id":2966918,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":208,"y":272,"width":32,"height":32,"inputConnectorIDs":[2966905],"outputSuccessConnectorIDs":[2966929],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"extract check txns"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use warehouse unit_21;\n\n\ncreate or replace file format UNIT21_JSON_FORMAT \n  type = 'JSON'\n  comment = 'JSON format for unit21 export files'\n;\n\n\ncopy into ${unit21_s3_staging_folder}/${file_date}/check_transaction_extract_daily_${file_date}_seq_${sequence_number}.json\nfrom (\n\nselect\narray_agg(objs) from (\n        select\n            object_construct(\n                'general_data', object_construct(\n                    'event_id', 'p' || pt.ID,\n                    'event_type', 'transaction',\n                    'event_subtype', gl.DESCRIPTION,\n                    'event_time', DATE_PART(EPOCH_SECOND, pt.TRANSACTION_DATE::timestamp),\n                    'status', 'complete'\n                ),\n                'custom_data', object_construct(\n                    'description', replace(pt.DESCRIPTION, ':', ','),\n                    'post_date', pt.POST_DATE\n                ),\n                'transaction_data',\n                    case when amount < 0 then\n                        object_construct(\n                            'sent_amount', -pt.AMOUNT,\n                            'sender_entity_id', u.UUID,\n                            'sender_entity_type', 'user',\n                            'sender_source', 'internal',\n                            'sender_instrument_id', upa.ACCOUNT_NUMBER,\n--                             'received_amount', -ddt.AMOUNT,\n--                             'receiver_entity_id', ee.external_entity_id,\n--                             'receiver_entity_type', 'business',\n--                             'receiver_source', 'external',\n                            'amount', -pt.AMOUNT\n                        )\n                    else object_construct(\n                            'received_amount', pt.AMOUNT,\n                            'receiver_entity_id', u.UUID,\n                            'receiver_entity_type', 'user',\n                            'receiver_source', 'internal',\n                            'receiver_instrument_id', upa.ACCOUNT_NUMBER,\n--                             'sent_amount', ddt.AMOUNT,\n--                             'sender_entity_id', ee.external_entity_id,\n--                             'sender_entity_type', 'business',\n--                             'sender_source', 'external',\n                            'amount', pt.AMOUNT\n                        )\n                    end\n            ) as objs\n        from WEB_DB.GALILEO_POSTED_TRANSACTION gpt\n        join WEB_DB.POSTED_TRANSACTION pt on gpt.POSTED_TRANSACTION_ID = pt.ID\n        join WEB_DB.DEPOSITORY d on pt.DEPOSITORY_ID = d.ID\n        join WEB_DB.USER_ACCOUNT ua on d.ACCOUNT_ID=ua.ACCOUNT_ID\n        join WEB_DB.USER_PAYMENT_ACCOUNT upa on d.ID = upa.DEPOSITORY_ID\n        join WEB_DB._USER u on ua.USER_ID=u.id\n        JOIN web_db.galileo_lookup gl\n          ON (gl.code = gpt.transaction_code_type AND gl.file = 'P' AND gl.field_name = 'TRANSACTION CODE/TYPE')\n        join unit21.INSTRUMENT_TRANSACTION_TYPE_MAPPING ittm on ittm.ASPIRATION_TRANSACTION_TYPE=gl.DESCRIPTION\n--         join unit21.instrument_mapping im on im.INSTRUMENT_TYPE=ittm.INSTRUMENT and im.user_id=ua.USER_ID\n        where 1=1\n--           and u.UUID='df0c40c91dc645b0a06c266c247f8448'\n--           and u.id in (605772, 1111966)\n\n--           and ua.USER_ID=2192747    -- debit card test user\n          and ittm.INSTRUMENT='check'\n          and pt.POST_DATE='${current_year}-${current_month}-${current_day}'\n\n    )\n\n)\nfile_format = (format_name = UNIT21_JSON_FORMAT, compression = NONE)\nSINGLE=true\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966919":{"id":2966919,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":0,"y":240,"width":32,"height":32,"inputConnectorIDs":[2966908],"outputSuccessConnectorIDs":[2966911],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"extract internal instrument"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use warehouse unit_21;\n\n\ncreate or replace file format UNIT21_JSON_FORMAT \n  type = 'JSON'\n  comment = 'JSON format for unit21 export files'\n;\n\n\ncopy into ${unit21_s3_staging_folder}/${file_date}/internal_instrument_extract_daily_${file_date}_seq_${sequence_number}.json\nfrom (\n\nwith entity_data as (\n    select u.id                as user_id,\n           array_agg(\n                   object_construct(\n                           'entity_id', u.UUID,\n                           'entity_type', 'user'\n                       )\n               )               as entity_json,\n           min(u.DATE_CREATED) as DATE_CREATED\n    from WEB_DB._USER u\n    where 1 = 1\n--       and u.id = 2192747\n    group by u.id\n)\nselect\narray_agg(objs) from (\n        select\n            object_construct(\n                'instrument_id', upa.ACCOUNT_NUMBER,\n                'instrument_type', upa.NAME,\n                'source', 'internal',\n                'status', 'active',\n                'registered_at', DATE_PART(EPOCH_SECOND, CONVERT_TIMEZONE('America/Los_Angeles', 'UTC', upa.DATE_CREATED::timestamp )),\n                'entities', ed.entity_json\n            ) as objs\n        from WEB_DB.USER_PAYMENT_ACCOUNT upa\n        join WEB_DB.USER_PROFILE up on upa.USER_ID=up.USER_ID\n        left join entity_data ed on upa.USER_ID=ed.user_id\n        where 1=1\n          and upa.DEPOSITORY_ID is not null\n          and upa.name in ('Aspiration Spend', 'Aspiration Save')\n          and date_trunc('day',up.DATE_CREATED)='${current_year}-${current_month}-${current_day}'\n\n\n    )\n\n)\nfile_format = (format_name = UNIT21_JSON_FORMAT, compression = NONE)\nSINGLE=true\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966920":{"id":2966920,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":784,"y":416,"width":32,"height":32,"inputConnectorIDs":[2966904],"outputSuccessConnectorIDs":[2966909],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"extract external instruments - ach txns internal"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use warehouse unit_21;\n\n\ncreate or replace file format UNIT21_JSON_FORMAT \n  type = 'JSON'\n  comment = 'JSON format for unit21 export files'\n;\n\n\ncopy into ${unit21_s3_staging_folder}/${file_date}/external_instrument_ach_extract_daily_${file_date}_seq_${sequence_number}.json\nfrom (\n\nwith user_ids as (\n        select\n            upa.USER_ID\n        from WEB_DB.GALILEO_POSTED_TRANSACTION gpt\n        join WEB_DB.POSTED_TRANSACTION pt on gpt.POSTED_TRANSACTION_ID = pt.ID\n        join WEB_DB.USER_PAYMENT_ACCOUNT upa on pt.DEPOSITORY_ID = upa.DEPOSITORY_ID\n        JOIN web_db.galileo_lookup gl\n          ON (gl.code = gpt.transaction_code_type AND gl.file = 'P' AND gl.field_name = 'TRANSACTION CODE/TYPE')\n        join unit21.INSTRUMENT_TRANSACTION_TYPE_MAPPING ittm on ittm.ASPIRATION_TRANSACTION_TYPE=gl.DESCRIPTION\n        where 1=1\n          and ittm.INSTRUMENT='ach'\n          and ittm.ASPIRATION_TRANSACTION_TYPE in ('E-Check', 'Money Transfer')     -- ach transfer (internal)\n          and pt.POST_DATE='${current_year}-${current_month}-${current_day}'\n          -- and upa.USER_ID=916152\n        )\n, entity_data as (\n    select eea.ENTITY_NAME,\n           array_agg(\n                   object_construct(\n                           'entity_id', eea.EXTERNAL_ENTITY_ID,\n                           'entity_type', 'business'\n                       )\n               )               as entity_json\n    from unit21.EXTERNAL_ENTITIES_ACH eea\n    where 1 = 1\n    group by eea.ENTITY_NAME\n)\n\nselect\narray_agg(objs) from (\n        select\n            object_construct(\n                'instrument_id', eia.INSTRUMENT_ID,\n                'instrument_type', 'ach',\n                'source', 'external',\n                'status', 'active',\n                'registered_at', DATE_PART(EPOCH_SECOND, eia.DATE_CREATED),\n                'entities', ed.entity_json,\n                'custom_data', object_construct(\n                   'routing_number', upa.ROUTING_NUMBER,\n                   'account_number', upa.ACCOUNT_NUMBER\n                   )\n            ) as objs\n        from unit21.external_instruments_ach eia\n        join entity_data ed on eia.ENTITY_NAME=ed.ENTITY_NAME\n        join WEB_DB.USER_PAYMENT_ACCOUNT upa on upa.NAME=eia.ENTITY_NAME and upa.ROUTING_NUMBER=eia.ROUTING_NUMBER and upa.ACCOUNT_NUMBER=eia.ACCOUNT_NUMBER\n        where 1=1\n          and upa.USER_ID in (\n              select USER_ID from user_ids\n            )\n    )\n\n)\nfile_format = (format_name = UNIT21_JSON_FORMAT, compression = NONE)\nSINGLE=true\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966921":{"id":2966921,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":560,"y":288,"width":32,"height":32,"inputConnectorIDs":[2966901],"outputSuccessConnectorIDs":[2966910],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert external entities - ach txns internal"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use warehouse unit_21;\n\n\ninsert into UNIT21.EXTERNAL_ENTITIES_ACH\n(EXTERNAL_ENTITY_ID, ENTITY_NAME)\nwith user_ids as (\n(\n        select\n            distinct upa.USER_ID\n        from WEB_DB.GALILEO_POSTED_TRANSACTION gpt\n        join WEB_DB.POSTED_TRANSACTION pt on gpt.POSTED_TRANSACTION_ID = pt.ID\n        join WEB_DB.USER_PAYMENT_ACCOUNT upa on pt.DEPOSITORY_ID = upa.DEPOSITORY_ID\n        JOIN web_db.galileo_lookup gl\n          ON (gl.code = gpt.transaction_code_type AND gl.file = 'P' AND gl.field_name = 'TRANSACTION CODE/TYPE')\n        join unit21.INSTRUMENT_TRANSACTION_TYPE_MAPPING ittm on ittm.ASPIRATION_TRANSACTION_TYPE=gl.DESCRIPTION\n        where 1=1\n          and ittm.INSTRUMENT='ach'\n          and ittm.ASPIRATION_TRANSACTION_TYPE in ('E-Check', 'Money Transfer')     -- ach transfer (internal)\n          and pt.POST_DATE='${current_year}-${current_month}-${current_day}'\n        )\n)\n, bank_names as (\n    select distinct upa.NAME\n    from WEB_DB.USER_PAYMENT_ACCOUNT upa\n--     join WEB_DB.USER_PROFILE up on upa.USER_ID=up.USER_ID\n    where 1=1\n      and upa.DEPOSITORY_ID is null\n      and upa.CLASS='com.aspiration.bank.UserBankAccount'\n--       and up.DATE_CREATED < '2021-06-19'\n--       and date_trunc('year',up.DATE_CREATED)='2014-01-01'\n--       and USER_ID=916152\n      and upa.USER_ID in (\n          select USER_ID from user_ids\n        )\n)\nselect\n    replace(uuid_string(), '-', '') as external_entity_id,\n    NAME as entity_name\nfrom bank_names\nwhere 1=1\n  and NAME not in (\n      select ENTITY_NAME\n      from UNIT21.EXTERNAL_ENTITIES_ACH\n    )\n\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966922":{"id":2966922,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":944,"y":560,"width":32,"height":32,"inputConnectorIDs":[2966903],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"unit21_upload_file_list"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"unit21_upload_file_list"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"filedate"},"2":{"slot":2,"type":"STRING","value":"${file_date}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"sequence_number"},"2":{"slot":2,"type":"STRING","value":"${sequence_number}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966923":{"id":2966923,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":560,"y":400,"width":32,"height":32,"inputConnectorIDs":[2966931],"outputSuccessConnectorIDs":[2966904],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert external instruments - ach txns internal"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use warehouse unit_21;\n\ninsert into unit21.EXTERNAL_INSTRUMENTS_ACH\n(INSTRUMENT_ID, ENTITY_NAME, ROUTING_NUMBER, ACCOUNT_NUMBER, DATE_CREATED)\n\nwith user_ids as (\n        select\n            upa.USER_ID\n        from WEB_DB.GALILEO_POSTED_TRANSACTION gpt\n        join WEB_DB.POSTED_TRANSACTION pt on gpt.POSTED_TRANSACTION_ID = pt.ID\n        join WEB_DB.USER_PAYMENT_ACCOUNT upa on pt.DEPOSITORY_ID = upa.DEPOSITORY_ID\n        JOIN web_db.galileo_lookup gl\n          ON (gl.code = gpt.transaction_code_type AND gl.file = 'P' AND gl.field_name = 'TRANSACTION CODE/TYPE')\n        join unit21.INSTRUMENT_TRANSACTION_TYPE_MAPPING ittm on ittm.ASPIRATION_TRANSACTION_TYPE=gl.DESCRIPTION\n        where 1=1\n          and ittm.INSTRUMENT='ach'\n          and ittm.ASPIRATION_TRANSACTION_TYPE in ('E-Check', 'Money Transfer')     -- ach transfer (internal)\n          and pt.POST_DATE='${current_year}-${current_month}-${current_day}'\n          -- and upa.USER_ID=916152\n        )\n, external_bank_accounts as (\n    select NAME,\n           ROUTING_NUMBER,\n           ACCOUNT_NUMBER,\n           min(DATE_CREATED) as date_created\n    from WEB_DB.USER_PAYMENT_ACCOUNT\n    where 1 = 1\n      and name not in ('Aspiration Spend', 'Aspiration Save')\n      and DEPOSITORY_ID is null\n      and CLASS='com.aspiration.bank.UserBankAccount'\n      and USER_ID in (\n          select USER_ID from user_ids\n        )\n    group by NAME, ROUTING_NUMBER, ACCOUNT_NUMBER\n)\nselect\n    replace(uuid_string(), '-', '') as instrument_id,\n    eba.NAME as entity_name,\n    eba.ROUTING_NUMBER,\n    eba.ACCOUNT_NUMBER,\n    eba.date_created\nfrom external_bank_accounts eba\nleft join unit21.EXTERNAL_INSTRUMENTS_ACH eia on eia.ENTITY_NAME=eba.NAME\n    and eia.ROUTING_NUMBER=eba.ROUTING_NUMBER\n    and eia.ACCOUNT_NUMBER=eba.ACCOUNT_NUMBER\nwhere 1=1\n  and eia.ENTITY_NAME is null\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966924":{"id":2966924,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":400,"y":240,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"extract_debit_card_txns_page"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"extract_debit_card_txns_page"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"current_page_number"},"2":{"slot":2,"type":"STRING","value":"${current_page_number}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"current_post_date"},"2":{"slot":2,"type":"STRING","value":"${current_post_date}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"sequence_number"},"2":{"slot":2,"type":"STRING","value":"${sequence_number}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2966958]},"2966925":{"id":2966925,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2966956,2966957],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966926":{"id":2966926,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":784,"y":304,"width":32,"height":32,"inputConnectorIDs":[2966910],"outputSuccessConnectorIDs":[2966931],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"extract external entities - ach txns internal"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use warehouse unit_21;\n\n\ncreate or replace file format UNIT21_JSON_FORMAT \n  type = 'JSON'\n  comment = 'JSON format for unit21 export files'\n;\n\n\ncopy into ${unit21_s3_staging_folder}/${file_date}/external_entity_ach_extract_daily_${file_date}_seq_${sequence_number}.json\nfrom (\n\nwith user_ids as (\n        select\n            upa.USER_ID\n        from WEB_DB.GALILEO_POSTED_TRANSACTION gpt\n        join WEB_DB.POSTED_TRANSACTION pt on gpt.POSTED_TRANSACTION_ID = pt.ID\n        join WEB_DB.USER_PAYMENT_ACCOUNT upa on pt.DEPOSITORY_ID = upa.DEPOSITORY_ID\n        JOIN web_db.galileo_lookup gl\n          ON (gl.code = gpt.transaction_code_type AND gl.file = 'P' AND gl.field_name = 'TRANSACTION CODE/TYPE')\n        join unit21.INSTRUMENT_TRANSACTION_TYPE_MAPPING ittm on ittm.ASPIRATION_TRANSACTION_TYPE=gl.DESCRIPTION\n        where 1=1\n          and ittm.INSTRUMENT='ach'\n          and ittm.ASPIRATION_TRANSACTION_TYPE in ('E-Check', 'Money Transfer')     -- ach transfer (internal)\n          and pt.POST_DATE='${current_year}-${current_month}-${current_day}'\n          -- and upa.USER_ID=916152\n        )\n, entity_names as (\n    select distinct name\n    from WEB_DB.USER_PAYMENT_ACCOUNT upa\n    where 1=1\n      and upa.USER_ID in (\n          select USER_ID from user_ids\n        )\n)\nselect\narray_agg(objs) from (\n        select\n            object_construct(\n                'general_data', object_construct(\n                    'entity_id', eea.EXTERNAL_ENTITY_ID,\n                    'entity_type', 'business',\n                    'entity_subtype', '',\n                    'status', 'active'\n                )\n                ,'business_data', object_construct(\n                    'business_name', eea.ENTITY_NAME\n                )\n            ) as objs\n    from unit21.EXTERNAL_ENTITIES_ACH eea\n    where 1=1\n      and ENTITY_NAME not in ('Aspiration Spend', 'Aspiration Save')\n      and ENTITY_NAME in (\n          select name\n          from entity_names\n      )\n\n    )\n\n)\nfile_format = (format_name = UNIT21_JSON_FORMAT, compression = NONE)\nSINGLE=true\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966927":{"id":2966927,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":400,"y":208,"width":32,"height":16,"inputConnectorIDs":[2966934],"outputSuccessConnectorIDs":[2966901],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Grid Iterator 0"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"txn_pagination"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PAGE_NUMBER"},"2":{"slot":2,"type":"STRING","value":"current_page_number"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"POST_DATE"},"2":{"slot":2,"type":"STRING","value":"current_post_date"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2966958],"inputIterationConnectorIDs":[]},"2966936":{"id":2966936,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-222,"y":421,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"extract_entities_page"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"extract_entities_page"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"current_page_number"},"2":{"slot":2,"type":"STRING","value":"${current_page_number}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"current_post_date"},"2":{"slot":2,"type":"STRING","value":"${current_post_date}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"sequence_number"},"2":{"slot":2,"type":"STRING","value":"${sequence_number}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2966959]},"2966937":{"id":2966937,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-144,"y":208,"width":32,"height":32,"inputConnectorIDs":[2966933],"outputSuccessConnectorIDs":[2966907],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert entity pagination table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delete from unit21.entity_pagination\nwhere 1=1\n  and post_date='${current_year}-${current_month}-${current_day}'\n;\n\ninsert into unit21.entity_pagination\n(USER_ID, POST_DATE, PAGE_NUMBER)\nwith a as (\n    select up.USER_ID,\n           date_trunc('day', up.DATE_CREATED)      as POST_DATE,\n           row_number() over (order by up.USER_ID) as row_num,\n           ceil(row_num / 20000)                   as page_number\n    from WEB_DB.USER_PROFILE up\n    where 1=1\n      and date_trunc('day', up.DATE_CREATED) = '${current_year}-${current_month}-${current_day}'\n\n)\nselect \n    USER_ID,\n    POST_DATE,\n    page_number\nfrom a\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966938":{"id":2966938,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":0,"y":352,"width":32,"height":32,"inputConnectorIDs":[2966911],"outputSuccessConnectorIDs":[2966906],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"extract updated internal instrument"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use warehouse unit_21;\n\n\ncreate or replace file format UNIT21_JSON_FORMAT \n  type = 'JSON'\n  comment = 'JSON format for unit21 export files'\n;\n\n\ncopy into ${unit21_s3_staging_folder}/${file_date}/internal_instrument_update_extract_daily_${file_date}_seq_${sequence_number}.json\nfrom (\n\nwith entity_data as (\n    select u.id                as user_id,\n           array_agg(\n                   object_construct(\n                           'entity_id', u.UUID,\n                           'entity_type', 'user'\n                       )\n               )               as entity_json,\n           min(u.DATE_CREATED) as DATE_CREATED\n    from WEB_DB._USER u\n    where 1 = 1\n--       and u.id = 2192747\n    group by u.id\n)\nselect\narray_agg(objs) from (\n        select\n            object_construct(\n                'instrument_id', upa.ACCOUNT_NUMBER,\n                'instrument_type', upa.NAME,\n                'source', 'internal',\n                'status', 'active',\n                'registered_at', DATE_PART(EPOCH_SECOND, CONVERT_TIMEZONE('America/Los_Angeles', 'UTC', upa.DATE_CREATED::timestamp )),\n                'entities', ed.entity_json\n            ) as objs\n        from WEB_DB.USER_PAYMENT_ACCOUNT upa\n        join WEB_DB.USER_PROFILE up on upa.USER_ID=up.USER_ID\n        left join entity_data ed on upa.USER_ID=ed.user_id\n        where 1=1\n          and upa.DEPOSITORY_ID is not null\n          and upa.name in ('Aspiration Spend', 'Aspiration Save')\n          -- and date_trunc('day',up.DATE_CREATED)='${current_year}-${current_month}-${current_day}'\n\n\t\t  and date_trunc('day', upa.LAST_UPDATED) = '${current_year}-${current_month}-${current_day}'\n\t\t  and date_trunc('day', up.DATE_CREATED) < date_trunc('day', upa.LAST_UPDATED)\n\n\n    )\n\n)\nfile_format = (format_name = UNIT21_JSON_FORMAT, compression = NONE)\nSINGLE=true\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966939":{"id":2966939,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-222,"y":421,"width":32,"height":16,"inputConnectorIDs":[2966932],"outputSuccessConnectorIDs":[2966902],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Grid Iterator 0 (1)"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"entity_pagination"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PAGE_NUMBER"},"2":{"slot":2,"type":"STRING","value":"current_page_number"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"POST_DATE"},"2":{"slot":2,"type":"STRING","value":"current_post_date"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2966959],"inputIterationConnectorIDs":[]},"2966940":{"id":2966940,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-224,"y":560,"width":32,"height":32,"inputConnectorIDs":[2966902],"outputSuccessConnectorIDs":[2966908],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"extract updated entities"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"use warehouse unit_21;\n\n\ncreate or replace file format UNIT21_JSON_FORMAT \n  type = 'JSON'\n  comment = 'JSON format for unit21 export files'\n;\n\n\ncopy into ${unit21_s3_staging_folder}/${file_date}/entity_update_extract_daily_${file_date}_seq_${sequence_number}.json\nfrom (\n\nwith email_data as (\n    select USER_ID,\n           array_agg(EMAIL) as emails\n    from WEB_DB.USER_EMAIL\n    where 1 = 1\n    group by USER_ID\n)\n, phone_data as (\n    select USER_ID,\n           array_agg('+1' || PHONE_NUMBER) as phone_numbers\n    from WEB_DB.USER_PROFILE\n    where 1 = 1\n    group by USER_ID\n)\n, address_data as (\n    select up.USER_ID,\n           array_agg(\n                   object_construct(\n                           'street_name', left(a.STREET1 || COALESCE(a.STREET2, ''), 128),\n                           'city', a.CITY,\n                           'state', s.CODE,\n                           'postal_code', a.ZIP_OR_POSTAL_CODE,\n                           'country', c.CODE\n                       )\n               ) as address_json_array\n    from WEB_DB.ADDRESS a\n             join WEB_DB.USER_PROFILE up on (up.ADDRESS_ID = a.ID or up.MAILING_ADDRESS_ID = a.ID)\n             join WEB_DB.STATE s on a.STATE_ID = s.ID\n             join WEB_DB.COUNTRY c on a.COUNTRY_ID = c.ID\n    where 1 = 1\n--   and up.USER_ID = 605772\n--   and up.USER_ID=1111966\n    group by up.USER_ID\n)\n, application_ip_addresses_raw as (\n    select USER_ID,\n           row_number() over (partition by USER_ID order by DATE_CREATED) as rn,\n           IP_ADDRESS,\n           DATE_CREATED\n    from WEB_DB.USER_PRODUCT_APPLICATION\n    where 1 = 1\n--       and USER_ID = 2192747\n)\n\n, application_ip_addresses as (\n    select USER_ID,\n           array_agg(\n                   object_construct(\n                           'ip_address', IP_ADDRESS,\n                           'first_seen', DATE_PART(EPOCH_SECOND, CONVERT_TIMEZONE('America/Los_Angeles', 'UTC',\n                                                                                  DATE_CREATED::timestamp)),\n                           'last_seen', DATE_PART(EPOCH_SECOND, CONVERT_TIMEZONE('America/Los_Angeles', 'UTC',\n                                                                                 DATE_CREATED::timestamp))\n                       )\n               ) as ip_addresses\n    from application_ip_addresses_raw\n    where 1 = 1\n      and rn = 1\n      and IP_ADDRESS is not null\n    group by USER_ID\n)\n\nselect\narray_agg(objs) from (\n        select\n            object_construct(\n                'general_data', object_construct(\n                    'entity_id', u.UUID,\n                    'entity_type', 'user',\n                    'entity_subtype', '',\n                    'status', case\n                        when u.ENABLED then 'active'\n                        else 'suspended' end,\n                    'registered_at', DATE_PART(EPOCH_SECOND, CONVERT_TIMEZONE('America/Los_Angeles', 'UTC', u.DATE_CREATED::timestamp ))\n                )\n                ,'user_data', object_construct(\n                    'first_name', up.FIRST_NAME,\n                    'middle_name', up.MIDDLE_NAME,\n                    'last_name', up.LAST_NAME,\n--                     'date_of_birth', up.DATE_OF_BIRTH,\n                    'day_of_birth', DATE_PART(DAY, up.DATE_OF_BIRTH),\n                    'month_of_birth', DATE_PART(MONTH, up.DATE_OF_BIRTH),\n                    'year_of_birth', DATE_PART(YEAR, up.DATE_OF_BIRTH),\n                    'gender', case\n                        when up.GENDER_TYPE=1 then 'male'\n                        when up.GENDER_TYPE=2 then 'female'\n                        else 'other' end,\n                    'ssn', substr(TAX_IDENTIFICATION_NUMBER, 1, 3) || '-' || substr(TAX_IDENTIFICATION_NUMBER, 4, 2) || '-' || substr(TAX_IDENTIFICATION_NUMBER, 6, 4)\n                )\n                ,'communication_data', object_construct(\n                    'email_addresses', ed.emails,\n                    'phone_numbers', pd.phone_numbers\n                )\n                , 'location_data', ad.address_json_array\n                , 'digital_data', object_construct(\n                    'ip_addresses', aia.ip_addresses\n                )\n            ) as objs\n        from WEB_DB._USER u\n        join WEB_DB.USER_PROFILE up on u.id=up.USER_ID\n        join email_data ed on u.id=ed.USER_ID\n        join phone_data pd on u.id=pd.USER_ID\n        join PCI.USER_PROFILE upsin on u.id=upsin.USER_ID and upsin.TAX_IDENTIFICATION_NUMBER is not null and upsin.TAX_IDENTIFICATION_NUMBER != ''\n        left join address_data ad on u.id=ad.USER_ID\n        left join application_ip_addresses aia on u.id=aia.USER_ID\n        where 1=1\n--           and u.UUID='df0c40c91dc645b0a06c266c247f8448'\n--           and u.id in (605772, 1111966)\n--           and u.id=2449314  -- hacked client\n--           and date_trunc('day',up.DATE_CREATED)='${current_year}-${current_month}-${current_day}'\n\n          and up.USER_ID in (\n            select\n                -- 'name',\n                uat.USER_ID\n            from WEB_DB.USER_AUDIT_TRAIL uat\n            where 1=1\n              and uat.AUDIT_TRAIL ilike '%Changed name%'\n              and date_trunc('day', uat.DATE_CREATED) = '${current_year}-${current_month}-${current_day}'\n            -- ;\n            union all\n\n            select\n                -- 'address',\n                uat.USER_ID\n            from WEB_DB.USER_AUDIT_TRAIL uat\n            where 1=1\n              and uat.AUDIT_TRAIL ilike '%update%address%'\n              and date_trunc('day', uat.DATE_CREATED) = '${current_year}-${current_month}-${current_day}'\n            -- ;\n            union all\n\n            select\n                -- 'email',\n                uat.USER_ID\n            from WEB_DB.USER_AUDIT_TRAIL uat\n            where 1=1\n              and uat.AUDIT_TRAIL ilike 'Email%'\n              and date_trunc('day', uat.DATE_CREATED) = '${current_year}-${current_month}-${current_day}'\n            -- ;\n            union all\n\n            select\n                -- 'phone',\n                uat.USER_ID\n            from WEB_DB.USER_AUDIT_TRAIL uat\n            where 1=1\n              and uat.AUDIT_TRAIL ilike '%phone%'\n              and uat.AUDIT_TRAIL not ilike '%Alloy%'\n              and date_trunc('day', uat.DATE_CREATED) = '${current_year}-${current_month}-${current_day}'\n\n          )\n    )\n\n)\nfile_format = (format_name = UNIT21_JSON_FORMAT, compression = NONE)\nSINGLE=true\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966941":{"id":2966941,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":400,"y":112,"width":32,"height":32,"inputConnectorIDs":[2966928],"outputSuccessConnectorIDs":[2966934],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get all pages for debit card txns"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"galileo_interest_accrual"}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"file_date"}}}},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select\n--     count(1)\n    distinct POST_DATE, PAGE_NUMBER\nfrom unit21.TXN_PAGINATION\nwhere 1=1\n  and POST_DATE='${current_year}-${current_month}-${current_day}'\n  and INSTRUMENT='debit_card'\norder by POST_DATE, PAGE_NUMBER"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"txn_pagination"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"POST_DATE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"PAGE_NUMBER"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rdl"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966942":{"id":2966942,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-224,"y":320,"width":32,"height":32,"inputConnectorIDs":[2966907],"outputSuccessConnectorIDs":[2966932],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get all pages for entities"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"galileo_interest_accrual"}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"file_date"}}}},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select\n--     count(1)\n    distinct POST_DATE, PAGE_NUMBER\nfrom unit21.ENTITY_PAGINATION\nwhere 1=1\n  and POST_DATE='${current_year}-${current_month}-${current_day}'\norder by POST_DATE, PAGE_NUMBER"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"entity_pagination"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"POST_DATE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"PAGE_NUMBER"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rdl"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966943":{"id":2966943,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":0,"y":96,"width":32,"height":32,"inputConnectorIDs":[2966956],"outputSuccessConnectorIDs":[2966933],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"check variables"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nfrom datetime import datetime\nfrom datetime import timedelta\nfrom dateutil.relativedelta import relativedelta\nfrom pytz import timezone\n\n# print 'current time in PST: ', datetime.now(timezone('US/Pacific'))\n\n# today=datetime.now(timezone('US/Pacific')).strftime(\"%Y-%m-%d\")\n# print 'today: ', today\n\nprint '${current_year}-${current_month}-${current_day}'\n\nfile_date='${current_year}${current_month}${current_day}'\ncontext.updateVariable('file_date', file_date)\nprint 'file_date', file_date\n\n#context.updateVariable('file_date', file_date)\n\n\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2966901":{"id":2966901,"sourceID":2966927,"targetID":2966921},"2966902":{"id":2966902,"sourceID":2966939,"targetID":2966940},"2966903":{"id":2966903,"sourceID":2966917,"targetID":2966922},"2966904":{"id":2966904,"sourceID":2966923,"targetID":2966920},"2966905":{"id":2966905,"sourceID":2966913,"targetID":2966918},"2966906":{"id":2966906,"sourceID":2966938,"targetID":2966916},"2966907":{"id":2966907,"sourceID":2966937,"targetID":2966942},"2966908":{"id":2966908,"sourceID":2966940,"targetID":2966919},"2966909":{"id":2966909,"sourceID":2966920,"targetID":2966917},"2966910":{"id":2966910,"sourceID":2966921,"targetID":2966926},"2966911":{"id":2966911,"sourceID":2966919,"targetID":2966938},"2966928":{"id":2966928,"sourceID":2966914,"targetID":2966941},"2966929":{"id":2966929,"sourceID":2966918,"targetID":2966914},"2966930":{"id":2966930,"sourceID":2966915,"targetID":2966912},"2966931":{"id":2966931,"sourceID":2966926,"targetID":2966923},"2966932":{"id":2966932,"sourceID":2966942,"targetID":2966939},"2966933":{"id":2966933,"sourceID":2966943,"targetID":2966937},"2966934":{"id":2966934,"sourceID":2966941,"targetID":2966927},"2966935":{"id":2966935,"sourceID":2966916,"targetID":2966913}},"failureConnectors":{},"unconditionalConnectors":{"2966956":{"id":2966956,"sourceID":2966925,"targetID":2966943},"2966957":{"id":2966957,"sourceID":2966925,"targetID":2966915}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"2966958":{"id":2966958,"sourceID":2966927,"targetID":2966924},"2966959":{"id":2966959,"sourceID":2966939,"targetID":2966936}},"noteConnectors":{},"notes":{},"variables":{"current_day":{"definition":{"name":"current_day","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"16"},"current_month":{"definition":{"name":"current_month","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"08"},"current_page_number":{"definition":{"name":"current_page_number","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"1"},"current_post_date":{"definition":{"name":"current_post_date","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"2018-12-31"},"current_year":{"definition":{"name":"current_year","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"2020"},"file_date":{"definition":{"name":"file_date","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"20200816"},"sequence_number":{"definition":{"name":"sequence_number","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"001"},"unit21_s3_staging_folder":{"definition":{"name":"unit21_s3_staging_folder","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"@public.ASPIRATION_DATA_UNIT21/daily_load"}},"grids":{"entity_pagination":{"definition":{"name":"entity_pagination","scope":"BRANCH","definitions":[{"name":"POST_DATE","type":"TEXT"},{"name":"PAGE_NUMBER","type":"DECIMAL"}],"description":"","visibility":"PUBLIC"},"values":[]},"file_names":{"definition":{"name":"file_names","scope":"BRANCH","definitions":[{"name":"file_name","type":"TEXT"},{"name":"post_date","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]},"txn_pagination":{"definition":{"name":"txn_pagination","scope":"BRANCH","definitions":[{"name":"POST_DATE","type":"TEXT"},{"name":"PAGE_NUMBER","type":"DECIMAL"}],"description":"","visibility":"PUBLIC"},"values":[]}}},"info":{"name":"unit21_daily_load_day_backup_20220706","description":"","type":"ORCHESTRATION","tag":"adf62163-4b0e-4661-b61d-f4d57378b574"}}