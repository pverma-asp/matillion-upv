{"job":{"components":{"2966864":{"id":2966864,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":0,"y":16,"width":32,"height":32,"inputConnectorIDs":[2966945],"outputSuccessConnectorIDs":[2966950],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get all files to upload"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"galileo_interest_accrual"}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"file_date"}}}},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select\n\t'${filedate}' as filedate,\n    filename\nfrom unit21.file_load_status\nwhere 1=1\n  and filedate=substr('${filedate}', 0, 4) || '-' || substr('${filedate}', 5, 2) || '-' || substr('${filedate}', 7, 2)\n  and status='new'"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"file_list"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FILENAME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"FILEDATE"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rdl"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966866":{"id":2966866,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-256,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2966944],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get all files to upload - old"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"galileo_interest_accrual"}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"file_date"}}}},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"with debit_card_txn_files as (\n    select distinct 'debit_card_transaction_extract_daily_${filedate}_page_' || PAGE_NUMBER || '_seq_${sequence_number}.json' as filename\n    from unit21.TXN_PAGINATION\n    where 1 = 1\n\t  and POST_DATE=substr('${filedate}', 0, 4) || '-' || substr('${filedate}', 5, 2) || '-' || substr('${filedate}', 7, 2)\n)\n\n, entity_files as (\n    select distinct 'entity_extract_daily_${filedate}_page_' || PAGE_NUMBER || '_seq_${sequence_number}.json' as filename\n    from unit21.ENTITY_PAGINATION\n    where 1 = 1\n\t  and POST_DATE=substr('${filedate}', 0, 4) || '-' || substr('${filedate}', 5, 2) || '-' || substr('${filedate}', 7, 2)\n)\n\n-- debit cards\nselect\n\t'${filedate}' as filedate,\n    filename\nfrom entity_files\n\n-- entity updates\nunion all\nselect\n\t'${filedate}',\n\t'entity_update_extract_daily_${filedate}_seq_${sequence_number}.json'\n\nunion all\nselect\n\t'${filedate}',\n\t'internal_instrument_extract_daily_${filedate}_seq_${sequence_number}.json'\n\nunion all\nselect\n\t'${filedate}',\n\t'internal_instrument_update_extract_daily_${filedate}_seq_${sequence_number}.json'\n\nunion all\nselect\n\t'${filedate}',\n\t'check_transaction_extract_daily_${filedate}_seq_${sequence_number}.json'\n\nunion all\nselect\n\t'${filedate}',\n\t'wire_transaction_extract_daily_${filedate}_seq_${sequence_number}.json'\n\n-- ach internal\nunion all\nselect\n\t'${filedate}',\n\t'ach_transaction_internal_extract_daily_${filedate}_seq_${sequence_number}.json'\n\n-- ach external\nunion all\nselect\n\t'${filedate}',\n\t'external_entity_ach_extract_daily_${filedate}_seq_${sequence_number}.json'\n\nunion all\nselect\n\t'${filedate}',\n\t'ach_transaction_external_extract_daily_${filedate}_seq_${sequence_number}.json'\n\nunion all\nselect\n\t'${filedate}',\n\t'external_instrument_ach_extract_daily_${filedate}_seq_${sequence_number}.json'\n\n-- debit cards\nunion all\nselect\n\t'${filedate}',\n    filename\nfrom debit_card_txn_files\n\n"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"file_list"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FILENAME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"FILEDATE"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rdl"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966867":{"id":2966867,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":0,"y":112,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"unit21_upload_file"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"unit21_upload_file"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"filename"},"2":{"slot":2,"type":"STRING","value":"${current_filename}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"filedate"},"2":{"slot":2,"type":"STRING","value":"${current_filedate}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[2966947]},"2966948":{"id":2966948,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":-144,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2966944,2966945],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2966949":{"id":2966949,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":0,"y":112,"width":32,"height":16,"inputConnectorIDs":[2966950],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Grid Iterator 0 (1)"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"file_list"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"filename"},"2":{"slot":2,"type":"STRING","value":"current_filename"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"filedate"},"2":{"slot":2,"type":"STRING","value":"current_filedate"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[2966947],"inputIterationConnectorIDs":[]}},"successConnectors":{"2966950":{"id":2966950,"sourceID":2966864,"targetID":2966949}},"failureConnectors":{},"unconditionalConnectors":{"2966944":{"id":2966944,"sourceID":2966948,"targetID":2966866},"2966945":{"id":2966945,"sourceID":2966948,"targetID":2966864}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"2966947":{"id":2966947,"sourceID":2966949,"targetID":2966867}},"noteConnectors":{},"notes":{"2966865":{"id":2966865,"x":-696,"y":-60,"width":274,"height":228,"text":"How to rerun when after job failed due to timeout, i.e. 'file stuck at validation pending'\n\n- modify job variable filedate to the day of the file, e.g. '20220204' (no dash)\n\n- run the job\n\n- sql\nselect *\nfrom unit21.file_load_status\nwhere 1=1\n  and FILEDATE='2022-02-04'\n;\n\n","colour":"e6e63c"}},"variables":{"current_filedate":{"definition":{"name":"current_filedate","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"current_filename":{"definition":{"name":"current_filename","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"filedate":{"definition":{"name":"filedate","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"20220915"},"sequence_number":{"definition":{"name":"sequence_number","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"002"}},"grids":{"file_list":{"definition":{"name":"file_list","scope":"BRANCH","definitions":[{"name":"filename","type":"TEXT"},{"name":"filedate","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]}}},"info":{"name":"unit21_upload_file_rerun","description":"","type":"ORCHESTRATION","tag":"24b9876a-3b48-43e3-9350-80469b95ccf9"}}