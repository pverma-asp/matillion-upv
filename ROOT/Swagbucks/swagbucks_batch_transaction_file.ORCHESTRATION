{"job":{"components":{"2961860":{"id":2961860,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-560,"y":80,"width":32,"height":32,"inputConnectorIDs":[2961883],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Views"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP VIEW IF EXISTS rdl.swagbucks_redemption_status_v;\nCREATE VIEW rdl.swagbucks_redemption_status_v AS\nWITH\nuser_payment_accounts AS (\n    SELECT pa.redemption_code\n         , ga.aspiration_user_id AS user_id\n         , ga.pmt_ref_no AS prn\n         , ga.status_code\n         , ga.active\n         , ga.product_id\n         , upa.product_id\n         , row_number() over(partition by pa.redemption_code, pa.user_id order by upa.product_id asc) as rownum\n    FROM web_db.partnership_account pa\n    LEFT JOIN aog_db.galileo_accounts ga ON ga.aspiration_user_id = pa.user_id\n    LEFT JOIN web_db.user_product_application upa ON ga.aspiration_application_id = upa.id\n    WHERE pa.partnership_id = 1\n    )\nSELECT t.etl_run_history_id\n     , t.etl_batch_number\n     , t.etl_filename\n     , t.etl_rownum\n     , t.transaction_identifier\n     , t.order_id\n     , upa.user_id\n     , upa.prn\n     , t.distribution_amount\n     , case when gbr.id is not null then 'Complete'\n     \t    when gbt.id is not null then 'Pending'\n            else 'Not Sent'\n             end as transaction_status\n     , first_value(case when gbr.d_response_code = '0000' then t.transaction_identifier end) over(partition by t.order_id order by gbr.etl_timestamp asc nulls last, t.transaction_identifier asc nulls last rows between unbounded preceding and unbounded following) as paid_transaction_identifier\n     , first_value(case when gbr.d_response_code = '0000' then gbr.h_file_transmit_date end) over(partition by t.order_id order by gbr.etl_timestamp asc nulls last, t.transaction_identifier asc nulls last rows between unbounded preceding and unbounded following) as paid_file_transmit_date\n     , first_value(case when gbr.id is null and gbt.id is not null then t.transaction_identifier end) over(partition by t.order_id order by gbr.etl_timestamp asc nulls last, t.transaction_identifier asc nulls last rows between unbounded preceding and unbounded following) as pending_transaction_identifier\n     , sum(1) over(partition by t.order_id, t.etl_filename) as dup_order_id_infile\n     , sum(case when gbr.d_response_code = '0000' then t.distribution_amount end) over(partition by upa.user_id order by gbr.etl_timestamp desc nulls last, t.transaction_identifier asc nulls last rows between 30 preceding and current row) as user_pay_last30trans\n     , sum(case when gbr.id is null and gbt.id is not null then t.distribution_amount end) over(partition by upa.user_id) as user_pay_pending\n     , sum(t.distribution_amount) over(partition by upa.user_id, t.etl_filename) as user_amount_infile\n     , case when (t.redemption_code is null\n              or t.batch_date is null\n              or t.distribution_amount is null\n              or t.order_id is null) \t\t\t\t\t\t\t\t\tthen 'SB_003'\n            when (coalesce(paid_transaction_identifier,pending_transaction_identifier) is not null\n             and coalesce(paid_transaction_identifier,pending_transaction_identifier) <> t.transaction_identifier)\n              or dup_order_id_infile > 1\t\t\t\t\t\t\t\tthen 'SB_007'\n            when upa.redemption_code is null \t\t\t\t\t\t\t\tthen 'SB_001'\n            when (t.distribution_amount < 1\n              or t.distribution_amount > 250) \t\t\t\t\t\t\t\tthen 'SB_002'\n            when nvl(user_pay_last30trans,0) + nvl(user_pay_pending,0) > 50000\n              or user_amount_infile\t> 50000\t\t\t\t\t\t\t\tthen 'SB_005'\n          --when upa.is_deleted or upa.is_admin_disabled \t\t\t\t\t\tthen 'SB_004'\n            else nvl2(gbr.id,nvl(grm.response_code,'SB_006'),gbr.d_response_code) \n\t     end as aspiration_response_code\nFROM rdl.swagbucks_redemption t\nLEFT JOIN user_payment_accounts upa ON upa.redemption_code = t.redemption_code and upa.rownum = 1\nLEFT JOIN rdl.galileo_batch_transaction gbt ON gbt.d_transaction_identifier = t.transaction_identifier\nLEFT JOIN rdl.galileo_batch_response gbr ON gbr.d_transaction_identifier = gbt.d_transaction_identifier\nLEFT JOIN rdl.swagbucks_response sbr ON sbr.transaction_identifier = t.transaction_identifier\nLEFT JOIN rdl.galileo_response_map grm ON grm.galileo_response_code = gbr.d_response_code\nWHERE sbr.id IS NULL;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2961861":{"id":2961861,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-80,"y":0,"width":32,"height":32,"inputConnectorIDs":[2961856],"outputSuccessConnectorIDs":[2961857],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Batch"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP TABLE IF EXISTS ${staging_schema}.${staging_table};\nCREATE TABLE ${staging_schema}.${staging_table} AS\n\tSELECT t.etl_run_history_id\t\t\t\t\t\t\t::VARCHAR AS etl_run_history_id\n    \t, t.etl_batch_number\t\t\t\t\t\t\t::VARCHAR AS etl_batch_number\n    \t, row_number() over(order by t.etl_rownum asc)  ::VARCHAR AS record_number\n\t\t, t.prn\t\t\t\t\t\t\t\t\t\t\t::VARCHAR AS account_identifier\n\t\t, ('-' || t.distribution_amount)\t\t\t\t::VARCHAR AS transaction_amount\n\t\t, t.transaction_identifier\t\t\t\t\t\t::VARCHAR AS transaction_identifier\n\tFROM rdl.swagbucks_redemption_status_v t\n\tWHERE t.etl_run_history_id = '${run_history_id}'\n      AND t.aspiration_response_code is null\n      AND t.transaction_status = 'Not Sent';\nALTER TABLE ${staging_schema}.${staging_table}\n   OWNER TO svc_etl;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2961862":{"id":2961862,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-566,"y":-77,"width":32,"height":32,"inputConnectorIDs":[2961881],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Codes"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP TABLE IF EXISTS rdl.galileo_response_map;\nCREATE TABLE rdl.galileo_response_map AS (\n   SELECT 'Swagbucks' AS record_type, '0000' AS galileo_response_code, 'SB_000' AS response_code\n   UNION ALL\n   SELECT 'Swagbucks' AS record_type, '1091' AS galileo_response_code, 'SB_004' AS response_code\n   UNION ALL\n   SELECT 'Swagbucks' AS record_type, '1093' AS galileo_response_code, 'SB_004' AS response_code\n   UNION ALL\n   SELECT 'Swagbucks' AS record_type, '5016' AS galileo_response_code, 'SB_004' AS response_code\n   UNION ALL\n   SELECT 'Swagbucks' AS record_type, '9999' AS galileo_response_code, 'SB_004' AS response_code\n   );\nALTER TABLE rdl.galileo_response_map\n   OWNER TO svc_etl;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2961863":{"id":2961863,"inputCardinality":"ZERO","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"NONE","implementationID":814341975,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[2961857],"outputSuccessConnectorIDs":[2961887],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Queue"}}}},"visible":true},"2":{"slot":2,"name":"source_schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${staging_schema}"}}}},"visible":true},"3":{"slot":3,"name":"source_table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${staging_table}"}}}},"visible":true},"4":{"slot":4,"name":"etl_run_history_id","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_run_history_id"}}}},"visible":true},"5":{"slot":5,"name":"etl_batch_number","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"etl_batch_number"}}}},"visible":true},"6":{"slot":6,"name":"vD01_record_type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"'D'"}}}},"visible":true},"7":{"slot":7,"name":"vD02_record_number","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"record_number"}}}},"visible":true},"8":{"slot":8,"name":"vD03_account_id_type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"'R'"}}}},"visible":true},"9":{"slot":9,"name":"vD04_account_identifier","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"account_identifier"}}}},"visible":true},"10":{"slot":10,"name":"vD05_location_id","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"null"}}}},"visible":true},"11":{"slot":11,"name":"vD06_location_type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"null"}}}},"visible":true},"12":{"slot":12,"name":"vD07_transaction_type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"'A'"}}}},"visible":true},"13":{"slot":13,"name":"vD08_transaction_sub_type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"'PB'"}}}},"visible":true},"14":{"slot":14,"name":"vD09_transaction_amount","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"transaction_amount"}}}},"visible":true},"15":{"slot":15,"name":"vD10_transaction_description","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"'Swagbucks Redemption'"}}}},"visible":true},"16":{"slot":16,"name":"vD11_transaction_identifier","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"transaction_identifier"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2961864":{"id":2961864,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":160,"y":0,"width":32,"height":32,"inputConnectorIDs":[2961884],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2961865":{"id":2961865,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-400,"y":0,"width":32,"height":32,"inputConnectorIDs":[2961880],"outputSuccessConnectorIDs":[2961859],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Variables"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Udating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nimport datetime\n\n#add run_history_id to create a unique temp table for parrallel processing\ncontext.updateVariable(\"staging_table\", staging_table + str(run_history_id))\n\n#add YYYYMMDD to batch_filename varible \n#add value in batch_filename_sequence variable\n#Note: date calc rolls to next day when processed after 5pm MT or 4pm PT (Galileo is no longer processing at this time)\n#context.updateVariable(\"batch_filename\", batch_filename + datetime.date.today().strftime('%Y') + datetime.date.today().strftime('%m') + datetime.date.today().strftime('%d') + str(run_history_id) + '.txt')"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2961866":{"id":2961866,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-320,"y":0,"width":32,"height":32,"inputConnectorIDs":[2961859],"outputSuccessConnectorIDs":[2961885],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Stage"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP TABLE IF EXISTS ${staging_schema}.${staging_table};\nCREATE TABLE ${staging_schema}.${staging_table} (\n   rownum\t\t\t\t\tBIGINT IDENTITY(0,1),\n  \n   redemption_code\t\t\tVARCHAR(256),\n   batch_date\t\t\t\tVARCHAR(256),\n   distribution_amount\t\tVARCHAR(256),\n   order_id\t\t\t\t\tVARCHAR(256)\n   );\nALTER TABLE ${staging_schema}.${staging_table}\n   OWNER TO svc_etl;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2961867":{"id":2961867,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-560,"y":0,"width":32,"height":32,"inputConnectorIDs":[2961886],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Tables"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP TABLE IF EXISTS rdl.swagbucks_redemption CASCADE;\nCREATE TABLE rdl.swagbucks_redemption (\n   etl_run_history_id\t\tVARCHAR(256),\n   etl_timestamp\t\t\tTIMESTAMP DEFAULT SYSDATE,\n   etl_batch_number\t\t\tVARCHAR(256),\n   etl_filename\t\t\t\tVARCHAR(256),\n   etl_rownum\t\t\t\tBIGINT,\n  \n   redemption_code\t\t\tVARCHAR(256),\n   batch_date\t\t\t\tVARCHAR(256),\n   distribution_amount\t\tDECIMAL(8,4),\n   order_id\t\t\t\t\tVARCHAR(256),\n  \n   transaction_identifier\tVARCHAR(256)\n   );\nALTER TABLE rdl.swagbucks_redemption\n   OWNER TO svc_etl;\n\nDROP TABLE IF EXISTS rdl.swagbucks_response CASCADE;\nCREATE TABLE rdl.swagbucks_response (\n   id\t\t\t\t\t\tBIGINT IDENTITY(0,1),\n   etl_run_history_id\t\tVARCHAR(256),\n   etl_timestamp\t\t\tTIMESTAMP DEFAULT SYSDATE,\n   etl_filename\t\t\t\tVARCHAR(256),\n  \n   file_transmit_date\t\tVARCHAR(256),\n   transaction_identifier\tVARCHAR(256),\n   response_code\t\t\tVARCHAR(256)\n   );\nALTER TABLE rdl.swagbucks_response\n   OWNER TO svc_etl;\n\nDROP TABLE IF EXISTS rdl.galileo_batch_transaction CASCADE;\nCREATE TABLE IF NOT EXISTS rdl.galileo_batch_transaction (\n   ID\t\t \t\t\t\t\tBIGINT IDENTITY(0,1),\n   ETL_RUN_HISTORY_ID\t\t\tVARCHAR(256),\n   ETL_TIMESTAMP\t\t\t\tTIMESTAMP DEFAULT SYSDATE,\n   ETL_BATCH_NUMBER\t\t\t\tVARCHAR(256),\n   D_RECORD_TYPE\t\t\t\tVARCHAR(256),\n   D_RECORD_NUMBER\t\t\t\tVARCHAR(256),\n   D_ACCOUNT_ID_TYPE\t\t\tVARCHAR(256),\n   D_ACCOUNT_IDENTIFIER\t\t\tVARCHAR(256),\n   D_LOCATION_TYPE\t\t\t\tVARCHAR(256),\n   D_LOCATION_ID\t\t\t\tVARCHAR(256),\n   D_TRANSACTION_TYPE\t\t\tVARCHAR(256),\n   D_TRANSACTION_SUB_TYPE\t\tVARCHAR(256),\n   D_TRANSACTION_AMOUNT\t\t\tVARCHAR(256),\n   D_TRANSACTION_DESCRIPTION\tVARCHAR(256),\n   D_TRANSACTION_IDENTIFIER\t\tVARCHAR(256)\n   );\nALTER TABLE rdl.galileo_batch_transaction\n   OWNER TO svc_etl;\n   \nDROP TABLE IF EXISTS rdl.galileo_batch_response CASCADE;\nCREATE TABLE rdl.galileo_batch_response (\n   ID\t\t\t\t\t\tBIGINT IDENTITY(0,1),\n   ETL_RUN_HISTORY_ID \t\tVARCHAR(256),\n   ETL_TIMESTAMP\t\t\tTIMESTAMP DEFAULT SYSDATE,\n   ETL_FILENAME\t\t\t\tVARCHAR(256),\n   H_RECORD_TYPE   \t\t\tVARCHAR(256),\n   H_HEADER   \t\t\t\tVARCHAR(256),\n   H_CLIENT_ID   \t\t\tVARCHAR(256),\n   H_PROGRAM_ID   \t\t\tVARCHAR(256),\n   H_FILE_NAME   \t\t\tVARCHAR(256),\n   H_FILE_TRANSMIT_DATE   \tVARCHAR(256),\n   D_RECORD_TYPE   \t\t\tVARCHAR(256),\n   D_RECORD_NUMBER   \t\tVARCHAR(256),\n   D_ACCOUNT_ID_TYPE   \t\tVARCHAR(256),\n   D_ACCOUNT_IDENTIFIER   \tVARCHAR(256),\n   D_TRANSACTION_IDENTIFIER VARCHAR(256),\n   D_RESPONSE_CODE   \t\tVARCHAR(256),\n   T_RECORD_TYPE   \t\t\tVARCHAR(256),\n   T_TRAILER   \t\t\t\tVARCHAR(256),\n   T_COUNT   \t\t\t\tVARCHAR(256)\n   );\nALTER TABLE rdl.galileo_batch_response\n   OWNER TO svc_etl;\n   \nDROP TABLE IF EXISTS rdl.galileo_batch_transit CASCADE;\nCREATE TABLE rdl.galileo_batch_transit (\n   ETL_RUN_HISTORY_ID \t\tVARCHAR(256),\n   ETL_TIMESTAMP\t\t\tTIMESTAMP DEFAULT SYSDATE,\n   ETL_BATCH_NUMBER\t\t\t\tVARCHAR(256),\n   ETL_FILENAME\t\t\t\tVARCHAR(256),\n   H_RECORD_TYPE   \t\t\tVARCHAR(256),\n   H_HEADER   \t\t\t\tVARCHAR(256),\n   H_CLIENT_ID   \t\t\tVARCHAR(256),\n   H_PROGRAM_ID   \t\t\tVARCHAR(256),\n   H_FILE_NAME   \t\t\tVARCHAR(256),\n   H_FILE_TRANSMIT_DATE   \tVARCHAR(256),\n   D_RECORD_TYPE\t\t\t\tVARCHAR(256),\n   D_RECORD_NUMBER\t\t\t\tVARCHAR(256),\n   D_ACCOUNT_ID_TYPE\t\t\tVARCHAR(256),\n   D_ACCOUNT_IDENTIFIER\t\t\tVARCHAR(256),\n   D_LOCATION_TYPE\t\t\t\tVARCHAR(256),\n   D_LOCATION_ID\t\t\t\tVARCHAR(256),\n   D_TRANSACTION_TYPE\t\t\tVARCHAR(256),\n   D_TRANSACTION_SUB_TYPE\t\tVARCHAR(256),\n   D_TRANSACTION_AMOUNT\t\t\tVARCHAR(256),\n   D_TRANSACTION_DESCRIPTION\tVARCHAR(256),\n   D_TRANSACTION_IDENTIFIER\t\tVARCHAR(256),\n   T_RECORD_TYPE   \t\t\tVARCHAR(256),\n   T_TRAILER   \t\t\t\tVARCHAR(256),\n   T_COUNT   \t\t\t\tVARCHAR(256)\n   );\nALTER TABLE rdl.galileo_batch_transit\n   OWNER TO svc_etl;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2961868":{"id":2961868,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-480,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2961880,2961881,2961883,2961886],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2961869":{"id":2961869,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":773867971,"x":-240,"y":0,"width":32,"height":32,"inputConnectorIDs":[2961885],"outputSuccessConnectorIDs":[2961858],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load"}}}},"visible":true},"4":{"slot":4,"name":"S3 Object Prefix","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${input_filename}"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${staging_schema}"}}}},"visible":true},"8":{"slot":8,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${staging_table}"}}}},"visible":true},"9":{"slot":9,"name":"Load Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"redemption_code"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"batch_date"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"distribution_amount"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"order_id"}}}},"visible":true},"23":{"slot":23,"name":"Date Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"auto"}}}},"visible":true},"24":{"slot":24,"name":"Time Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"auto"}}}},"visible":true},"26":{"slot":26,"name":"","elements":{},"visible":false},"27":{"slot":27,"name":"Escape","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2961870":{"id":2961870,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-160,"y":0,"width":32,"height":32,"inputConnectorIDs":[2961858],"outputSuccessConnectorIDs":[2961856],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Store"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT INTO rdl.swagbucks_redemption\nSELECT '${run_history_id}' as etl_run_history_id\n\t , sysdate as etl_timestamp\n     , lpad(${file_number}::varchar,2,'0') as etl_batch_number\n\t , '${input_filename}' as etl_filename\n     , row_number() over(order by rownum asc) as etl_rownum\n\t , nullif(trim(redemption_code),'') as redemption_code\n\t , nullif(trim(batch_date),'') as batch_date\n\t , nullif(trim(distribution_amount),'')::DECIMAL(8,4) as distribution_amount\n\t , nullif(trim(order_id),'') as order_id\n     , 'SR_'||'${run_history_id}'||'-'||lpad(${file_number}::varchar,2,'0')||'-'||lpad(etl_rownum::varchar,5,'0') as transaction_identifier\nFROM ${staging_schema}.${staging_table};"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2961871":{"id":2961871,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":80,"y":0,"width":32,"height":32,"inputConnectorIDs":[2961887],"outputSuccessConnectorIDs":[2961884],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Cleanup"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP TABLE IF EXISTS ${staging_schema}.${staging_table};"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2961856":{"id":2961856,"sourceID":2961870,"targetID":2961861},"2961857":{"id":2961857,"sourceID":2961861,"targetID":2961863},"2961858":{"id":2961858,"sourceID":2961869,"targetID":2961870},"2961859":{"id":2961859,"sourceID":2961865,"targetID":2961866},"2961884":{"id":2961884,"sourceID":2961871,"targetID":2961864},"2961885":{"id":2961885,"sourceID":2961866,"targetID":2961869},"2961887":{"id":2961887,"sourceID":2961863,"targetID":2961871}},"failureConnectors":{},"unconditionalConnectors":{"2961880":{"id":2961880,"sourceID":2961868,"targetID":2961865},"2961881":{"id":2961881,"sourceID":2961868,"targetID":2961862},"2961883":{"id":2961883,"sourceID":2961868,"targetID":2961860},"2961886":{"id":2961886,"sourceID":2961868,"targetID":2961867}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{"2961888":{"id":2961888,"x":-72,"y":162,"width":382,"height":129,"text":"**``HEADER``**\n\n0**  COLUMN                        L      S     E      VAL                   REQ**\n1   RECORD_TYPE                1      1     1      \"H\"                    Y\n2   HEADER                           6      2     7      \"HEADER\"        Y\n3   CLIENT_ID                       10    8     17    454                    Y\n4   PROGRAM_ID                 10   18    27    584\n5   FILE_NAME                      50   28   77    var                     Y\n6   FILE_TRANSMIT_DATE   8     78   85    MMDDYYYY      Y","colour":"e6e63c"},"2961889":{"id":2961889,"x":-70,"y":310,"width":382,"height":89,"text":"**``TRAILER``**\n\n0**\tCOLUMN .         L    S    E    VALUE        REQ**\n1  RECORD_TYPE   1    1    1    \"T\"               Y\n2  TRAILER              7    2    8    \"TRAILER\"   Y\n3  COUNT               6    9    14   999999       Y","colour":"e6e63c"},"2961890":{"id":2961890,"x":-266,"y":-119,"width":207,"height":67,"text":"Record set sent for batch file. Columns from this temp table is mapped into batch trans shared job.","colour":"f9c21b"},"2961891":{"id":2961891,"x":-100,"y":-78,"width":40,"height":112,"text":"","colour":"f9c21b"},"2961892":{"id":2961892,"x":-21,"y":-20,"width":40,"height":179,"text":"","colour":"f9c21b"},"2961894":{"id":2961894,"x":-471,"y":201,"width":382,"height":198,"text":"**``DETAIL``**\n\n0**   COLUMN                                       L      S       E      VALUE           REQ**\n1    RECORD_TYPE                               1     1       1      \"D\"                   Y\n2    RECORD_NUMBER                        6     2       7      999999           Y\n3    ACCOUNT_ID_TYPE                      1      8       8      R                      Y\n4    ACCOUNT_IDENTIFIER                 50    9      58    PRN                 Y\n5    LOCATION_ID                                1      59    59                             N\n6    LOCATION_TYPE                           20    60    79                             N\n7    TRANSACTION_TYPE                    1      80    80     var                   Y\n8    TRANSACTION_SUB_TYPE           3      81    83                             N\n9    TRANSACTION_AMOUNT            13    84    96    1234567891   Y\n10  TRANSACTION_DESCRIPTION    40    97    136   var                  N\n11  TRANSACTION_IDENTIFIER         20    137  156                          N","colour":"e6e63c"},"2961895":{"id":2961895,"x":-479,"y":152,"width":799,"height":256,"text":"**``BATCH FILE LAYOUT``**","colour":"f9c21b"}},"variables":{"file_number":{"definition":{"name":"file_number","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"input_bucket":{"definition":{"name":"input_bucket","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"s3://aspiration-etl-staging/file_processing/galileo_batch_transactions/batch_files"},"input_filename":{"definition":{"name":"input_filename","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"passed_variable"},"staging_table":{"definition":{"name":"staging_table","type":"TEXT","scope":"BRANCH","description":"","visibility":"PRIVATE"},"value":"tmp_swagbucks"}},"grids":{}},"info":{"name":"swagbucks_batch_transaction_file","description":"","type":"ORCHESTRATION","tag":"bd49c85e-134b-4ff7-9a4e-935be5631d03"}}