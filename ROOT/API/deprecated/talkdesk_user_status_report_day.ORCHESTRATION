{"job":{"components":{"2967765":{"id":2967765,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":64,"y":144,"width":32,"height":32,"inputConnectorIDs":[2967761],"outputSuccessConnectorIDs":[2967764],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"refresh external table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"alter external table adw.api.stg_talkdesk_user_status refresh;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967768":{"id":2967768,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":206,"y":274,"width":32,"height":32,"inputConnectorIDs":[2967764],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"populate parsed table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delete from api.talkdesk_user_status\nwhere FILE_DATE='${file_date}'\n;\n\ninsert into api.talkdesk_user_status\n    (FILE_DATE, FILE_NAME, IS_USER_ACTIVE, RING_GROUPS, STATUS_END_AT, STATUS_LABEL, STATUS_START_AT, STATUS_TIME, TEAM_ID, TEAM_NAME, USER_EMAIL, USER_ID, USER_NAME) \nselect\n    FILE_DATE,\n    FILE_NAME,\n    fl.VALUE:is_user_active,\n    fl.VALUE:ring_groups,\n    fl.VALUE:status_end_at,\n    fl.VALUE:status_label,\n    fl.VALUE:status_start_at,\n    fl.VALUE:status_time,\n    fl.VALUE:team_id,\n    fl.VALUE:team_name,\n    fl.VALUE:user_email,\n    fl.VALUE:user_id,\n    fl.VALUE:user_name\n\nfrom api.STG_TALKDESK_USER_STATUS report,\n     lateral flatten (input => report.value, path => 'entries') fl\nwhere 1=1\n  and FILE_DATE='${file_date}'\n--   and fl.VALUE:call_id='5ade27e4b826481494ca4aa81df3c29c'\n-- limit 5\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967769":{"id":2967769,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-295,"y":196,"width":32,"height":32,"inputConnectorIDs":[2967767],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create table scripts - user_status"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create or replace table api.talkdesk_user_status (\n    file_date date,\n    file_name varchar(255),\n    is_user_active boolean,\n    ring_groups varchar(255),\n    status_end_at timestamp_tz,\n    status_label varchar(255),\n    status_start_at timestamp_tz,\n    status_time numeric(20,2),\n    team_id varchar(255),\n    team_name varchar(255),\n    user_email varchar(255),\n    user_id varchar(255),\n    user_name varchar(255),\n    etl_load_date timestamp_tz default current_timestamp not null\n)\n;\n\nGRANT SELECT ON ALL TABLES IN SCHEMA ADW.API TO DATA_ENGINEERING_GROUP;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967770":{"id":2967770,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2967761,2967766],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967771":{"id":2967771,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-128,"y":80,"width":32,"height":32,"inputConnectorIDs":[2967766],"outputSuccessConnectorIDs":[2967767],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create external table scripts - user_status"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create or replace external table adw.api.stg_talkdesk_user_status\n(\n  file_name varchar(255) as split_part(metadata$filename, '/', 4),\n  file_date date as to_date(substr(split_part(metadata$filename, '/', 4), 20, 8), 'YYYYMMDD')\n)\n  partition by (file_date)\n  with location = @public.datateam/api/talkdesk/user_status\n  file_format = (type= json)\n;\n\nGRANT SELECT ON ALL external TABLES IN SCHEMA ADW.API TO DATA_ENGINEERING_GROUP;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2967764":{"id":2967764,"sourceID":2967765,"targetID":2967768},"2967767":{"id":2967767,"sourceID":2967771,"targetID":2967769}},"failureConnectors":{},"unconditionalConnectors":{"2967761":{"id":2967761,"sourceID":2967770,"targetID":2967765},"2967766":{"id":2967766,"sourceID":2967770,"targetID":2967771}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"file_date":{"definition":{"name":"file_date","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"2021-10-01"}},"grids":{}},"info":{"name":"talkdesk_user_status_report_day","description":"","type":"ORCHESTRATION","tag":"ed9034af-e5a4-42b1-a36e-d17126c64f7a"}}