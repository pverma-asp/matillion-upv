{"job":{"components":{"2967792":{"id":2967792,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-295,"y":196,"width":32,"height":32,"inputConnectorIDs":[2967794],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create table scripts - contacts"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create or replace table api.talkdesk_contacts (\n    file_date date,\n    file_name varchar(255),\n    abandon_time numeric(20,2),\n    after_call_work_time numeric(20,2),\n    answered_at timestamp_tz,\n    callback varchar(255),\n    company_number varchar(255),\n    connect_time numeric(20,2),\n    connected_at timestamp_tz,\n    contact_id varchar(255),\n    contact_person_number varchar(255),\n    contact_type varchar(255),\n    direct_assignment_ids varchar(255),\n    direct_assignment_user varchar(255),\n    direction varchar(255),\n    duration varchar(255),\n    external_phone_number varchar(255),\n    finished_at timestamp_tz,\n    handle_time numeric(20,2),\n    handling_ring_groups varchar(255),\n    hard_hold_time numeric(20,2),\n    hold_time numeric(20,2),\n    inside_business_hours varchar(255),\n    inside_service_level varchar(255),\n    interaction_id varchar(255),\n    phone_display_name varchar(255),\n    ring_groups varchar(255),\n    ring_time numeric(20,2),\n    short_abandon_time numeric(20,2),\n    soft_hold_time numeric(20,2),\n    started_at timestamp_tz,\n    talk_time numeric(20,2),\n    team_id varchar(255),\n    team_name varchar(255),\n    time_to_missed varchar(255),\n    time_to_voicemail varchar(255),\n    transfer_in varchar(255),\n    transfer_in_type varchar(255),\n    transfer_out varchar(255),\n    transfer_out_type varchar(255),\n    user_id varchar(255),\n    user_name varchar(255),\n    wait_time numeric(20,2),\n    within_service_level_threshold varchar(255),\n    etl_load_date timestamp_tz default current_timestamp not null\n)\n;\n\nGRANT SELECT ON ALL TABLES IN SCHEMA ADW.API TO DATA_ENGINEERING_GROUP;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967793":{"id":2967793,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":64,"y":144,"width":32,"height":32,"inputConnectorIDs":[2967756],"outputSuccessConnectorIDs":[2967795],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"refresh external table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"alter external table adw.api.stg_talkdesk_contacts refresh;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967796":{"id":2967796,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":206,"y":274,"width":32,"height":32,"inputConnectorIDs":[2967795],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"populate parsed table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delete from api.talkdesk_contacts\nwhere FILE_DATE='${file_date}'\n;\n\ninsert into api.talkdesk_contacts\n    (FILE_DATE, FILE_NAME, ABANDON_TIME, AFTER_CALL_WORK_TIME, ANSWERED_AT, CALLBACK, COMPANY_NUMBER, CONNECT_TIME, CONNECTED_AT, CONTACT_ID, CONTACT_PERSON_NUMBER, CONTACT_TYPE, DIRECT_ASSIGNMENT_IDS, DIRECT_ASSIGNMENT_USER, DIRECTION, DURATION, EXTERNAL_PHONE_NUMBER, FINISHED_AT, HANDLE_TIME, HANDLING_RING_GROUPS, HARD_HOLD_TIME, HOLD_TIME, INSIDE_BUSINESS_HOURS, INSIDE_SERVICE_LEVEL, INTERACTION_ID, PHONE_DISPLAY_NAME, RING_GROUPS, RING_TIME, SHORT_ABANDON_TIME, SOFT_HOLD_TIME, STARTED_AT, TALK_TIME, TEAM_ID, TEAM_NAME, TIME_TO_MISSED, TIME_TO_VOICEMAIL, TRANSFER_IN, TRANSFER_IN_TYPE, TRANSFER_OUT, TRANSFER_OUT_TYPE, USER_ID, USER_NAME, WAIT_TIME, WITHIN_SERVICE_LEVEL_THRESHOLD) \nselect\n    FILE_DATE,\n    FILE_NAME,\n    fl.VALUE:abandon_time,\n    fl.VALUE:after_call_work_time,\n    fl.VALUE:answered_at,\n    fl.VALUE:callback,\n    fl.VALUE:company_number,\n    fl.VALUE:connect_time,\n    fl.VALUE:connected_at,\n    fl.VALUE:contact_id,\n    fl.VALUE:contact_person_number,\n    fl.VALUE:contact_type,\n    fl.VALUE:direct_assignment_ids,\n    fl.VALUE:direct_assignment_user,\n    fl.VALUE:direction,\n    fl.VALUE:duration,\n    fl.VALUE:external_phone_number,\n    fl.VALUE:finished_at,\n    fl.VALUE:handle_time,\n    fl.VALUE:handling_ring_groups,\n    fl.VALUE:hard_hold_time,\n    fl.VALUE:hold_time,\n    fl.VALUE:inside_business_hours,\n    fl.VALUE:inside_service_level,\n    fl.VALUE:interaction_id,\n    fl.VALUE:phone_display_name,\n    fl.VALUE:ring_groups,\n    fl.VALUE:ring_time,\n    fl.VALUE:short_abandon_time,\n    fl.VALUE:soft_hold_time,\n    fl.VALUE:started_at,\n    fl.VALUE:talk_time,\n    fl.VALUE:team_id,\n    fl.VALUE:team_name,\n    fl.VALUE:time_to_missed,\n    fl.VALUE:time_to_voicemail,\n    fl.VALUE:transfer_in,\n    fl.VALUE:transfer_in_type,\n    fl.VALUE:transfer_out,\n    fl.VALUE:transfer_out_type,\n    fl.VALUE:user_id,\n    fl.VALUE:user_name,\n    fl.VALUE:wait_time,\n    fl.VALUE:within_service_level_threshold\n\nfrom api.STG_TALKDESK_CONTACTS report,\n     lateral flatten (input => report.value, path => 'entries') fl\nwhere 1=1\n  and FILE_DATE='${file_date}'\n--   and fl.VALUE:call_id='5ade27e4b826481494ca4aa81df3c29c'\n-- limit 5\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967798":{"id":2967798,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2967756,2967757],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967799":{"id":2967799,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-128,"y":80,"width":32,"height":32,"inputConnectorIDs":[2967757],"outputSuccessConnectorIDs":[2967794],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create external table scripts - contacts"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create or replace external table adw.api.stg_talkdesk_contacts \n(\n  file_name varchar(255) as split_part(metadata$filename, '/', 4),\n  file_date date as to_date(substr(split_part(metadata$filename, '/', 4), 17, 8), 'YYYYMMDD')\n)\n  partition by (file_date)\n  with location = @public.datateam/api/talkdesk/contacts\n  file_format = (type= json)\n;\n\nGRANT SELECT ON ALL external TABLES IN SCHEMA ADW.API TO DATA_ENGINEERING_GROUP;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2967794":{"id":2967794,"sourceID":2967799,"targetID":2967792},"2967795":{"id":2967795,"sourceID":2967793,"targetID":2967796}},"failureConnectors":{},"unconditionalConnectors":{"2967756":{"id":2967756,"sourceID":2967798,"targetID":2967793},"2967757":{"id":2967757,"sourceID":2967798,"targetID":2967799}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"file_date":{"definition":{"name":"file_date","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"2021-10-01"}},"grids":{}},"info":{"name":"talkdesk_contacts_report_day","description":"","type":"ORCHESTRATION","tag":"7afd8704-6057-4d5d-bcc5-8a1e868a5507"}}