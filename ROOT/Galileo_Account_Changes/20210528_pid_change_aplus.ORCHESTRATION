{"job":{"components":{"2967045":{"id":2967045,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":160,"y":288,"width":32,"height":32,"inputConnectorIDs":[2967044],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Send_BChanges_File_to_Galileo 0"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Send_BChanges_File_to_Galileo"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"galileo_filename"},"2":{"slot":2,"type":"STRING","value":"${galileo_filename}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967048":{"id":2967048,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2967046],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967049":{"id":2967049,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":128,"y":64,"width":32,"height":32,"inputConnectorIDs":[2967046],"outputSuccessConnectorIDs":[2967047],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"load charge_offs.csv"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP TABLE if exists etl.charge_offs_20200220;\n\nCREATE TABLE if not exists etl.charge_offs_20200220 (\n  full_name varchar(255),\n  first_name varchar(255),\n  external_user_id varchar(255),\n  email varchar(255),\n  save_galileo_prn varchar(255)\n);\n\n-- truncate etl.charge_offs_20200220;\n\ncopy etl.charge_offs_20200220\nfrom 's3://aspiration-datateam/dump/jchen/charge_offs/Final_Charge-off_Save_PRNs_Clean.csv'\niam_role 'arn:aws:iam::332894900161:role/RedshiftClusterRole'\ndelimiter ','\nIGNOREHEADER 1\nremovequotes\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967050":{"id":2967050,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":160,"y":176,"width":32,"height":32,"inputConnectorIDs":[2967047],"outputSuccessConnectorIDs":[2967044],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create galileo account change table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE etl.galileo_account_changes_batch_header\nSET file_name = '${galileo_filename}.gpg',\n       file_transmit_date = '05292021'\nWHERE record_type = 'H'\n;\n\ndelete from etl.galileo_account_changes_batch_detail;\ninsert into etl.galileo_account_changes_batch_detail(record_type, record_number, account_id_type, account_identifier, action_code, action_value)\n\nwith prns as (\n    select 'spend' as type,\n           USER_ID,\n           '223117185775' as prn\n    from bi.DT_ACCOUNTS\n    where 1 = 1\n      and ACCOUNT_TYPE='Checking'\n\n    union all\n\n    select 'save',\n           USER_ID,\n           '223117185908' as prn\n    from bi.DT_ACCOUNTS\n    where 1 = 1\n      and ACCOUNT_TYPE='Checking'\n)\nselect\n  'D' as record_type\n  ,row_number() over (order by prn) as recordnumber\n  ,'R' as accountidtype\n  ,prn::varchar as accountidentifier\n  ,'1' as actioncode\n  , case\n        when type='spend' then '2512'\n        when type='save' then '2513'\n    end as actionvalue\nfrom prns\nwhere 1=1\n--   and USER_ID=1532073  -- eric\n  and USER_ID=622943  -- joe\n;\n\n;\n\n--trailer data\nUPDATE etl.galileo_account_changes_batch_trailer\n   SET \"count\" = (select count(*) from etl.galileo_account_changes_batch_detail)\nWHERE record_type = 'T';\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2967044":{"id":2967044,"sourceID":2967050,"targetID":2967045},"2967047":{"id":2967047,"sourceID":2967049,"targetID":2967050}},"failureConnectors":{},"unconditionalConnectors":{"2967046":{"id":2967046,"sourceID":2967048,"targetID":2967049}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"galileo_filename":{"definition":{"name":"galileo_filename","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"bchanges_584_20210529_pf012.txt"}},"grids":{}},"info":{"name":"20210528_pid_change_aplus","description":"","type":"ORCHESTRATION","tag":"24c2fe60-d4fd-4830-935b-7337fd98404d"}}