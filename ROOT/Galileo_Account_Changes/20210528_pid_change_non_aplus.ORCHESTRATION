{"job":{"components":{"2967021":{"id":2967021,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":160,"y":272,"width":32,"height":32,"inputConnectorIDs":[2967023],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Send_BChanges_File_to_Galileo 0"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Send_BChanges_File_to_Galileo"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"galileo_filename"},"2":{"slot":2,"type":"STRING","value":"${galileo_filename}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967040":{"id":2967040,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":128,"y":64,"width":32,"height":32,"inputConnectorIDs":[2967022],"outputSuccessConnectorIDs":[2967020],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"load charge_offs.csv"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DROP TABLE if exists etl.charge_offs_20200220;\n\nCREATE TABLE if not exists etl.charge_offs_20200220 (\n  full_name varchar(255),\n  first_name varchar(255),\n  external_user_id varchar(255),\n  email varchar(255),\n  save_galileo_prn varchar(255)\n);\n\n-- truncate etl.charge_offs_20200220;\n\ncopy etl.charge_offs_20200220\nfrom 's3://aspiration-datateam/dump/jchen/charge_offs/Final_Charge-off_Save_PRNs_Clean.csv'\niam_role 'arn:aws:iam::332894900161:role/RedshiftClusterRole'\ndelimiter ','\nIGNOREHEADER 1\nremovequotes\n;\n\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967042":{"id":2967042,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":160,"y":176,"width":32,"height":32,"inputConnectorIDs":[2967020],"outputSuccessConnectorIDs":[2967023],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create galileo account change table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE etl.galileo_account_changes_batch_header\nSET file_name = '${galileo_filename}.gpg',\n       file_transmit_date = '05292021'\nWHERE record_type = 'H'\n;\n\ndelete from etl.galileo_account_changes_batch_detail;\ninsert into etl.galileo_account_changes_batch_detail(record_type, record_number, account_id_type, account_identifier, action_code, action_value)\nselect\n  'D' as record_type\n  ,1 as recordnumber\n  ,'R' as accountidtype\n  ,spend_galileo_prn::varchar as accountidentifier\n  ,'1' as actioncode\n  ,'2511' as actionvalue\nfrom bi.DT_ACCOUNTS da\nwhere 1=1\n  and USER_ID=1532073\n\nunion all\n\nselect\n  'D' as record_type\n--   ,row_number() over (order by save_galileo_prn) as recordnumber\n  ,2 as recordnumber\n  ,'R' as accountidtype\n  ,save_galileo_prn::varchar as accountidentifier\n  ,'1' as actioncode\n  ,'2513' as actionvalue\nfrom bi.DT_ACCOUNTS da\nwhere 1=1\n  and USER_ID=1532073\n\n;\n\n--trailer data\nUPDATE etl.galileo_account_changes_batch_trailer\n   SET \"count\" = (select count(*) from etl.galileo_account_changes_batch_detail)\nWHERE record_type = 'T';\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967043":{"id":2967043,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":0,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2967022],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2967020":{"id":2967020,"sourceID":2967040,"targetID":2967042},"2967023":{"id":2967023,"sourceID":2967042,"targetID":2967021}},"failureConnectors":{},"unconditionalConnectors":{"2967022":{"id":2967022,"sourceID":2967043,"targetID":2967040}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"galileo_filename":{"definition":{"name":"galileo_filename","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"bchanges_584_20210529_pf011.txt"}},"grids":{}},"info":{"name":"20210528_pid_change_non_aplus","description":"","type":"ORCHESTRATION","tag":"6d199fae-7ae0-4f1d-9720-9c0cf6e4cd31"}}